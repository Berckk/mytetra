<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'Courier New'; font-size:12pt; font-weight:400; font-style:normal;">
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana'; color:#000000;">Раздел содержит описание особенностей получения и использования значений перечислений 1С:Предприятия через внешнее соединение или Automation сервер 1С:Предприятия.</span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial,Tahoma'; font-size:14pt; font-weight:600; color:#000000;">Системные перечисления и их элементы</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana'; color:#000000;">Системные перечисления предназначены для определения некоторого набора предопределенных значений и используются в качестве значений параметров некоторых методов, а также в качестве значений некоторых свойств объектов 1С:Педприятия. Доступ к системным перечислениям осуществляется как к свойствам глобального контекста. Значения элементов системных перечислений указываются через точку от имени системного перечисления. Например:</span></p>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#0000ff; background-color:#f0f0f0;">ОбъектДокумент</span><span style=" font-size:10pt; color:#ff0000;">.</span><span style=" font-size:10pt; color:#0000ff;">Записать</span><span style=" font-size:10pt; color:#ff0000;">(</span><span style=" font-size:10pt; color:#0000ff;">РежимЗаписиДокумента</span><span style=" font-size:10pt; color:#ff0000;">.</span><span style=" font-size:10pt; color:#0000ff;">Проведение</span><span style=" font-size:10pt; color:#ff0000;">,</span><span style=" font-size:10pt; color:#0000ff;"> РежимПроведенияДокумента</span><span style=" font-size:10pt; color:#ff0000;">.</span><span style=" font-size:10pt; color:#0000ff;">Оперативный</span><span style=" font-size:10pt; color:#ff0000;">);</span></pre>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana'; color:#000000;">В качестве значений параметров метода </span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">Записать()</span><span style=" font-family:'Verdana'; color:#000000;"> заданы два значения элементов системных перечислений: элемент &quot;Проведение&quot; системного перечисления &quot;РежимЗаписиДокумента&quot; и элемент &quot;Оперативный&quot; системного перечисления &quot;РежимПроведенияДокумента&quot;.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana'; color:#000000;">И системные перечисления, и значения их элементов являются объектами, и могут быть переданы в другие приложения через COM посредством интерфейса IDispatch. При этом любое системное перечисление имеет набор свойств, каждое из которых позволяет получить соответствующее значение элемента данного системного перечисления. Элемент системного перечисления также является объектом и доступен через интерфейс IDispatch, однако ни свойств, ни методов он не имеет.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana'; color:#000000;">По этой причине анализ полученных значений системных перечислений возможен только посредством их сравнения со значениями системных перечислений, полученными через свойства глобального контекста. Например, на встроенном языке 1С:Предприятия проверка значений системных перечислений, полученных через внешнее соединение, может быть выполнена так:</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#008000;">// Элемент системного перечисления как собственный объект 1С:Предприятия</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#0000ff;">ЭлементПеречисления </span><span style=" font-size:10pt; color:#ff0000;">=</span><span style=" font-size:10pt; color:#0000ff;"> Метаданные</span><span style=" font-size:10pt; color:#ff0000;">.</span><span style=" font-size:10pt; color:#0000ff;">Справочники</span><span style=" font-size:10pt; color:#ff0000;">.</span><span style=" font-size:10pt; color:#0000ff;">Справочник1</span><span style=" font-size:10pt; color:#ff0000;">.</span><span style=" font-size:10pt; color:#0000ff;">ВидИерархии</span><span style=" font-size:10pt; color:#ff0000;">;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#0000ff;">Сообщить</span><span style=" font-size:10pt; color:#ff0000;">(</span><span style=" font-size:10pt; color:#0000ff;">ЭлементПеречисления</span><span style=" font-size:10pt; color:#ff0000;">);</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:10pt; color:#ff0000; background-color:#f0f0f0;"></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#008000;">// Элемент системного перечисления, полученный через COM.</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#0000ff;">Соединитель </span><span style=" font-size:10pt; color:#ff0000;">=</span><span style=" font-size:10pt; color:#0000ff;"> </span><span style=" font-size:10pt; color:#ff0000;">Новый</span><span style=" font-size:10pt; color:#0000ff;"> COMОбъект</span><span style=" font-size:10pt; color:#ff0000;">(</span><span style=" font-size:10pt; color:#000000;">&quot;V8.COMConnector&quot;</span><span style=" font-size:10pt; color:#ff0000;">);</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#0000ff;">Соединение </span><span style=" font-size:10pt; color:#ff0000;">=</span><span style=" font-size:10pt; color:#0000ff;"> Соединитель</span><span style=" font-size:10pt; color:#ff0000;">.</span><span style=" font-size:10pt; color:#0000ff;">connect</span><span style=" font-size:10pt; color:#ff0000;">(</span><span style=" font-size:10pt; color:#000000;">&quot;File=c:\InfoBaseDirectory&quot;</span><span style=" font-size:10pt; color:#ff0000;">);</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#0000ff;">ЭлементПеречисления </span><span style=" font-size:10pt; color:#ff0000;">=</span><span style=" font-size:10pt; color:#0000ff;"> Соединение</span><span style=" font-size:10pt; color:#ff0000;">.</span><span style=" font-size:10pt; color:#0000ff;">Метаданные</span><span style=" font-size:10pt; color:#ff0000;">.</span><span style=" font-size:10pt; color:#0000ff;">Справочники</span><span style=" font-size:10pt; color:#ff0000;">.</span><span style=" font-size:10pt; color:#0000ff;">Справочник1</span><span style=" font-size:10pt; color:#ff0000;">.</span><span style=" font-size:10pt; color:#0000ff;">ВидИерархии</span><span style=" font-size:10pt; color:#ff0000;">;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#008000;">// Здесь будет выведено &quot;COMОбъект&quot;.</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#0000ff;">Сообщить</span><span style=" font-size:10pt; color:#ff0000;">(</span><span style=" font-size:10pt; color:#0000ff;">ЭлементПеречисления</span><span style=" font-size:10pt; color:#ff0000;">);</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#008000;">// Образцы значений элементов системного перечисления для сравнения нужно получить</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#008000;">// из того же COM соединения.</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#0000ff;">Образцы </span><span style=" font-size:10pt; color:#ff0000;">=</span><span style=" font-size:10pt; color:#0000ff;"> Соединение</span><span style=" font-size:10pt; color:#ff0000;">.</span><span style=" font-size:10pt; color:#0000ff;">Метаданные</span><span style=" font-size:10pt; color:#ff0000;">.</span><span style=" font-size:10pt; color:#0000ff;">СвойстваОбъектов</span><span style=" font-size:10pt; color:#ff0000;">.</span><span style=" font-size:10pt; color:#0000ff;">ВидИерархии</span><span style=" font-size:10pt; color:#ff0000;">;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#ff0000;">Если</span><span style=" font-size:10pt; color:#0000ff;"> ЭлементПеречисления </span><span style=" font-size:10pt; color:#ff0000;">=</span><span style=" font-size:10pt; color:#0000ff;"> Образцы</span><span style=" font-size:10pt; color:#ff0000;">.</span><span style=" font-size:10pt; color:#0000ff;">ИерархияГруппИЭлементов </span><span style=" font-size:10pt; color:#ff0000;">Тогда</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#0000ff;">    Сообщить</span><span style=" font-size:10pt; color:#ff0000;">(</span><span style=" font-size:10pt; color:#000000;">&quot;ИерархияГруппИЭлементов&quot;</span><span style=" font-size:10pt; color:#ff0000;">);</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#ff0000;">ИначеЕсли</span><span style=" font-size:10pt; color:#0000ff;"> ЭлементПеречисления </span><span style=" font-size:10pt; color:#ff0000;">=</span><span style=" font-size:10pt; color:#0000ff;"> Образцы</span><span style=" font-size:10pt; color:#ff0000;">.</span><span style=" font-size:10pt; color:#0000ff;">ИерархияЭлементов </span><span style=" font-size:10pt; color:#ff0000;">Тогда</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#0000ff;">    Сообщить</span><span style=" font-size:10pt; color:#ff0000;">(</span><span style=" font-size:10pt; color:#000000;">&quot;ИерархияЭлементов&quot;</span><span style=" font-size:10pt; color:#ff0000;">);</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#ff0000;">КонецЕсли;</span></pre>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana'; color:#000000;">Важно иметь в виду, что значения одних и тех же системных перечислений, полученные из разных экземпляров клиентского приложения или внешнего соединения 1С:Предприятия, являются разными объектами и между собой несравнимы.</span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial,Tahoma'; font-size:14pt; font-weight:600; color:#000000;">Перечисления, определенные в конфигурации</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana'; color:#000000;">В отличие от системных перечислений, определенные в конфигурации перечисления являются объектами базы данных. Элемент такого перечисления является ссылкой на объект базы данных. Например, если в конфигурации определено перечисление &quot;Перечисление1&quot; с элементами &quot;ЗначениеПеречисления1&quot; и &quot;ЗначениеПеречисления2&quot;, а реквизит &quot;Реквизит1&quot; справочника &quot;Справочник1&quot; имеет тип &quot;ПеречислениеСсылка.Перечисление1&quot;, то следующий код на встроенном языке 1С:Предприятия:</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#0000ff; background-color:#f0f0f0;">ЭлементПеречисления1 </span><span style=" font-size:10pt; color:#ff0000;">=</span><span style=" font-size:10pt; color:#0000ff;"> Перечисления</span><span style=" font-size:10pt; color:#ff0000;">.</span><span style=" font-size:10pt; color:#0000ff;">Перечисление1</span><span style=" font-size:10pt; color:#ff0000;">.</span><span style=" font-size:10pt; color:#0000ff;">ЗначениеПеречисления1</span><span style=" font-size:10pt; color:#ff0000;">;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#0000ff;">Сообщить</span><span style=" font-size:10pt; color:#ff0000;">(</span><span style=" font-size:10pt; color:#0000ff;">ЭлементПеречисления1</span><span style=" font-size:10pt; color:#ff0000;">);</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#0000ff;">ЭлементПеречисления2 </span><span style=" font-size:10pt; color:#ff0000;">=</span><span style=" font-size:10pt; color:#0000ff;"> Справочники</span><span style=" font-size:10pt; color:#ff0000;">.</span><span style=" font-size:10pt; color:#0000ff;">Справочник1</span><span style=" font-size:10pt; color:#ff0000;">.</span><span style=" font-size:10pt; color:#0000ff;">НайтиПоКоду</span><span style=" font-size:10pt; color:#ff0000;">(</span><span style=" font-size:10pt; color:#000000;">1</span><span style=" font-size:10pt; color:#ff0000;">).</span><span style=" font-size:10pt; color:#0000ff;">Реквизит1</span><span style=" font-size:10pt; color:#ff0000;">;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#0000ff;">Сообщить</span><span style=" font-size:10pt; color:#ff0000;">(</span><span style=" font-size:10pt; color:#0000ff;">ЭлементПеречисления2</span><span style=" font-size:10pt; color:#ff0000;">);</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#ff0000;">Если</span><span style=" font-size:10pt; color:#0000ff;"> ЭлементПеречисления1 </span><span style=" font-size:10pt; color:#ff0000;">=</span><span style=" font-size:10pt; color:#0000ff;"> ЭлементПеречисления2 </span><span style=" font-size:10pt; color:#ff0000;">Тогда</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#0000ff;">    Сообщить</span><span style=" font-size:10pt; color:#ff0000;">(</span><span style=" font-size:10pt; color:#000000;">&quot;Равно&quot;</span><span style=" font-size:10pt; color:#ff0000;">);</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#ff0000;">Иначе</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#0000ff;">    Сообщить</span><span style=" font-size:10pt; color:#ff0000;">(</span><span style=" font-size:10pt; color:#000000;">&quot;Не равно&quot;</span><span style=" font-size:10pt; color:#ff0000;">);</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#ff0000;">КонецЕсли;</span></pre>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana'; color:#000000;">выведет &quot;Равно&quot;, если значением реквизита &quot;Реквизит1&quot; является &quot;ЗначениеПеречисления1&quot; и &quot;Не равно&quot; в противном случае.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana'; color:#000000;">Однако если значение элемента перечисления получить через внешнее соединение, то оно будет являться COM объектом, и подобное сравнение будет всегда приводить к отрицательному результату. Например, следующий код на встроенном языке 1С:Предприятия:</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#0000ff; background-color:#f0f0f0;">Соединитель </span><span style=" font-size:10pt; color:#ff0000;">=</span><span style=" font-size:10pt; color:#0000ff;"> </span><span style=" font-size:10pt; color:#ff0000;">Новый</span><span style=" font-size:10pt; color:#0000ff;"> COMОбъект</span><span style=" font-size:10pt; color:#ff0000;">(</span><span style=" font-size:10pt; color:#000000;">&quot;V8.COMConnector&quot;</span><span style=" font-size:10pt; color:#ff0000;">);</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#0000ff;">Соединение </span><span style=" font-size:10pt; color:#ff0000;">=</span><span style=" font-size:10pt; color:#0000ff;"> Соединитель</span><span style=" font-size:10pt; color:#ff0000;">.</span><span style=" font-size:10pt; color:#0000ff;">connect</span><span style=" font-size:10pt; color:#ff0000;">(</span><span style=" font-size:10pt; color:#000000;">&quot;File=c:\InfoBaseDirectory&quot;</span><span style=" font-size:10pt; color:#ff0000;">);</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#0000ff;">ЭлементПеречисления1 </span><span style=" font-size:10pt; color:#ff0000;">=</span><span style=" font-size:10pt; color:#0000ff;"> Соединение</span><span style=" font-size:10pt; color:#ff0000;">.</span><span style=" font-size:10pt; color:#0000ff;">Перечисления</span><span style=" font-size:10pt; color:#ff0000;">.</span><span style=" font-size:10pt; color:#0000ff;">Перечисление1</span><span style=" font-size:10pt; color:#ff0000;">.</span><span style=" font-size:10pt; color:#0000ff;">ЗначениеПеречисления1</span><span style=" font-size:10pt; color:#ff0000;">;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#0000ff;">Сообщить</span><span style=" font-size:10pt; color:#ff0000;">(</span><span style=" font-size:10pt; color:#0000ff;">ЭлементПеречисления1</span><span style=" font-size:10pt; color:#ff0000;">);</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#0000ff;">ЭлементПеречисления2 </span><span style=" font-size:10pt; color:#ff0000;">=</span><span style=" font-size:10pt; color:#0000ff;"> Соединение</span><span style=" font-size:10pt; color:#ff0000;">.</span><span style=" font-size:10pt; color:#0000ff;">Справочники</span><span style=" font-size:10pt; color:#ff0000;">.</span><span style=" font-size:10pt; color:#0000ff;">Справочник1</span><span style=" font-size:10pt; color:#ff0000;">.</span><span style=" font-size:10pt; color:#0000ff;">НайтиПоКоду</span><span style=" font-size:10pt; color:#ff0000;">(</span><span style=" font-size:10pt; color:#000000;">1</span><span style=" font-size:10pt; color:#ff0000;">).</span><span style=" font-size:10pt; color:#0000ff;">Реквизит1</span><span style=" font-size:10pt; color:#ff0000;">;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#0000ff;">Сообщить</span><span style=" font-size:10pt; color:#ff0000;">(</span><span style=" font-size:10pt; color:#0000ff;">ЭлементПеречисления2</span><span style=" font-size:10pt; color:#ff0000;">);</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#ff0000;">Если</span><span style=" font-size:10pt; color:#0000ff;"> ЭлементПеречисления1 </span><span style=" font-size:10pt; color:#ff0000;">=</span><span style=" font-size:10pt; color:#0000ff;"> ЭлементПеречисления2 </span><span style=" font-size:10pt; color:#ff0000;">Тогда</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#0000ff;">    Сообщить</span><span style=" font-size:10pt; color:#ff0000;">(</span><span style=" font-size:10pt; color:#000000;">&quot;Равно&quot;</span><span style=" font-size:10pt; color:#ff0000;">);</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#ff0000;">Иначе</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#0000ff;">    Сообщить</span><span style=" font-size:10pt; color:#ff0000;">(</span><span style=" font-size:10pt; color:#000000;">&quot;Не равно&quot;</span><span style=" font-size:10pt; color:#ff0000;">);</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#ff0000;">КонецЕсли;</span></pre>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana'; color:#000000;">будет всегда выводить &quot;Не равно&quot;. Это происходит потому, что значение элемента перечисления является объектом типа ссылка на объект базы данных. Для объектов ссылок определена операция сравнения значений, которая может работать только для &quot;своих&quot; объектов 1С:Предприятия. Объекты, полученные через внешнее соединение &quot;своими&quot; не являются, поэтому операция их сравнения является проверкой идентичности. Поскольку для объектов ссылок идентичность не поддерживается, их сравнение может дать отрицательный результат, даже если значения ссылок, заключенные в этих объектах, одинаковые.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana'; color:#000000;">Для сравнения значений элементов перечислений, определенных в конфигурации, необходимо выполнить преобразование этих элементов к одному из примитивных типов, сравнение которых не вызывает трудности. Такими типами могут быть либо числовой, либо строковый тип. Преобразовать значение элемента перечисления к числовому типу можно так:</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#0000ff; background-color:#f0f0f0;">Соединитель </span><span style=" font-size:10pt; color:#ff0000;">=</span><span style=" font-size:10pt; color:#0000ff;"> </span><span style=" font-size:10pt; color:#ff0000;">Новый</span><span style=" font-size:10pt; color:#0000ff;"> COMОбъект</span><span style=" font-size:10pt; color:#ff0000;">(</span><span style=" font-size:10pt; color:#000000;">&quot;V8.COMConnector&quot;</span><span style=" font-size:10pt; color:#ff0000;">);</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#0000ff;">Соединение </span><span style=" font-size:10pt; color:#ff0000;">=</span><span style=" font-size:10pt; color:#0000ff;"> Соединитель</span><span style=" font-size:10pt; color:#ff0000;">.</span><span style=" font-size:10pt; color:#0000ff;">connect</span><span style=" font-size:10pt; color:#ff0000;">(</span><span style=" font-size:10pt; color:#000000;">&quot;File=c:\InfoBaseDirectory&quot;</span><span style=" font-size:10pt; color:#ff0000;">);</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#0000ff;">ЭлементПеречисления </span><span style=" font-size:10pt; color:#ff0000;">=</span><span style=" font-size:10pt; color:#0000ff;"> Соединение</span><span style=" font-size:10pt; color:#ff0000;">.</span><span style=" font-size:10pt; color:#0000ff;">Справочники</span><span style=" font-size:10pt; color:#ff0000;">.</span><span style=" font-size:10pt; color:#0000ff;">Справочник1</span><span style=" font-size:10pt; color:#ff0000;">.</span><span style=" font-size:10pt; color:#0000ff;">НайтиПоКоду</span><span style=" font-size:10pt; color:#ff0000;">(</span><span style=" font-size:10pt; color:#000000;">1</span><span style=" font-size:10pt; color:#ff0000;">).</span><span style=" font-size:10pt; color:#0000ff;">Реквизит1</span><span style=" font-size:10pt; color:#ff0000;">;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#0000ff;">ВозможныеЗначения </span><span style=" font-size:10pt; color:#ff0000;">=</span><span style=" font-size:10pt; color:#0000ff;"> ЭлементПеречисления</span><span style=" font-size:10pt; color:#ff0000;">.</span><span style=" font-size:10pt; color:#0000ff;">Метаданные</span><span style=" font-size:10pt; color:#ff0000;">().</span><span style=" font-size:10pt; color:#0000ff;">ЗначенияПеречисления</span><span style=" font-size:10pt; color:#ff0000;">;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#0000ff;">НомерЭлементаПеречисления </span><span style=" font-size:10pt; color:#ff0000;">=</span><span style=" font-size:10pt; color:#0000ff;"> ВозможныеЗначения</span><span style=" font-size:10pt; color:#ff0000;">.</span><span style=" font-size:10pt; color:#0000ff;">Индекс</span><span style=" font-size:10pt; color:#ff0000;">(</span><span style=" font-size:10pt; color:#0000ff;">ВозможныеЗначения</span><span style=" font-size:10pt; color:#ff0000;">.</span><span style=" font-size:10pt; color:#0000ff;">Найти</span><span style=" font-size:10pt; color:#ff0000;">(</span><span style=" font-size:10pt; color:#0000ff;">Соединение</span><span style=" font-size:10pt; color:#ff0000;">.</span><span style=" font-size:10pt; color:#0000ff;">XMLString</span><span style=" font-size:10pt; color:#ff0000;">(</span><span style=" font-size:10pt; color:#0000ff;">ЭлементПеречисления</span><span style=" font-size:10pt; color:#ff0000;">)));</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#ff0000;">Если</span><span style=" font-size:10pt; color:#0000ff;"> НомерЭлементаПеречисления </span><span style=" font-size:10pt; color:#ff0000;">=</span><span style=" font-size:10pt; color:#0000ff;"> </span><span style=" font-size:10pt; color:#000000;">0</span><span style=" font-size:10pt; color:#0000ff;"> </span><span style=" font-size:10pt; color:#ff0000;">Тогда</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#0000ff;">    Сообщить</span><span style=" font-size:10pt; color:#ff0000;">(</span><span style=" font-size:10pt; color:#000000;">&quot;ЗначениеПеречисления1&quot;</span><span style=" font-size:10pt; color:#ff0000;">);</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#ff0000;">ИначеЕсли</span><span style=" font-size:10pt; color:#0000ff;"> НомерЭлементаПеречисления </span><span style=" font-size:10pt; color:#ff0000;">=</span><span style=" font-size:10pt; color:#0000ff;"> </span><span style=" font-size:10pt; color:#000000;">1</span><span style=" font-size:10pt; color:#0000ff;"> </span><span style=" font-size:10pt; color:#ff0000;">Тогда</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#0000ff;">    Сообщить</span><span style=" font-size:10pt; color:#ff0000;">(</span><span style=" font-size:10pt; color:#000000;">&quot;ЗначениеПеречисления2&quot;</span><span style=" font-size:10pt; color:#ff0000;">);</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#ff0000;">КонецЕсли;</span></pre>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana'; color:#000000;">Если тип перечисления, значение которого может содежать переменная &quot;ЭлементПеречисления&quot;, известен заранее, то приведенный выше пример может быть записан проще:</span></p>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#0000ff; background-color:#f0f0f0;">НомерЭлементаПеречисления </span><span style=" font-size:10pt; color:#ff0000;">=</span><span style=" font-size:10pt; color:#0000ff;"> Соединение</span><span style=" font-size:10pt; color:#ff0000;">.</span><span style=" font-size:10pt; color:#0000ff;">Перечисления</span><span style=" font-size:10pt; color:#ff0000;">.</span><span style=" font-size:10pt; color:#0000ff;">Перечисление1</span><span style=" font-size:10pt; color:#ff0000;">.</span><span style=" font-size:10pt; color:#0000ff;">Индекс</span><span style=" font-size:10pt; color:#ff0000;">(</span><span style=" font-size:10pt; color:#0000ff;">ЭлементПеречисления</span><span style=" font-size:10pt; color:#ff0000;">);</span></pre>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana'; color:#000000;">Значение элемента перечисления может быть приведено к строковому типу, например, при помощи следующего фрагмента кода на встроенном языке 1С:Предприятия:</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#0000ff; background-color:#f0f0f0;">Соединитель </span><span style=" font-size:10pt; color:#ff0000;">=</span><span style=" font-size:10pt; color:#0000ff;"> </span><span style=" font-size:10pt; color:#ff0000;">Новый</span><span style=" font-size:10pt; color:#0000ff;"> COMОбъект</span><span style=" font-size:10pt; color:#ff0000;">(</span><span style=" font-size:10pt; color:#000000;">&quot;V8.COMConnector&quot;</span><span style=" font-size:10pt; color:#ff0000;">);</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#0000ff;">Соединение </span><span style=" font-size:10pt; color:#ff0000;">=</span><span style=" font-size:10pt; color:#0000ff;"> Соединитель</span><span style=" font-size:10pt; color:#ff0000;">.</span><span style=" font-size:10pt; color:#0000ff;">connect</span><span style=" font-size:10pt; color:#ff0000;">(</span><span style=" font-size:10pt; color:#000000;">&quot;File=c:\InfoBaseDirectory&quot;</span><span style=" font-size:10pt; color:#ff0000;">);</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#0000ff;">ЭлементПеречисления </span><span style=" font-size:10pt; color:#ff0000;">=</span><span style=" font-size:10pt; color:#0000ff;"> Соединение</span><span style=" font-size:10pt; color:#ff0000;">.</span><span style=" font-size:10pt; color:#0000ff;">Справочники</span><span style=" font-size:10pt; color:#ff0000;">.</span><span style=" font-size:10pt; color:#0000ff;">Справочник1</span><span style=" font-size:10pt; color:#ff0000;">.</span><span style=" font-size:10pt; color:#0000ff;">НайтиПоКоду</span><span style=" font-size:10pt; color:#ff0000;">(</span><span style=" font-size:10pt; color:#000000;">1</span><span style=" font-size:10pt; color:#ff0000;">).</span><span style=" font-size:10pt; color:#0000ff;">Реквизит1</span><span style=" font-size:10pt; color:#ff0000;">;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#0000ff;">СтрокаЭлементПеречисления </span><span style=" font-size:10pt; color:#ff0000;">=</span><span style=" font-size:10pt; color:#0000ff;"> ЭлементПеречисления</span><span style=" font-size:10pt; color:#ff0000;">.</span><span style=" font-size:10pt; color:#0000ff;">Метаданные</span><span style=" font-size:10pt; color:#ff0000;">().</span><span style=" font-size:10pt; color:#0000ff;">Имя</span><span style=" font-size:10pt; color:#ff0000;">;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#0000ff;">СтрокаЭлементПеречисления </span><span style=" font-size:10pt; color:#ff0000;">=</span><span style=" font-size:10pt; color:#0000ff;"> СтрокаЭлементПеречисления </span><span style=" font-size:10pt; color:#ff0000;">+</span><span style=" font-size:10pt; color:#0000ff;"> </span><span style=" font-size:10pt; color:#000000;">&quot;.&quot;</span><span style=" font-size:10pt; color:#0000ff;"> </span><span style=" font-size:10pt; color:#ff0000;">+</span><span style=" font-size:10pt; color:#0000ff;"> Соединение</span><span style=" font-size:10pt; color:#ff0000;">.</span><span style=" font-size:10pt; color:#0000ff;">XMLString</span><span style=" font-size:10pt; color:#ff0000;">(</span><span style=" font-size:10pt; color:#0000ff;">ЭлементПеречисления</span><span style=" font-size:10pt; color:#ff0000;">);</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#0000ff;">Сообщить</span><span style=" font-size:10pt; color:#ff0000;">(</span><span style=" font-size:10pt; color:#0000ff;">СтрокаЭлементПеречисления</span><span style=" font-size:10pt; color:#ff0000;">);</span></pre></body></html>