<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'Courier New'; font-size:12pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; font-size:x-large; color:#000000; background-color:#ffffff;">Содержание</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://habrahabr.ru/post/310460/?utm_content=buffer693a9&amp;utm_medium=social&amp;utm_source=plus.google.com&amp;utm_campaign=buffer#faq"><span style=" color:#990099;">Вопросы и ответы</span></a><br /></li>
<li style=" font-family:'Verdana,sans-serif'; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://habrahabr.ru/post/310460/?utm_content=buffer693a9&amp;utm_medium=social&amp;utm_source=plus.google.com&amp;utm_campaign=buffer#intro"><span style=" color:#990099;">Введение</span></a><br /></li>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 2;"><li style=" font-family:'Verdana,sans-serif'; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:80px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://habrahabr.ru/post/310460/?utm_content=buffer693a9&amp;utm_medium=social&amp;utm_source=plus.google.com&amp;utm_campaign=buffer#prereq"><span style=" color:#990099;">Пре-реквизиты</span></a><br /></li>
<li style=" font-family:'Verdana,sans-serif'; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:80px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://habrahabr.ru/post/310460/?utm_content=buffer693a9&amp;utm_medium=social&amp;utm_source=plus.google.com&amp;utm_campaign=buffer#setup"><span style=" color:#990099;">Настройка компьютера</span></a><br /></li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;"><br /></span></p>
<li style=" font-family:'Verdana,sans-serif'; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://habrahabr.ru/post/310460/?utm_content=buffer693a9&amp;utm_medium=social&amp;utm_source=plus.google.com&amp;utm_campaign=buffer#bb"><span style=" color:#990099;">1.0 Играем с Busybox</span></a><br /></li>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 2;"><li style=" font-family:'Verdana,sans-serif'; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:80px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://habrahabr.ru/post/310460/?utm_content=buffer693a9&amp;utm_medium=social&amp;utm_source=plus.google.com&amp;utm_campaign=buffer#dockerrun"><span style=" color:#990099;">1.1 Docker Run</span></a><br /></li>
<li style=" font-family:'Verdana,sans-serif'; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:80px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://habrahabr.ru/post/310460/?utm_content=buffer693a9&amp;utm_medium=social&amp;utm_source=plus.google.com&amp;utm_campaign=buffer#terminology"><span style=" color:#990099;">1.2 Терминология</span></a><br /></li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;"><br /></span></p>
<li style=" font-family:'Verdana,sans-serif'; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://habrahabr.ru/post/310460/?utm_content=buffer693a9&amp;utm_medium=social&amp;utm_source=plus.google.com&amp;utm_campaign=buffer#webapps"><span style=" color:#990099;">2.0 Веб-приложения и Докер</span></a><br /></li>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 2;"><li style=" font-family:'Verdana,sans-serif'; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:80px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://habrahabr.ru/post/310460/?utm_content=buffer693a9&amp;utm_medium=social&amp;utm_source=plus.google.com&amp;utm_campaign=buffer#static"><span style=" color:#990099;">2.1 Статические сайты</span></a><br /></li>
<li style=" font-family:'Verdana,sans-serif'; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:80px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://habrahabr.ru/post/310460/?utm_content=buffer693a9&amp;utm_medium=social&amp;utm_source=plus.google.com&amp;utm_campaign=buffer#images"><span style=" color:#990099;">2.2 Образы</span></a><br /></li>
<li style=" font-family:'Verdana,sans-serif'; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:80px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://habrahabr.ru/post/310460/?utm_content=buffer693a9&amp;utm_medium=social&amp;utm_source=plus.google.com&amp;utm_campaign=buffer#ownimage"><span style=" color:#990099;">2.3 Наш первый образ</span></a><br /></li>
<li style=" font-family:'Verdana,sans-serif'; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:80px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://habrahabr.ru/post/310460/?utm_content=buffer693a9&amp;utm_medium=social&amp;utm_source=plus.google.com&amp;utm_campaign=buffer#dockerfile"><span style=" color:#990099;">2.4 Dockerfile</span></a><br /></li>
<li style=" font-family:'Verdana,sans-serif'; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:80px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://habrahabr.ru/post/310460/?utm_content=buffer693a9&amp;utm_medium=social&amp;utm_source=plus.google.com&amp;utm_campaign=buffer#aws"><span style=" color:#990099;">2.5 Docker на AWS</span></a><br /></li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;"><br /></span></p>
<li style=" font-family:'Verdana,sans-serif'; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://habrahabr.ru/post/310460/?utm_content=buffer693a9&amp;utm_medium=social&amp;utm_source=plus.google.com&amp;utm_campaign=buffer#multi"><span style=" color:#990099;">3.0 Многоконтейнерные окружения</span></a><br /></li>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 2;"><li style=" font-family:'Verdana,sans-serif'; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:80px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://habrahabr.ru/post/310460/?utm_content=buffer693a9&amp;utm_medium=social&amp;utm_source=plus.google.com&amp;utm_campaign=buffer#sfft"><span style=" color:#990099;">3.1 SF Food Trucks</span></a><br /></li>
<li style=" font-family:'Verdana,sans-serif'; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:80px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://habrahabr.ru/post/310460/?utm_content=buffer693a9&amp;utm_medium=social&amp;utm_source=plus.google.com&amp;utm_campaign=buffer#net"><span style=" color:#990099;">3.2 Сети Docker</span></a><br /></li>
<li style=" font-family:'Verdana,sans-serif'; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:80px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://habrahabr.ru/post/310460/?utm_content=buffer693a9&amp;utm_medium=social&amp;utm_source=plus.google.com&amp;utm_campaign=buffer#compose"><span style=" color:#990099;">3.3 Docker Compose</span></a><br /></li>
<li style=" font-family:'Verdana,sans-serif'; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:80px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://habrahabr.ru/post/310460/?utm_content=buffer693a9&amp;utm_medium=social&amp;utm_source=plus.google.com&amp;utm_campaign=buffer#awsecs"><span style=" color:#990099;">3.4 AWS Elastic Container Service</span></a><br /></li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;"><br /></span></p>
<li style=" font-family:'Verdana,sans-serif'; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://habrahabr.ru/post/310460/?utm_content=buffer693a9&amp;utm_medium=social&amp;utm_source=plus.google.com&amp;utm_campaign=buffer#outro"><span style=" color:#990099;">4.0 Заключение</span></a><br /></li></ul>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 2;"><li style=" font-family:'Verdana,sans-serif'; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:80px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://habrahabr.ru/post/310460/?utm_content=buffer693a9&amp;utm_medium=social&amp;utm_source=plus.google.com&amp;utm_campaign=buffer#next"><span style=" color:#990099;">4.1 Следующие шаги</span></a><br /></li>
<li style=" font-family:'Verdana,sans-serif'; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:80px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://habrahabr.ru/post/310460/?utm_content=buffer693a9&amp;utm_medium=social&amp;utm_source=plus.google.com&amp;utm_campaign=buffer#feedback"><span style=" color:#990099;">4.2 Фидбек автору</span></a><br /></li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a name="faq"></a><span style=" font-family:'Verdana,sans-serif'; font-size:x-large; color:#000000; background-color:#ffffff;">В</span><span style=" font-family:'Verdana,sans-serif'; font-size:x-large; color:#000000; background-color:#ffffff;">опросы и ответы</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; font-size:large; color:#000000; background-color:#ffffff;">Что такое Докер?</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Определение</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> </span><a href="https://www.docker.com/"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">Докера</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> в Википедии звучит так:</span></p>
<p style=" margin-top:14px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;">программное обеспечение для автоматизации развёртывания и управления приложениями в среде виртуализации на уровне операционной системы; позволяет «упаковать» приложение со всем его окружением и зависимостями в контейнер, а также предоставляет среду по управлению контейнерами.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;"><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Ого! Как много информации.</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> </span><a name="habracut"></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;">П</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">ростыми словами, Докер это инструмент, который позволяет разработчикам, системными администраторам и другим специалистам деплоить их приложения в песочнице (которые называются </span><span style=" font-family:'Verdana,sans-serif'; font-style:italic; color:#000000;">контейнерами</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">), для запуска на целевой операционной системе, например, Linux. Ключевое преимущество Докера в том, что он позволяет пользователям </span><span style=" font-family:'Verdana,sans-serif'; font-weight:696; color:#000000;">упаковать приложение со всеми его зависимостями в стандартизированный модуль</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> для разработки. В отличие от виртуальных машин, контейнеры не создают такой дополнительной нагрузки, поэтому с ними можно использовать систему и ресурсы более эффективно.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; font-size:large; color:#000000; background-color:#ffffff;">Что такое контейнер?</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Стандарт в индустрии на сегодняшний день — это использовать виртуальные машины для запуска приложений. Виртуальные машины запускаю приложения внутри гостевой операционной системы, которая работает на виртуальном железе основной операционной системы сервера.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Виртуальные машины отлично подходят для полной изоляции процесса для приложения: почти никакие проблемы основной операционной системы не могут повлиять на софт гостевой ОС, и наоборот. Но за такую изоляцию приходится платить. Существует значительная вычислительная нагрузка, необходимая для виртуализации железа гостевой ОС.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Контейнеры используют другой подход: они предоставляют схожий с виртуальными машинами уровень изоляции, но благодаря правильному задействованию низкоуровневых механизмов основной операционной системы делают это с в разы меньшей нагрузкой.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; font-size:large; color:#000000; background-color:#ffffff;">Почему я должен использовать их?</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Взлет Докера был по-настоящему эпичным. Не смотря на то, что контейнеры сами по себе — не новая технология, до Докера они не были так распространены и популярны. Докер изменил ситуацию, предоставив стандартный API, который сильно упростил создание и использование контейнеров, и позволил сообществу вместе работать над библиотеками по работе с контейнерами. В статье, опубликованной в  </span><a href="http://www.theregister.co.uk/2014/05/23/google_containerization_two_billion/"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">The Register</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> в середине 2014 говорится, что Гугл поддерживает больше </span><span style=" font-family:'Verdana,sans-serif'; font-weight:696; color:#000000;">двух миллиардов контейнеров в неделю</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;"><br /></span><img src="image28231.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">В дополнение к продолжительному росту Докера, компания-разработчик Docker Inc. была оценена в два с лишним миллиарда долларов! Благодаря преимуществам в эффективности и портативности, Докер начал получать все больше поддержки, и сейчас стоит во главе движения по</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> </span><span style=" font-family:'Verdana,sans-serif'; font-weight:696; color:#000000;">контейнеризации</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> (containerization). Как современные разработчики, мы должны понять этот тренд и выяснить, какую пользу мы можем получить из него.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; font-size:large; color:#000000; background-color:#ffffff;">Чему меня научит это пособие?</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Это единое и полное пособие по всем аспектам работы с Докером. Кроме разъяснения мифов о Докере и его экосистеме, оно позволит вам получит небольшой опыт по сборке и деплою собственных веб-приложений в облаке. Мы будем использовать </span><a href="http://aws.amazon.com/"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">Amazon Web Services</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> для деплоя статичных сайтов, и два динамических веб-приложения задеплоим на </span><a href="https://aws.amazon.com/ec2/"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">EC2</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> с использованием </span><a href="https://aws.amazon.com/elasticbeanstalk/"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">Elastic Beanstalk</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> и </span><a href="https://aws.amazon.com/ecs/"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">Elastic Container Service</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;">. Даже если вы никогда ничего не деплоили, это пособие даст вам все необходимое.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; font-size:x-large; color:#000000; background-color:#ffffff;">Как использовать этот документ</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Этот документ содержит несколько разделов, каждый из которых посвящен определенному аспекту Докера. В каждом разделе мы будем вводить команды или писать код. Весь код доступен в</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> </span><a href="http://github.com/prakhar1989/docker-curriculum"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">репозитории на Гитхабе</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;">.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a name="intro"></a><span style=" font-family:'Verdana,sans-serif'; font-size:x-large; color:#000000; background-color:#ffffff;">В</span><span style=" font-family:'Verdana,sans-serif'; font-size:x-large; color:#000000; background-color:#ffffff;">ведение</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;"></p>
<p style=" margin-top:14px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;">Внимание: В этом пособии используется версия Докера </span><span style=" font-family:'Verdana,sans-serif'; font-weight:696; color:#000000;">1.12.0-rc2</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">. Если вы столкнулись с несовместимостью, пожалуйста, отправьте </span><a href="https://github.com/prakhar1989/docker-curriculum/issues"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">issue</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;">. Спасибо!</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;"><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a name="prereq"></a><span style=" font-family:'Verdana,sans-serif'; font-size:large; color:#000000; background-color:#ffffff;">П</span><span style=" font-family:'Verdana,sans-serif'; font-size:large; color:#000000; background-color:#ffffff;">ре-реквизиты</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Все, что нужно для прохождения этого пособия это базовые навыки с командной строкой и текстовым редактором. Опыт разработки веб-приложений будет полезен, но не обязателен. В течение работы мы столкнемся с несколькими облачными сервисами. Вам понадобится создать аккаунт на этих сайтах:</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://aws.amazon.com/"><span style=" color:#990099;">Amazon Web Services</span></a></li>
<li style=" font-family:'Verdana,sans-serif'; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://hub.docker.com/"><span style=" color:#990099;">Docker Hub</span></a></li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a name="setup"></a><span style=" font-family:'Verdana,sans-serif'; font-size:large; color:#000000; background-color:#ffffff;">Н</span><span style=" font-family:'Verdana,sans-serif'; font-size:large; color:#000000; background-color:#ffffff;">астройка компьютера</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Установка и настройка всех необходимых инструментов может быть тяжелой задачей, но, к счастью, Докер стал довольно стабильным, и установка и запуск его на любой ОС стало очень простой задачей. Итак, установим Докер.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; font-size:small; color:#000000; background-color:#ffffff;">Докер</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Еще несколько релизов назад запуск Докера на OS X и Windows был был проблемным. Но команда разработчиков проделала огромную работу, и сегодня весь процесс — проще некуда. Этот туториал</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> </span><span style=" font-family:'Verdana,sans-serif'; font-style:italic; color:#000000;">getting started</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> включает в себя подробные инструкции по установке на </span><a href="https://www.docker.com/products/docker#/mac"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">Мак</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;">, </span><a href="https://www.docker.com/products/docker#/linux"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">Linux</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> и </span><a href="https://www.docker.com/products/docker#/windows"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">Windows</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;">.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Проверим, все ли установлено корректно:</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ docker run hello-world</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">Hello from Docker.</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">This message shows that your installation appears to be working correctly.</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">...</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; font-size:small; color:#000000; background-color:#ffffff;">Python</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Python обычно предустановлен на OS X и на большинстве дистрибутивов Linux. Если вам нужно установить Питон, то скачайте установщик</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> </span><a href="https://www.python.org/downloads/"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">здесь</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;">.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Проверьте версию:</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ python --version</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">Python 2.7.11</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Мы будем использовать</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> </span><a href="https://pip.readthedocs.org/en/stable/"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">pip</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> для установки пакетов для нашего приложения. Если pip не установлен, то</span><a href="http://pip.readthedocs.org/en/stable/installing/"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">скачайте</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> версию для своей системы.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Для проверки запустите такую команду:</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ pip --version</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">pip 7.1.2 from /Library/Python/2.7/site-packages/pip-7.1.2-py2.7.egg (python 2.7)</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; font-size:small; color:#000000; background-color:#ffffff;">Java (не обязательно)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Разрабатываемое нами приложение будет использовать </span><a href="https://www.elastic.co/"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">Elasticsearch</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> для хранения и поиска. Для локального запуска Elasticsearch вам понадобится Java. В этом пособии все будет запускаться внутри контейнера, так что локально не обязательно иметь Java. Если Java установлена, то команда </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">java -version</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> должна сгенерировать подобный вывод:</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ java -version</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">java version </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;1.8.0_60&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">Java(TM) SE Runtime Environment (build 1.8.0_60-b27)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">Java HotSpot(TM) 64-Bit Server VM (build 25.60-b23, mixed mode)</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Verdana,sans-serif'; color:#000000;"></p>
<hr />
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a name="bb"></a><span style=" font-family:'Verdana,sans-serif'; font-size:x-large; color:#000000; background-color:#ffffff;">1</span><span style=" font-family:'Verdana,sans-serif'; font-size:x-large; color:#000000; background-color:#ffffff;">.0 Играем с Busybox</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Теперь, когда все необходимое установлено, пора взяться за работу. В этом разделе мы запустим контейнер</span><a href="https://en.wikipedia.org/wiki/BusyBox"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">Busybox</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> на нашей системе и попробуем запустить </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">docker run</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Для начала, запустите следующую команду:</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ docker pull busybox</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<p style=" margin-top:14px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;">Внимание: в зависимости от того, как вы устанавливали Докер на свою систему, возможно появление сообщения </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">permission denied</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">. Если вы на Маке, то удостоверьтесь, что движок Докер запущен. Если вы на Линуксе, то запустите эту команду с </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">sudo</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">. Или можете </span><a href="https://docs.docker.com/engine/installation/linux/ubuntulinux/#create-a-docker-group"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">создать группу docker</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> чтобы избавиться от этой проблемы.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;"><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Команда</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">pull</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> скачивает образ busybox из </span><a href="https://hub.docker.com/explore/"><span style=" font-family:'Verdana,sans-serif'; font-weight:696; color:#990099;">регистра Докера</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> и сохраняет его локально. Можно использовать команду </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">docker images</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">, чтобы посмотреть список образов в системе.</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ docker images</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">REPOSITORY              TAG                 IMAGE ID            CREATED             VIRTUAL SIZE</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">busybox                 latest              c51f86c28340        4 weeks ago         1.109 MB</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a name="dockerrun"></a><span style=" font-family:'Verdana,sans-serif'; font-size:large; color:#000000; background-color:#ffffff;">1</span><span style=" font-family:'Verdana,sans-serif'; font-size:large; color:#000000; background-color:#ffffff;">.1 Docker Run</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Отлично! Теперь давайте запустим Докер-</span><span style=" font-family:'Verdana,sans-serif'; font-weight:696; color:#000000;">контейнер</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> с этим образом. Для этого используем волшебную команду </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">docker run</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">:</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ docker run busybox</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Подождите, ничего не произошло! Это баг? Ну, нет. Под капотом произошло много всего. Докер-клиент нашел образ (в нашем случае, busybox), загрузил контейнер и запустил команду внутри этого контейнера. Мы сделали</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">docker run busybox</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">, но не указали никаких команд, так что контейнер загрузился, запустилась пустая команда и программа завершилась. Ну, да, как-то обидно, так что давайте сделаем что-то поинтереснее.</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ docker run busybox </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#0086b3; background-color:#f8f8f8;">echo</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;hello from busybox&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">hello from busybox</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Ура, наконец-то какой-то вывод. В нашем случае клиент Докера послушно запустил команду</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">echo</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> внутри контейнера, а потом вышел из него. Вы, наверное, заметили, что все произошло очень быстро. А теперь представьте себе, как нужно загружать виртуальную машину, запускать в ней команду и выключать ее. Теперь ясно, почему говорят, что контейнеры быстрые!</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Теперь давайте взглянем на команду</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">docker ps</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">. Она выводит на экран список всех запущенных контейнеров.</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ docker ps</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Контейнеров сейчас нет, поэтому выводится пустая строка. Не очень полезно, поэтому давайте запустим более полезный вариант: </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">docker ps -a</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ docker ps -a</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS                      PORTS               NAMES</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">305297d7a235        busybox             </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;uptime&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">            11 minutes ago      Exited (0) 11 minutes ago                       distracted_goldstine</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">ff0a5c3750b9        busybox             </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;sh&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">                12 minutes ago      Exited (0) 12 minutes ago                       elated_ramanujan</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Теперь виден список всех контейнеров, которые мы запускали. В колонке</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">STATUS</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> можно заметить, что контейнеры завершили свою работу несколько минут назад.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Вам, наверное, интересно, как запустить больше одной команды в контейнере. Давайте попробуем:</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ docker run -it busybox sh</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">/ </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-style:italic; color:#999988; background-color:#f8f8f8;"># ls</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">bin   dev   etc   home  proc  root  sys   tmp   usr   var</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">/ </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-style:italic; color:#999988; background-color:#f8f8f8;"># uptime</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> 05:45:21 up  5:58,  0 users,  load average: 0.00, 0.01, 0.04</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> </span></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Команда </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">run</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> с флагом </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">-it</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> подключает интерактивный tty в контейнер. Теперь можно запускать сколько угодно много команд внутри. Попробуйте.</span></p>
<p style=" margin-top:14px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; font-weight:696; color:#000000;">Опасно!</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">: Если хочется острых ощущений, то можете попробовать </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">rm -rf bin</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> в контейнере. Но удостоверьтесь, что запускаете ее внутри контейнера, а </span><span style=" font-family:'Verdana,sans-serif'; font-weight:696; color:#000000;">не снаружи</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">. Если сделаете это снаружи, на своем компьютере, то будет очень плохо, и команды вроде </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">ls</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">, </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">echo</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> перестанут работать. Когда внутри контейнера все перестанет работать, просто выйдете и запустите его заново командой </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">docker run -it busybox sh</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">. Докер создает новый контейнер при запуске, поэтому все заработает снова.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;"><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">На этом захватывающий тур по возможностям команды </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">docker run</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> закончен. Скорее всего, вы будете использовать эту команду довольно часто. Так что важно, чтобы мы поняли как с ней обращаться. Чтобы узнать больше о </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">run</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">, используйте </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">docker run --help</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">, и увидите полный список поддерживаемых флагов. Скоро мы увидим еще несколько способов использования </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">docker run</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Перед тем, как продолжать, давайте вкратце рассмотрим удаление контейнеров. Мы видели выше, что с помощью команды</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">docker ps -a</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> все еще можно увидеть остатки завершенных контейнеров. На протяжении этого пособия, вы будете запускать </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">docker run</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> несколько раз, и оставшиеся, бездомные контейнеры будут съедать дисковое пространство. Так что я взял за правило удалять контейнеры после завершения работы с ними. Для этого используется команда </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">docker rm</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">. Просто скопируйте ID (можно несколько) из вывода выше и передайте параметрами в команду.</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ docker rm 305297d7a235 ff0a5c3750b9</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">305297d7a235</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">ff0a5c3750b9</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">При удалении идентификаторы будут снова выведены на экран. Если нужно удалить много контейнеров, то вместо ручного копирования и вставления можно сделать так:</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ docker rm $(docker ps -a -q -f status=exited)</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Эта команда удаляет все контейнеры, у которых статус </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">exited</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">. Флаг </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">-q</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> возвращает только численные ID, а флаг </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">-f</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> фильтрует вывод на основе предоставленных условий. Последняя полезная деталь — команде </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">docker run</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> можно передать флаг </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">--rm</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">, тогда контейнер будет автоматически удаляться при завершении. Это очень полезно для разовых запусков и экспериментов с Докером.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Также можно удалять ненужные контейнеры командой </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">docker rmi</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a name="terminology"></a><span style=" font-family:'Verdana,sans-serif'; font-size:large; color:#000000; background-color:#ffffff;">1</span><span style=" font-family:'Verdana,sans-serif'; font-size:large; color:#000000; background-color:#ffffff;">.2 Терминология</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">В предыдущем разделе мы использовали много специфичного для Докера жаргона, и многих это может запутать. Перед тем, как продолжать, давайте разберем некоторые термины, которые часто используются в экосистеме Докера.</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">Images</span> (образы) - Схемы нашего приложения, которые являются основой контейнеров. В примере выше мы использовали команду <span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">docker pull</span> чтобы скачать образ <span style=" font-weight:696;">busybox</span>.</li>
<li style=" font-family:'Verdana,sans-serif'; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">Containers</span> (контейнеры) - Создаются на основе образа и запускают само приложение. Мы создали контейнер командой <span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">docker run</span>, и использовали образ busybox, скачанный ранее. Список запущенных контейнеров можно увидеть с помощью команды <span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">docker ps</span>.</li>
<li style=" font-family:'Verdana,sans-serif'; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">Docker Daemon</span> (демон Докера) - Фоновый сервис, запущенный на хост-машине, который отвечает за создание, запуск и уничтожение Докер-контейнеров. Демон — это процесс, который запущен на операционной системе, с которой взаимодействует клиент.</li>
<li style=" font-family:'Verdana,sans-serif'; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">Docker Client</span> (клиент Докера) - Утилита командной строки, которая позволяет пользователю взаимодействовать с демоном. Существуют другие формы клиента, например, <a href="https://kitematic.com/"><span style=" color:#990099;">Kitematic</span></a>, с графическим интерфейсом.</li>
<li style=" font-family:'Verdana,sans-serif'; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">Docker Hub</span> - <a href="https://hub.docker.com/explore/"><span style=" color:#990099;">Регистр</span></a> Докер-образов. Грубо говоря, архив всех доступных образов. Если нужно, то можно содержать собственный регистр и использовать его для получения образов.</li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a name="webapps"></a><span style=" font-family:'Verdana,sans-serif'; font-size:x-large; color:#000000; background-color:#ffffff;">2</span><span style=" font-family:'Verdana,sans-serif'; font-size:x-large; color:#000000; background-color:#ffffff;">.0 Веб-приложения и Докер</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Супер! Теперь мы научились работать с  </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">docker run</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">, поиграли с несколькими контейнерами и разобрались в терминологии. Вооруженные этими знаниями, мы готовы переходить к реальным штукам: деплою веб-приложений с Докером!</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a name="static"></a><span style=" font-family:'Verdana,sans-serif'; font-size:large; color:#000000; background-color:#ffffff;">2</span><span style=" font-family:'Verdana,sans-serif'; font-size:large; color:#000000; background-color:#ffffff;">.1 Статические сайты</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Давайте начнем с малого. Вначале рассмотрим самый простой статический веб-сайт. Скачаем образ из Docker Hub, запустим контейнер и посмотрим, насколько легко будет запустить веб-сервер.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Поехали. Для одностраничного</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> </span><a href="http://github.com/prakhar1989/docker-curriculum"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">сайта</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> нам понадобится образ, который я заранее создал для этого пособия и разместил в </span><a href="https://hub.docker.com/r/prakhar1989/static-site/"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">регистре</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> - </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">prakhar1989/static-site</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">. Можно скачать образ напрямую командой </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">docker run</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">.</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ docker run prakhar1989/static-site</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Так как образа не существует локально, клиент сначала скачает образ из регистра, а потом запустит его. Если все без проблем, то вы увидите сообщение</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">Nginx is running...</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> в терминале. Теперь сервер запущен. Как увидеть сайт в действии? На каком порту работает сервер? И, что самое важное, как напрямую достучаться до контейнера из хост-контейнера?</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">В нашем случае клиент не открывает никакие порты, так что нужно будет перезапустить команду  </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">docker run</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> чтобы сделать порты публичными. Заодно давайте сделаем так, чтобы терминал не был прикреплен к запущенному контейнеру. В таком случае можно будет спокойно закрыть терминал, а контейнер продолжит работу. Это называется </span><span style=" font-family:'Verdana,sans-serif'; font-weight:696; color:#000000;">detached</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> mode.</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ docker run -d -P --name static-site prakhar1989/static-site</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">e61d12292d69556eabe2a44c16cbd54486b2527e2ce4f95438e504afb7b02810</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Флаг </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">-d</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> открепит (detach) терминал, флаг </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">-P</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> сделает все открытые порты публичными и случайными, и, наконец, флаг </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">--name</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> это имя, которое мы хотим дать контейнеру. Теперь можно увидеть порты с помощью команды </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">docker port [CONTAINER]</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">.</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ docker port static-site</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">80/tcp -&gt; 0.0.0.0:32769</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">443/tcp -&gt; 0.0.0.0:32768</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Откройте </span><a href="http://localhost:32769/"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">http://localhost:32769</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> в своем браузере.</span></p>
<p style=" margin-top:14px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;">Замечание: Если вы используете docker-toolbox, то, возможно, нужно будет использовать </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">docker-machine ip default</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> чтобы получить IP-адрес.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;"><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Также можете обозначить свой порт. Клиент будет перенаправлять соединения на него.</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ docker run -p 8888:80 prakhar1989/static-site</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">Nginx is running...</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><img src="image7361.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Чтобы остановить контейнер запустите </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">docker stop</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> и укажите идентификатор (ID) контейнера.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Согласитесь, все было очень просто. Чтобы задеплоить это на реальный сервер, нужно просто установить Докер и запустить команду выше. Теперь, когда вы увидели, как запускать веб-сервер внутри образа, вам, наверное, интересно — а как создать свой Докер-образ? Мы будем изучать эту тему в следующем разделе.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a name="images"></a><span style=" font-family:'Verdana,sans-serif'; font-size:large; color:#000000; background-color:#ffffff;">2</span><span style=" font-family:'Verdana,sans-serif'; font-size:large; color:#000000; background-color:#ffffff;">.2 Образы</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Мы касались образов ранее, но в этом разделе мы заглянем глубже: что такое Докер-образы и как создавать собственные образы. Наконец, мы используем собственный образ чтобы запустить приложение локально, а потом задеплоим его на </span><a href="http://aws.amazon.com/"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">AWS</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;">, чтобы показать друзьям. Круто? Круто! Давайте начнем.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Образы это основы для контейнеров. В прошлом примере мы скачали (</span><span style=" font-family:'Verdana,sans-serif'; font-weight:696; color:#000000;">pull</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">) образ под названием </span><span style=" font-family:'Verdana,sans-serif'; font-style:italic; color:#000000;">Busybox</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> из регистра, и попросили клиент Докера запустить контейнер, </span><span style=" font-family:'Verdana,sans-serif'; font-weight:696; color:#000000;">основанный</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> на этом образе. Чтобы увидеть список доступных локально образов, используйте команду </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">docker images</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">.</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ docker images</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">REPOSITORY                      TAG                 IMAGE ID            CREATED             VIRTUAL SIZE</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">prakhar1989/catnip              latest              c7ffb5626a50        2 hours ago         697.9 MB</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">prakhar1989/static-site         latest              b270625a1631        21 hours ago        133.9 MB</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">python                          3-onbuild           cf4002b2c383        5 days ago          688.8 MB</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">martin/docker-cleanup-volumes   latest              b42990daaca2        7 weeks ago         22.14 MB</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">ubuntu                          latest              e9ae3c220b23        7 weeks ago         187.9 MB</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">busybox                         latest              c51f86c28340        9 weeks ago         1.109 MB</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">hello-world                     latest              0a6ba66e537a        11 weeks ago        960 B</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Это список образов, которые я скачал из регистра, а также тех, что я сделал сам (скоро увидим, как это делать).</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">TAG</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> — это конкретный снимок или снэпшот (snapshot) образа, а </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">IMAGE ID</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> — это соответствующий уникальный идентификатор образа.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Для простоты, можно относиться к образу как к git-репозиторию. Образы можно </span><a href="https://docs.docker.com/engine/reference/commandline/commit/"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">коммитить</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> с изменениями, и можно иметь несколько версий. Если не указывать конкретную версию, то клиент по умолчанию использует</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">latest</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">. Например, можно скачать определенную версию образа </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">ubuntu</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">:</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ docker pull ubuntu:12.04</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Чтобы получить новый Докер-образ, можно скачать его из регистра (такого, как Docker Hub) или создать собственный. На</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> </span><a href="https://hub.docker.com/explore/"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">Docker Hub</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> есть десятки тысяч образов. Можно искать напрямую из командной строки с помощью </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">docker search</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Важно понимать разницу между базовыми и дочерними образами:</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:696;">Base images</span> (базовые образы) — это образы, которые не имеют родительского образа. Обычно это образы с операционной системой, такие как ubuntu, busybox или debian.</li>
<li style=" font-family:'Verdana,sans-serif'; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:696;">Child images</span> (дочерние образы) — это образы, построенные на базовых образах и обладающие дополнительной функциональностью.</li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Существуют официальные и пользовательские образы, и любые из них могут быть базовыми и дочерними.</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:696;">Официальные образы</span> — это образы, которые официально поддерживаются командой Docker. Обычно в их названии одно слово. В списке выше <span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">python</span>, <span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">ubuntu</span>, <span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">busybox</span> и <span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">hello-world</span> — базовые образы.</li>
<li style=" font-family:'Verdana,sans-serif'; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:696;">Пользовательские образы</span> — образы, созданные простыми пользователями вроде меня и вас. Они построены на базовых образах. Обычно, они называются по формату <span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">user/image-name</span>.</li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a name="ownimage"></a><span style=" font-family:'Verdana,sans-serif'; font-size:large; color:#000000; background-color:#ffffff;">2</span><span style=" font-family:'Verdana,sans-serif'; font-size:large; color:#000000; background-color:#ffffff;">.3 Наш первый образ</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Теперь, когда мы лучше понимаем, что такое образы и какие они бывают, самое время создать собственный образ. Цель этого раздела — создать образ с простым приложением на</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> </span><a href="http://flask.pocoo.org/"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">Flask</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;">. Для этого пособия я сделал маленькое </span><a href="https://github.com/prakhar1989/docker-curriculum/tree/master/flask-app"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">приложение</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;">, которое выводит случайную гифку с кошкой. Ну, потому что, кто не любит кошек? Склонируйте этот репозиторий к себе на локальную машину.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Вначале давайте проверим, что приложение работает локально. Войдите в директорию</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">flask-app</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">командой </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">cd</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> и установите зависимости.</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#0086b3; background-color:#f8f8f8;">cd</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> flask-app</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ pip install -r requirements.txt</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ python app.py</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> * Running on http://0.0.0.0:5000/ (Press CTRL+C to quit)</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> </span></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Если все хорошо, то вы увидите вывод как в примере выше. Зайдите на </span><a href="http://localhost:5000/"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">http://localhost:5000</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> чтобы увидеть приложение в действии.</span></p>
<p style=" margin-top:14px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;">Замечание: Если команда </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">pip install</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> падает с ошибками &quot;permission denied&quot;, то попробуйте запустить ее с </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">sudo</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">. Если не хотите устанавливать пользовательские пакеты на уровне системы, то используйте команду </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">pip install --user -r requirements.txt</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;"><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Выглядит отлично, правда? Теперь нужно создать образ с приложением. Как говорилось выше, все пользовательские образы основаны на базовом образе. Так как наше приложение написано на Питоне, нам нужен базовый образ</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> </span><a href="https://hub.docker.com/_/python/"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">Python 3</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;">. В частности, нам нужна версия </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">python:3-onbuild</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> базового образа с Питоном.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Что за версия</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">onbuild</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">, спросите вы?</span></p>
<p style=" margin-top:14px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;">Эти образы включают несколько триггеров ONBUILD, которых обычно достаточно чтобы быстро развернуть приложение. При сборке будет скопирован файл </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">requirements.txt</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">, будет запущен </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">pip install</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> с этим файлом, а потом текущая директория будет скопирована в </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">/usr/src/app</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;"><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Другими словами, версия </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">onbuild</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> включает хелперы, которые автоматизируют скучные процессы запуска приложения. Вместо того, чтобы вручную выполнять эти задачи (или писать скрипты), образы делают все за вас. Теперь у нас есть все ингредиенты для создания своего образа: работающее веб-приложение и базовый образ. Как это сделать? Ответ: использовать </span><span style=" font-family:'Verdana,sans-serif'; font-weight:696; color:#000000;">Dockerfile</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a name="dockerfile"></a><span style=" font-family:'Verdana,sans-serif'; font-size:large; color:#000000; background-color:#ffffff;">2</span><span style=" font-family:'Verdana,sans-serif'; font-size:large; color:#000000; background-color:#ffffff;">.4 Dockerfile</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a href="https://docs.docker.com/engine/reference/builder/"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">Dockerfile</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> — это простой текстовый файл, в котором содержится список команд Докер-клиента. Это простой способ автоматизировать процесс создания образа. Самое классное, что </span><a href="https://docs.docker.com/engine/reference/builder/#from"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">команды</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> в Dockerfile</span><span style=" font-family:'Verdana,sans-serif'; font-style:italic; color:#000000;">почти</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> идентичны своим аналогам в Linux. Это значит, что в принципе не нужно изучать никакой новый синтаксис чтобы начать работать с докерфайлами.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">В директории с приложением есть Dockerfile, но так как мы делаем все впервые, нам нужно создать его с нуля. Создайте новый пустой файл в любимом текстовом редакторе, и сохраните его в</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> </span><span style=" font-family:'Verdana,sans-serif'; font-weight:696; color:#000000;">той же</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> директории, где находится flask-приложение. Назовите файл </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">Dockerfile</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Для начала укажем базовый образ. Для этого нужно использовать ключевое слово </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">FROM</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">.</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">FROM python:3-onbuild</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Дальше обычно указывают команды для копирования файлов и установки зависимостей. Но к счастью,</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">onbuild</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">-версия базового образа берет эти задачи на себя. Дальше нам нужно указать порт, который следует открыть. Наше приложение работает на порту 5000, поэтому укажем его:</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">EXPOSE 5000</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Последний шаг — указать команду для запуска приложения. Это просто</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">python ./app.py</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">. Для этого используем команду </span><a href="https://docs.docker.com/engine/reference/builder/#cmd"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">CMD</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;">:</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">CMD [</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;python&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">, </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;./app.py&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">]</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Главное предназначение </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">CMD</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> — это сообщить контейнеру какие команды нужно выполнить при старте. Теперь наш </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">Dockerfile</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> готов. Вот как он выглядит:</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-style:italic; color:#999988; background-color:#f8f8f8;"># our base image</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">FROM python:3-onbuild</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-style:italic; color:#999988; background-color:#f8f8f8;"># specify the port number the container should expose</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">EXPOSE 5000</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-style:italic; color:#999988; background-color:#f8f8f8;"># run the application</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">CMD [</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;python&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">, </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;./app.py&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">]</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Теперь можно создать образ. Команда </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">docker build</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> занимается сложной задачей создания образа на основе </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">Dockerfile</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Листинг ниже демонстрирует процесс. Перед тем, как запустите команду сами (не забудьте точку в конце), проверьте, чтобы там был ваш username вместо моего. Username должен соответствовать тому, что использовался при регистрации на</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> </span><a href="https://hub.docker.com/"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">Docker hub</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;">. Если вы еще не регистрировались, то сделайте это до выполнения команды. Команда </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">docker build</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> довольно проста: она принимает опциональный тег с флагом </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">-t</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> и путь до директории, в которой лежит </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">Dockerfile</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">.</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ docker build -t prakhar1989/catnip .</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">Sending build context to Docker daemon 8.704 kB</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">Step 1 : FROM python:3-onbuild</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-style:italic; color:#999988; background-color:#f8f8f8;"># Executing 3 build triggers...</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">Step 1 : COPY requirements.txt /usr/src/app/</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> ---&gt; Using cache</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">Step 1 : RUN pip install --no-cache-dir -r requirements.txt</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> ---&gt; Using cache</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">Step 1 : COPY . /usr/src/app</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> ---&gt; 1d61f639ef9e</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">Removing intermediate container 4de6ddf5528c</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">Step 2 : EXPOSE 5000</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> ---&gt; Running </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-weight:696; color:#333333; background-color:#f8f8f8;">in</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> 12cfcf6d67ee</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> ---&gt; f423c2f179d1</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">Removing intermediate container 12cfcf6d67ee</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">Step 3 : CMD python ./app.py</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> ---&gt; Running </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-weight:696; color:#333333; background-color:#f8f8f8;">in</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> f01401a5ace9</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> ---&gt; 13e87ed1fbc2</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">Removing intermediate container f01401a5ace9</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">Successfully built 13e87ed1fbc2</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Если у вас нет образа </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">python:3-onbuild</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">, то клиент сначала скачает его, а потом возьмется за создание вашего образа. Так что, вывод на экран может отличаться от моего. Посмотрите внимательно, и найдете триггеры onbuild. Если все прошло хорошо, то образ готов! Запустите </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">docker images</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> и увидите свой образ в списке.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Последний шаг — запустить образ и проверить его работоспособность (замените username на свой):</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ docker run -p 8888:5000 prakhar1989/catnip</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> * Running on http://0.0.0.0:5000/ (Press CTRL+C to quit)</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> </span></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Зайдите на указанный URL и увидите приложение в работе.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><img src="image6964.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Поздравляю! Вы успешно создали свой первый образ Докера!</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a name="aws"></a><span style=" font-family:'Verdana,sans-serif'; font-size:large; color:#000000; background-color:#ffffff;">2</span><span style=" font-family:'Verdana,sans-serif'; font-size:large; color:#000000; background-color:#ffffff;">.5 Docker на AWS</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Что хорошего в приложении, которое нельзя показать друзьям, правда? Так что в этом разделе мы научимся деплоить наше офигенное приложение в облако. Будем использовать AWS </span><a href="https://aws.amazon.com/elasticbeanstalk/"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">Elastic Beanstalk</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> чтобы решить эту задачу за пару кликов. Мы увидим, как с помощью Beanstalk легко управлять и масштабировать наше приложение.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; font-size:small; color:#000000; background-color:#ffffff;">Docker push</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Первое, что нужно сделать перед деплоем на AWS это опубликовать наш образ в регистре, чтобы можно было скачивать его из AWS. Есть несколько </span><a href="https://aws.amazon.com/ecr/"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">Docker-регистров</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> (или можно создать </span><a href="https://docs.docker.com/registry/deploying/"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">собственный</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;">). Для начала, давайте используем </span><a href="https://hub.docker.com/"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">Docker Hub</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;">. Просто выполните:</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ docker push prakhar1989/catnip</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Если это ваша первая публикация, то клиент попросит вас залогиниться. Введите те же данные, что используете для входа в Docker Hub.</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ docker login</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">Username: prakhar1989</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">WARNING: login credentials saved </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-weight:696; color:#333333; background-color:#f8f8f8;">in</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> /Users/prakhar/.docker/config.json</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">Login Succeeded</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Не забудьте заменить название образа на свое. Очень важно сохранить формат</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">username/image_name</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">, чтобы клиент понимал, куда публиковать образ.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">После этого можете посмотреть на свой образ на Docker Hub. Например, вот</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> </span><a href="https://hub.docker.com/r/prakhar1989/catnip/"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">страница</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> моего образа.</span></p>
<p style=" margin-top:14px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;">Замечание: один важный момент, который стоит прояснить перед тем, как продолжить — </span><span style=" font-family:'Verdana,sans-serif'; font-weight:696; color:#000000;">не обязательно</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">хранить образ в публичном регистре (или в любом другом регистре вообще) чтобы деплоить на AWS. Если вы пишете код для следующего многомиллионного стартапа-единорога, то можно пропустить этот шаг. Мы публикуем свой образ чтобы упростить деплой, пропустив несколько конфигурационных шагов.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;"><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Теперь наш образ онлайн, и любой докер-клиент может поиграться с ним с помощью простой команды:</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ docker run -p 8888:5000 prakhar1989/catnip</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Если в прошлом вы мучались с установкой локального рабочего окружения и попытками поделиться своей конфигурацией с коллегами, то понимаете, как круто это звучит. Вот почему Докер — это сила!</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; font-size:small; color:#000000; background-color:#ffffff;">Beanstalk</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">AWS Elastic Beanstalk (EB) это PaaS (Platform as a Service — платформа как сервис) от Amazon Web Services. Если вы использовали Heroku, Google App Engine и т.д., то все будет привычно. Как разработчик, вы сообщаете EB как запускать ваше приложение, а EB занимается всем остальным, в том числе масштабированием, мониторингом и даже апдейтами. В апреле 2014 в EB добавили возможность запускать Докер-контейнеры, и мы будем использовать именно эту возможность для деплоя. У EB очень понятный</span><a href="http://docs.aws.amazon.com/elasticbeanstalk/latest/dg/eb-cli3.html"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">интерфейс командной строки</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;">, но он требует небольшой конфигурации, поэтому для простоты давайте используем веб-интерфейс для запуска нашего приложения.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Чтобы продолжать, вам потребуется работающий аккаунт на</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> </span><a href="http://aws.amazon.com/"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">AWS</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;">. Если у вас его нет, то создайте его. Для этого потребуется ввести данные кредитной карты. Но не волнуйтесь, эта услуга бесплатна, и все, что будет происходить в рамках этого пособия тоже бесплатно.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Давайте начнем:</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Войдите в свою <a href="http://console.aws.amazon.com/"><span style=" color:#990099;">консоль AWS</span></a>.</li>
<li style=" font-family:'Verdana,sans-serif'; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Нажмите на Elastic Beanstalk. Ссылка находится в секции compute, в левом верхнем углу. Или просто<a href="https://console.aws.amazon.com/elasticbeanstalk"><span style=" color:#990099;">перейдите сюда</span></a>.</li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><img src="image1955.png" /></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Нажмите на &quot;Create New Application&quot; в верхнем правом углу.</li>
<li style=" font-family:'Verdana,sans-serif'; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Дайте своему приложению запоминающееся (но уникальное) имя и, если хотите, добавьте описание.</li>
<li style=" font-family:'Verdana,sans-serif'; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">на экране <span style=" font-weight:696;">New Environment</span> выберите <span style=" font-weight:696;">Web Server Environment</span>.</li>
<li style=" font-family:'Verdana,sans-serif'; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Следующий экран показан ниже. Выберите <span style=" font-style:italic;">Docker</span> из готовых вариантов конфигурации. Можно оставить <span style=" font-style:italic;">Environment type</span> как есть. Нажмите Next.</li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><img src="image15022.png" /></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Тут мы будем сообщать системе EB о нашем образе. Откройте <a href="https://github.com/prakhar1989/docker-curriculum/blob/master/flask-app/Dockerrun.aws.json"><span style=" color:#990099;">файл Dockerrun.aws.json</span></a> в директории<span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">flask-app</span> и измените <span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">Name</span> образа, чтобы оно соответствовало названию вашего образа. Не волнуйтесь, я опишу содержание файла попозже. Потом выберите вариант &quot;upload your own&quot; и выберите файл.</li>
<li style=" font-family:'Verdana,sans-serif'; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Далее, выберите название окружения и URL. Этот URL как раз можно будет давать друзьям, так что постарайтесь придумать что-нибудь попроще.</li>
<li style=" font-family:'Verdana,sans-serif'; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Пока не будем вносить никаких правок в секцию <span style=" font-style:italic;">Additional Resources</span>. Нажмите Next и переходите к<span style=" font-style:italic;">Configuration Details</span>.</li>
<li style=" font-family:'Verdana,sans-serif'; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В этой секции вам нужно выбрать тип инстанса <span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">t1.micro</span>. Это очень важно, потому что это <span style=" font-weight:696;">бесплатный</span> тип от AWS. Если хотите, можно выбрать пару ключей для входа. Если вы не знаете, что это значит, то не волнуйтесь и просто пропустите эту часть. Все остальное можно оставить по умолчанию и продолжать.</li>
<li style=" font-family:'Verdana,sans-serif'; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Также не нужно указывать никакие <span style=" font-style:italic;">Environment Tags</span> and <span style=" font-style:italic;">Permissions</span>, так что просто жмите Next два раза подряд. В конце будет экран <span style=" font-style:italic;">Review</span>. Если все выглядит нормально, то нажимайте кнопку <span style=" font-weight:696;">Launch</span>.</li>
<li style=" font-family:'Verdana,sans-serif'; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">На последнем экране будет несколько спиннеров. Это поднимается и настраивается ваше окружение. Обычно, нужно около пяти минут для первой настройки.</li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Пока ждем, давайте быстренько взглянем на файл </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">Dockerrun.aws.json</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">. Это файл для AWS, в котором находится информация о приложении конфигурации Докера. EB получает информацию из этого файла.</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">{</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">  </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;AWSEBDockerrunVersion&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">: </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;1&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">,</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">  </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;Image&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">: {</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">    </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;Name&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">: </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;prakhar1989/catnip&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">,</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">    </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;Update&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">: </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;true&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">  },</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">  </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;Ports&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">: [</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">    {</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">      </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;ContainerPort&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">: </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;5000&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">    }</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">  ],</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">  </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;Logging&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">: </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;/var/log/nginx&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">}</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Файл довольно понятный, но всегда можно обратиться к</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> </span><a href="http://docs.aws.amazon.com/elasticbeanstalk/latest/dg/create_deploy_docker_image.html#create_deploy_docker_image_dockerrun"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">официальной документации</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;">. Мы указываем название образа, и EB будет использовать его заодно с портом.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">К этому моменту инстанс уже должен быть готов. Зайдите на страницу EB и увидите зеленый индикатор успешного запуска приложения.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><img src="image26999.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Зайдите на указанный URL в браузере и увидите приложение во все красе. Пошлите адрес своим друзьям, чтобы все могли насладиться гифками с кошками.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Поздравляю! Вы задеплоили свое первое Докер-приложение! Может показаться, что было очень много шагов, но с командной утилитой EB можно имитировать функциональность Хероку несколькими нажатиями клавиш. Надеюсь, вы согласитесь, что Докер сильно упрощает процесс и минимизирует болезненные моменты деплоя в облако. Я советую вам почитать</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> </span><a href="http://docs.aws.amazon.com/elasticbeanstalk/latest/dg/docker-singlecontainer-deploy.html"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">документацию AWS</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> про single-container Docker environment чтобы понимать, какие существуют возможности в EB.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">В следующей, последней части пособия, мы пойдем немного дальше и задеплоим приложение, приближенное к реальному миру. В нем будет постоянное бэкэнд-хранилище. Поехали!</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a name="multi"></a><span style=" font-family:'Verdana,sans-serif'; font-size:x-large; color:#000000; background-color:#ffffff;">3</span><span style=" font-family:'Verdana,sans-serif'; font-size:x-large; color:#000000; background-color:#ffffff;">.0 Многоконтейнерные окружения</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">В прошлом разделе мы увидели, как легко и просто запускать приложения с помощью Докера. Мы начали с простого статического сайта, а потом запустили Flask-приложение. Оба варианта можно было запускать локально или в облаке, несколькими командами. Общая черта этих приложений: каждое из них работало </span><span style=" font-family:'Verdana,sans-serif'; font-weight:696; color:#000000;">в одном контейнере</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Если у вас есть опыт управления сервисами в продакшене, то вы знаете, что современные приложения обычно не такие простые. Почти всегда есть база данных (или другой тип постоянного хранилища). Системы вроде</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> </span><a href="http://redis.io/"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">Redis</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> и </span><a href="http://memcached.org/"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">Memcached</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> стали практически обязательной частью архитектуры веб-приложений. Поэтому, в этом разделе мы научимся &quot;докеризировать&quot; приложения, которым требуется несколько запущенных сервисов.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">В частности, мы увидим, как запускать и управлять</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> </span><span style=" font-family:'Verdana,sans-serif'; font-weight:696; color:#000000;">многоконтейнерными</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> Докер-окружениями. Почему нужно несколько контейнеров, спросите вы? Ну, одна из главных идей Докера в том, что он предоставляет изоляцию. Идея совмещения процесса и его зависимостей в одной песочнице (называемой контейнером) и делает Докер мощным инструментом.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Аналогично тому, как приложение разбивают на части, стоит содержать отдельные</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> </span><span style=" font-family:'Verdana,sans-serif'; font-weight:696; color:#000000;">сервисы</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> в отдельных контейнерах. Разным частям скорее всего требуются разные ресурсы, и требования могут расти с разной скоростью. Если мы разделим эти части и поместим в разные контейнеры, то можно каждую часть приложения можно строить, используя наиболее подходящий тип ресурсов. Это также хорошо совмещается с идеей </span><a href="http://martinfowler.com/articles/microservices.html"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">микро сервисов</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;">. Это одна из причин, по которой Докер (и любая другая технология контейнеризации) находится на </span><a href="https://medium.com/aws-activate-startup-blog/using-containers-to-build-a-microservices-architecture-6e1b8bacb7d1#.xl3wryr5z"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">передовой</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> современных микро сервисных архитектур.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a name="sfft"></a><span style=" font-family:'Verdana,sans-serif'; font-size:large; color:#000000; background-color:#ffffff;">3</span><span style=" font-family:'Verdana,sans-serif'; font-size:large; color:#000000; background-color:#ffffff;">.1 SF Food Trucks</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Приложение, которое мы переведем в Докер, называется</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> </span><a href="http://sf-foodtrucks.xyz/"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">SF Food Trucks</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;">. Моя цель была сделать что-то полезное (и похожее на настоящее приложение из реального мира), что-то, что использует как минимум один сервис, но не слишком сложное для этого пособия. Вот что я придумал.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><img src="image12944.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Бэкэнд приложения написано на Питоне (Flask), а для поиска используется </span><a href="https://www.elastic.co/products/elasticsearch"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">Elasticsearch</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;">. Как и все остальное в этом пособии, код находится на </span><a href="http://github.com/prakhar1989/FoodTrucks"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">Github</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;">. Мы используем это приложение, чтобы научиться запускать и деплоить много-контейнерное окружение.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Теперь, когда вы завелись (надеюсь), давайте подумаем, как будет выглядеть этот процесс. В нашем приложении есть бэкэнд на Flask и сервис Elasticsearch. Очевидно, что можно поделить приложение на два контейнера: один для Flask, другой для Elasticsearch (ES). Если приложение станет популярным, то можно будет добавлять новые контейнеры в нужном месте, смотря где будет узкое место.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Отлично, значит нужно два контейнера. Это не сложно, правда? Мы уже создавали Flask-контейнер в прошлом разделе. А для Elasticsearch… давайте посмотрим, есть ли что-нибудь в хабе:</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ docker search elasticsearch</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">NAME                              DESCRIPTION                                     STARS     OFFICIAL   AUTOMATED</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">elasticsearch                     Elasticsearch is a powerful open </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#0086b3; background-color:#f8f8f8;">source</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> se...   697       [OK]</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">itzg/elasticsearch                Provides an easily configurable Elasticsea...   17                   [OK]</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">tutum/elasticsearch               Elasticsearch image - listens </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-weight:696; color:#333333; background-color:#f8f8f8;">in</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> port 9200.     15                   [OK]</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">barnybug/elasticsearch            Latest Elasticsearch 1.7.2 and previous re...   15                   [OK]</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">digitalwonderland/elasticsearch   Latest Elasticsearch with Marvel &amp; Kibana       12                   [OK]</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">monsantoco/elasticsearch          ElasticSearch Docker image                      9                    [OK]</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Не удивительно, но существуют официальный</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> </span><a href="https://hub.docker.com/_/elasticsearch/"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">образ</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> для Elasticsearch. Чтобы запустить ES, нужно всего лишь выполнить </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">docker run</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">, и вскоре у нас будет локальный, работающий контейнер с одним узлом ES.</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ docker run -dp 9200:9200 elasticsearch</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">d582e031a005f41eea704cdc6b21e62e7a8a42021297ce7ce123b945ae3d3763</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ curl 0.0.0.0:9200</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">{</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">  </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;name&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> : </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;Ultra-Marine&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">,</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">  </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;cluster_name&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> : </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;elasticsearch&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">,</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">  </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;version&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> : {</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">    </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;number&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> : </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;2.1.1&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">,</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">    </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;build_hash&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> : </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;40e2c53a6b6c2972b3d13846e450e66f4375bd71&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">,</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">    </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;build_timestamp&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> : </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;2015-12-15T13:05:55Z&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">,</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">    </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;build_snapshot&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> : </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#008080; background-color:#f8f8f8;">false</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">,</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">    </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;lucene_version&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> : </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;5.3.1&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">  },</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">  </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;tagline&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> : </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;You Know, for Search&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">}</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Заодно давайте запустим контейнер с Flask. Но вначале нужен</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">Dockerfile</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">. В прошлой секции мы использовали образ </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">python:3-onbuild</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> в качестве базового. Однако, в этом раз, кроме установки зависимостей через </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">pip</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">, нам нужно, чтобы приложение генерировало </span><a href="http://sf-foodtrucks.xyz/static/build/main.js"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">минимизированный Javascript-файл</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;">для продакшена. Для этого понадобится Nodejs. Так что нужен свой билд с нуля, поэтому начнем с базового образа </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">ubuntu</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">.</span></p>
<p style=" margin-top:14px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;">Замечание: если оказывается, что существующий образ не подходит для вашей задачи, то спокойно создавайте свой образ на основе другого базового образа. В большинстве случаем, для образов на Docker Hub можно найти соответствующий </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">Dockerfile</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> на Github. Почитайте существующий Докерфайлы — это один из лучших способов научиться делать свои образы.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;"><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Наш</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> </span><a href="https://github.com/prakhar1989/FoodTrucks/blob/master/Dockerfile"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">Dockerfile</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> для Flask-приложения выглядит следующим образом:</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-style:italic; color:#999988; background-color:#f8f8f8;"># start from base</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">FROM ubuntu:14.04</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">MAINTAINER Prakhar Srivastav &lt;prakhar@prakhar.me&gt;</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-style:italic; color:#999988; background-color:#f8f8f8;"># install system-wide deps for python and node</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">RUN apt-get -yqq update</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">RUN apt-get -yqq install python-pip python-dev</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">RUN apt-get -yqq install nodejs npm</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">RUN ln -s /usr/bin/nodejs /usr/bin/node</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-style:italic; color:#999988; background-color:#f8f8f8;"># copy our application code</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">ADD flask-app /opt/flask-app</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">WORKDIR /opt/flask-app</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-style:italic; color:#999988; background-color:#f8f8f8;"># fetch app specific deps</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">RUN npm install</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">RUN npm run build</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">RUN pip install -r requirements.txt</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-style:italic; color:#999988; background-color:#f8f8f8;"># expose port</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">EXPOSE 5000</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-style:italic; color:#999988; background-color:#f8f8f8;"># start app</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">CMD [ </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;python&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">, </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;./app.py&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> ]</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Тут много всего нового. Вначале указан базовый образ</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> </span><a href="https://wiki.ubuntu.com/LTS"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">Ubuntu LTS</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;">, потом используется пакетный менеджер </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">apt-get</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> для установки зависимостей, в частности — Python и Node. Флаг </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">yqq</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> нужен для игнорирования вывода и автоматического выбора &quot;Yes&quot; во всех местах. Также создается символическая ссылка для бинарного файла node. Это нужно для решения проблем обратной совместимости.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Потом мы используем команду </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">ADD</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> для копирования приложения в нужную директорию в контейнере —</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">/opt/flask-app</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">. Здесь будет находиться весь наш код. Мы также устанавливаем эту директорию в качестве рабочей, так что следующие команды будут выполняться в контексте этой локации. Теперь, когда наши системные зависимости установлены, пора установить зависимости уровня приложения. Начнем с Node, установки пакетов из npm и запуска команды сборки, как указано в нашем </span><a href="https://github.com/prakhar1989/FoodTrucks/blob/master/flask-app/package.json#L7-L9"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">файле package.json</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;">. В конце устанавливаем пакеты Python, открываем порт и определяем запуск приложения с помощь </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">CMD</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">, как в предыдущем разделе.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Наконец, можно собрать образ и запустить контейнер (замените</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">prakhar1989</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> на свой username ниже).</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ docker build -t prakhar1989/foodtrucks-web .</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">При первом запуске нужно будет больше времени, так как клиент Докера будет скачивать образ ubuntu, запускать все команды и готовить образ. Повторный запуск </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">docker build</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> после последующих изменений будет практически моментальным. Давайте попробуем запустить приложение</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ docker run -P prakhar1989/foodtrucks-web</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">Unable to connect to ES. Retying </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-weight:696; color:#333333; background-color:#f8f8f8;">in</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> 5 secs...</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">Unable to connect to ES. Retying </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-weight:696; color:#333333; background-color:#f8f8f8;">in</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> 5 secs...</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">Unable to connect to ES. Retying </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-weight:696; color:#333333; background-color:#f8f8f8;">in</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> 5 secs...</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">Out of retries. Bailing out...</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Упс! Наше приложение не смогло запуститься, потому что оно не может подключиться к Elasticsearch. Как сообщить одному контейнеру о другом и как заставить их взаимодействовать друг с другом? Ответ — в следующей секции.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a name="net"></a><span style=" font-family:'Verdana,sans-serif'; font-size:large; color:#000000; background-color:#ffffff;">3</span><span style=" font-family:'Verdana,sans-serif'; font-size:large; color:#000000; background-color:#ffffff;">.2 Сети Docker</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Перед тем, как обсудить возможности Докера для решения описанной задачи, давайте посмотрим на возможные варианты обхода проблемы. Думаю, это поможет нам оценить удобство той функциональности, которую мы вскоре изучим.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Ладно, давайте запустим </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">docker ps</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">, что тут у нас:</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ docker ps</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                              NAMES</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">e931ab24dedc        elasticsearch       </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;/docker-entrypoint.s&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">   2 seconds ago       Up 2 seconds        0.0.0.0:9200-&gt;9200/tcp, 9300/tcp   cocky_spence</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Итак, у нас есть контейнер ES по адресу и порту </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">0.0.0.0:9200</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">, и мы можем напрямую обращаться к нему. Если можно было бы сообщить нашему приложению подключаться к этому адресу, то оно сможет общаться с ES, верно? Давайте взглянем на </span><a href="https://github.com/prakhar1989/FoodTrucks/blob/master/flask-app/app.py#L7"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">код на Питоне</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;">, туда, где описано подключение.</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">es = Elasticsearch(host=</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">'es'</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">)</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Нужно сообщить Flask-контейнеру, что контейнер ES запущен на хосте</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">0.0.0.0</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> (порт по умолчанию </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">9200</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">), и все заработает, да? К сожалению, нет, потому что IP </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">0.0.0.0</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> это адрес для доступа к контейнеру с  </span><span style=" font-family:'Verdana,sans-serif'; font-weight:696; color:#000000;">хост-машины</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">, то есть с моего Мака. Другой контейнер не сможет обратиться по этому адресу. Ладно, если не этот адрес, то какой другой адрес нужно использовать для работы с контейнером ES? Рад, что вы спросили.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Это хороший момент, чтобы изучить работу сети в Докере. После установки, Докер автоматически создает три сети:</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ docker network ls</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">NETWORK ID          NAME                DRIVER</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">075b9f628ccc        none                null</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">be0f7178486c        host                host</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">8022115322ec        bridge              bridge</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Сеть </span><span style=" font-family:'Verdana,sans-serif'; font-weight:696; color:#000000;">bridge</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> — это сеть, в которой контейнеры запущены по умолчанию. Это значит, что когда я запускаю контейнер ES, он работает в этой сети bridge. Чтобы удостовериться, давайте проверим:</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ docker network inspect bridge</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">[</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">    {</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">        </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;Name&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">: </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;bridge&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">,</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">        </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;Id&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">: </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;8022115322ec80613421b0282e7ee158ec41e16f565a3e86fa53496105deb2d7&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">,</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">        </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;Scope&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">: </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;local&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">,</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">        </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;Driver&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">: </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;bridge&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">,</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">        </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;IPAM&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">: {</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">            </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;Driver&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">: </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;default&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">,</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">            </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;Config&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">: [</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">                {</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">                    </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;Subnet&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">: </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;172.17.0.0/16&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">                }</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">            ]</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">        },</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">        </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;Containers&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">: {</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">            </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;e931ab24dedc1640cddf6286d08f115a83897c88223058305460d7bd793c1947&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">: {</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">                </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;EndpointID&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">: </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;66965e83bf7171daeb8652b39590b1f8c23d066ded16522daeb0128c9c25c189&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">,</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">                </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;MacAddress&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">: </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;02:42:ac:11:00:02&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">,</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">                </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;IPv4Address&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">: </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;172.17.0.2/16&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">,</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">                </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;IPv6Address&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">: </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">            }</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">        },</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">        </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;Options&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">: {</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">            </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;com.docker.network.bridge.default_bridge&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">: </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;true&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">,</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">            </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;com.docker.network.bridge.enable_icc&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">: </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;true&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">,</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">            </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;com.docker.network.bridge.enable_ip_masquerade&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">: </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;true&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">,</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">            </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;com.docker.network.bridge.host_binding_ipv4&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">: </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;0.0.0.0&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">,</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">            </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;com.docker.network.bridge.name&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">: </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;docker0&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">,</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">            </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;com.docker.network.driver.mtu&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">: </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;1500&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">        }</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">    }</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">]</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Видно, что контейнер </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">e931ab24dedc</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> находится в секции </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">Containers</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">. Также виден IP-адрес, выданный этому контейнеру — </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">172.17.0.2</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">. Именно этот адрес мы и искали? Давайте проверим: запустим Flask-приложение и попробуем обратиться к нему по IP:</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ docker run -it --rm prakhar1989/foodtrucks-web bash</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">root@35180ccc206a:/opt/flask-app</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-style:italic; color:#999988; background-color:#f8f8f8;"># curl 172.17.0.2:9200</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">bash: curl: </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#0086b3; background-color:#f8f8f8;">command</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> not found</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">root@35180ccc206a:/opt/flask-app</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-style:italic; color:#999988; background-color:#f8f8f8;"># apt-get -yqq install curl</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">root@35180ccc206a:/opt/flask-app</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-style:italic; color:#999988; background-color:#f8f8f8;"># curl 172.17.0.2:9200</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">{</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">  </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;name&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> : </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;Jane Foster&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">,</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">  </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;cluster_name&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> : </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;elasticsearch&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">,</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">  </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;version&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> : {</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">    </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;number&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> : </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;2.1.1&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">,</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">    </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;build_hash&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> : </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;40e2c53a6b6c2972b3d13846e450e66f4375bd71&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">,</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">    </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;build_timestamp&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> : </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;2015-12-15T13:05:55Z&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">,</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">    </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;build_snapshot&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> : </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#008080; background-color:#f8f8f8;">false</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">,</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">    </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;lucene_version&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> : </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;5.3.1&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">  },</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">  </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;tagline&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> : </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;You Know, for Search&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">}</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">root@35180ccc206a:/opt/flask-app</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-style:italic; color:#999988; background-color:#f8f8f8;"># exit</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; font-style:italic; color:#999988; background-color:#ffffff;"></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; font-style:italic; color:#999988; background-color:#ffffff;"></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Сейчас все должно быть понятно. Мы запустили контейнер в интерактивном режиме с процессом</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">bash</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">. Флаг</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">--rm</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> нужен для удобства, благодаря нему контейнер автоматически удаляется после выхода. Мы попробуем</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">curl</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">, но нужно сначала установить его. После этого можно удостовериться, что по адресу </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">172.17.0.2:9200</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">на самом деле можно обращаться к ES! Супер!</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Не смотря на то, что мы нашли способ наладить связь между контейнерами, существует несколько проблем с этим подходом:</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Придется добавлять записи в файл <span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">/etc/hosts</span> внутри Flask-контейнера, чтобы приложение понимало, что имя хоста <span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">es</span> означает <span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">172.17.0.2</span>. Если IP-адрес меняется, то придется вручную менять запись.</li>
<li style=" font-family:'Verdana,sans-serif'; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Так как сеть <span style=" font-style:italic;">bridge</span> используется всеми контейнерами по умолчанию, этот метод <span style=" font-weight:696;">не безопасен</span>.</li></ol>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Но есть хорошие новости: в Докере есть отличное решение этой проблемы. Докер позволяет создавать собственные изолированные сети. Это решение также помогает справиться с проблемой</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">/etc/hosts</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">, сейчас увидим как.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Во-первых, давайте создадим свою сеть:</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ docker network create foodtrucks</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">1a3386375797001999732cb4c4e97b88172d983b08</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#0086b3; background-color:#f8f8f8;">cd</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">0addfcb161eed0c18d89</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ docker network ls</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">NETWORK ID          NAME                DRIVER</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">1a3386375797        foodtrucks          bridge</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">8022115322ec        bridge              bridge</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">075b9f628ccc        none                null</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">be0f7178486c        host                host</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Команда </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">network create</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> создает новую сеть </span><span style=" font-family:'Verdana,sans-serif'; font-style:italic; color:#000000;">bridge</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">. Нам сейчас нужен именно такой тип. Существуют другие типы сетей, и вы можете почитать о них в </span><a href="https://docs.docker.com/engine/userguide/networking/dockernetworks/"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">официальной документации</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;">.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Теперь у нас есть сеть. Можно запустить наши контейнеры внутри сети с помощью флага</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">--net</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">. Давайте так и сделаем, но сначала остановим контейнер с ElasticSearch, который был запущен в сети bridge по умолчанию.</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ docker ps</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                              NAMES</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">e931ab24dedc        elasticsearch       </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;/docker-entrypoint.s&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">   4 hours ago         Up 4 hours          0.0.0.0:9200-&gt;9200/tcp, 9300/tcp   cocky_spence</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ docker stop e931ab24dedc</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">e931ab24dedc</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ docker run -dp 9200:9200 --net foodtrucks --name es elasticsearch</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">2c0b96f9b8030f038e40abea44c2d17b0a8edda1354a08166c33e6d351d0c651</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ docker network inspect foodtrucks</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">[</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">    {</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">        </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;Name&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">: </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;foodtrucks&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">,</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">        </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;Id&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">: </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;1a3386375797001999732cb4c4e97b88172d983b08cd0addfcb161eed0c18d89&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">,</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">        </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;Scope&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">: </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;local&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">,</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">        </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;Driver&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">: </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;bridge&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">,</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">        </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;IPAM&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">: {</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">            </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;Driver&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">: </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;default&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">,</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">            </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;Config&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">: [</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">                {}</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">            ]</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">        },</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">        </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;Containers&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">: {</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">            </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;2c0b96f9b8030f038e40abea44c2d17b0a8edda1354a08166c33e6d351d0c651&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">: {</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">                </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;EndpointID&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">: </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;15eabc7989ef78952fb577d0013243dae5199e8f5c55f1661606077d5b78e72a&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">,</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">                </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;MacAddress&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">: </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;02:42:ac:12:00:02&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">,</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">                </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;IPv4Address&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">: </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;172.18.0.2/16&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">,</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">                </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;IPv6Address&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">: </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">            }</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">        },</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">        </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;Options&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">: {}</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">    }</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">]</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Мы сделали то же, что и раньше, но на этот раз дали контейнеру название</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">es</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">. Перед тем, как запускать контейнер с приложением, давайте проверим что происходит, когда запуск происходит в сети.</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ docker run -it --rm --net foodtrucks prakhar1989/foodtrucks-web bash</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">root@53af252b771a:/opt/flask-app</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-style:italic; color:#999988; background-color:#f8f8f8;"># cat /etc/hosts</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">172.18.0.3  53af252b771a</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">127.0.0.1   localhost</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">::1 localhost ip6-localhost ip6-loopback</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">fe00::0 ip6-localnet</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">ff00::0 ip6-mcastprefix</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">ff02::1 ip6-allnodes</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">ff02::2 ip6-allrouters</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">172.18.0.2  es</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">172.18.0.2  es.foodtrucks</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">root@53af252b771a:/opt/flask-app</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-style:italic; color:#999988; background-color:#f8f8f8;"># curl es:9200</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">bash: curl: </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#0086b3; background-color:#f8f8f8;">command</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> not found</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">root@53af252b771a:/opt/flask-app</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-style:italic; color:#999988; background-color:#f8f8f8;"># apt-get -yqq install curl</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">root@53af252b771a:/opt/flask-app</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-style:italic; color:#999988; background-color:#f8f8f8;"># curl es:9200</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">{</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">  </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;name&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> : </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;Doctor Leery&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">,</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">  </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;cluster_name&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> : </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;elasticsearch&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">,</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">  </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;version&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> : {</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">    </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;number&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> : </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;2.1.1&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">,</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">    </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;build_hash&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> : </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;40e2c53a6b6c2972b3d13846e450e66f4375bd71&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">,</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">    </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;build_timestamp&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> : </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;2015-12-15T13:05:55Z&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">,</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">    </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;build_snapshot&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> : </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#008080; background-color:#f8f8f8;">false</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">,</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">    </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;lucene_version&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> : </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;5.3.1&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">  },</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">  </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;tagline&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> : </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;You Know, for Search&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">}</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">root@53af252b771a:/opt/flask-app</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-style:italic; color:#999988; background-color:#f8f8f8;"># ls</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">app.py  node_modules  package.json  requirements.txt  static  templates  webpack.config.js</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">root@53af252b771a:/opt/flask-app</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-style:italic; color:#999988; background-color:#f8f8f8;"># python app.py</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">Index not found...</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">Loading data </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-weight:696; color:#333333; background-color:#f8f8f8;">in</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> elasticsearch ...</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">Total trucks loaded:  733</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> * Running on http://0.0.0.0:5000/ (Press CTRL+C to quit)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">root@53af252b771a:/opt/flask-app</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-style:italic; color:#999988; background-color:#f8f8f8;"># exit</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; font-style:italic; color:#999988; background-color:#ffffff;"></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; font-style:italic; color:#999988; background-color:#ffffff;"></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Ура! Работает! Магическим образом Докер внес нужные правки в файл</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">/etc/hosts</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">, и поэтому </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">es:9200</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">можно использовать в приложении — этот адрес корректно направляет запросы в контейнер ES. Отлично! Давайте теперь запустим Flask-контейнер по-настоящему:</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ docker run -d --net foodtrucks -p 5000:5000 --name foodtrucks-web prakhar1989/foodtrucks-web</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">2a1b77e066e646686f669bab4759ec1611db359362a031667cacbe45c3ddb413</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ docker ps</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">CONTAINER ID        IMAGE                        COMMAND                  CREATED             STATUS              PORTS                              NAMES</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">2a1b77e066e6        prakhar1989/foodtrucks-web   </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;python ./app.py&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">        2 seconds ago       Up 1 seconds        0.0.0.0:5000-&gt;5000/tcp             foodtrucks-web</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">2c0b96f9b803        elasticsearch                </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;/docker-entrypoint.s&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">   21 minutes ago      Up 21 minutes       0.0.0.0:9200-&gt;9200/tcp, 9300/tcp   es</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ curl -I 0.0.0.0:5000</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">HTTP/1.0 200 OK</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">Content-Type: text/html; charset=utf-8</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">Content-Length: 3697</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">Server: Werkzeug/0.11.2 Python/2.7.6</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">Date: Sun, 10 Jan 2016 23:58:53 GMT</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Зайдите на </span><a href="http://0.0.0.0:5000/"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">http://0.0.0.0:5000</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;">, и увидите приложение в работе. Опять же, может показаться, что было много работы, но на самом деле мы ввели всего 4 команды чтобы с нуля дойти до работающего приложения. Я собрал эти команды в </span><a href="https://github.com/prakhar1989/FoodTrucks/blob/master/setup-docker.sh"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">bash-скрипт</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;">.</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-weight:696; color:#999999; background-color:#f8f8f8;">#!/bin/bash</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; font-weight:696; color:#999999; background-color:#ffffff;"></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-style:italic; color:#999988; background-color:#f8f8f8;"># build the flask container</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">docker build -t prakhar1989/foodtrucks-web .</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-style:italic; color:#999988; background-color:#f8f8f8;"># create the network</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">docker network create foodtrucks</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-style:italic; color:#999988; background-color:#f8f8f8;"># start the ES container</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">docker run -d --net foodtrucks -p 9200:9200 -p 9300:9300 --name es elasticsearch</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-style:italic; color:#999988; background-color:#f8f8f8;"># start the flask app container</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">docker run -d --net foodtrucks -p 5000:5000 --name foodtrucks-web prakhar1989/foodtrucks-web</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Теперь представьте, что хотите поделиться приложением с другом. Или хотите запустить на сервере, где установлен Докер. Можно запустить всю систему с помощью одной команды!</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ git </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#0086b3; background-color:#f8f8f8;">clone</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> https://github.com/prakhar1989/FoodTrucks</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#0086b3; background-color:#f8f8f8;">cd</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> FoodTrucks</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ ./setup-docker.sh</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Вот и все! По-моему, это невероятно крутой и мощный способ распространять и запускать приложения!</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; font-size:small; color:#000000; background-color:#ffffff;">Docker Links</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Перед тем, как завершить этот раздел, стоит отметить, что </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">docker network</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> это относительно новая фича, она входит в </span><a href="https://blog.docker.com/2015/11/docker-1-9-production-ready-swarm-multi-host-networking/"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">релиз</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> Docker 1.9 .</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">До того, как появился</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">network</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">, ссылки были допустимым способом настройки взаимодействия между контейнерами. В соответствии с официальной </span><a href="https://docs.docker.com/engine/userguide/networking/default_network/dockerlinks/"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">документацией</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;">, linking вскоре будет переведены в статус deprecated. Если вам попадется туториал или статья, где используется </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">link</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> для соединения контейнеров, то просто не забывайте использовать вместо этого </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">network</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> (на момент публикации перевода links является legacy, — прим. пер.)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a name="compose"></a><span style=" font-family:'Verdana,sans-serif'; font-size:large; color:#000000; background-color:#ffffff;">3</span><span style=" font-family:'Verdana,sans-serif'; font-size:large; color:#000000; background-color:#ffffff;">.3 Docker Compose</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">До этого момента мы изучали клиент Докера. Но в экосистеме Докера есть несколько других инструментов с открытым исходным кодом, которые хорошо взаимодействуют с Докером. Некоторые из них это:</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://docs.docker.com/machine/"><span style=" color:#990099;">Docker Machine</span></a> позволяет создавать Докер-хосты на своем компьютере, облачном провайдере или внутри дата-центра.</li>
<li style=" font-family:'Verdana,sans-serif'; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://docs.docker.com/compose/"><span style=" color:#990099;">Docker Compose</span></a> — инструмент для определения и запуска много-контейнерных приложений.</li>
<li style=" font-family:'Verdana,sans-serif'; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://docs.docker.com/swarm/"><span style=" color:#990099;">Docker Swarm</span></a> — нативное решение для кластеризации.</li></ol>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">В этом разделе мы поговорим об одном из этих инструментов — Docker Compose, и узнаем, как он может упростить работу с несколькими контейнерами.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">У Docker Compose довольно интересная предыстория. Примерно два года назад компания OrchardUp запустила инструмент под названием Fig. Идея была в том, чтобы создавать изолированные рабочие окружения с помощью Докера. Проект очень хорошо восприняли на</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> </span><a href="https://news.ycombinator.com/item?id=7132044"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">Hacker News</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> - я смутно помню, что читал о нем, но не особо понял его смысла.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a href="https://news.ycombinator.com/item?id=7133449"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">Первый комментарий</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> на самом деле неплохо объясняет, зачем нужен Fig и что он делает:</span></p>
<p style=" margin-top:14px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;">На самом деле, смысл Докера в следующем: запускать процессы. Сегодня у Докера есть неплохое API для запуска процессов: расшаренные между контейнерами (иными словами, запущенными образами) разделы или директории (shared volumes), перенаправление портов с хост-машины в контейнер, вывод логов, и так далее. Но больше ничего: Докер сейчас работает только на уровне процессов.<br />Не смотря на то, что в нем содержатся некоторые возможности оркестрации нескольких контейнеров для создания единого &quot;приложения&quot;, в Докере нет ничего, что помогало бы с управлением такими группами контейнеров как одной сущностью. И вот зачем нужен инструмент вроде Fig: чтобы обращаться с группой контейнеров как с единой сущностью. Чтобы думать о &quot;запуске приложений&quot; (иными словами, &quot;запуске оркестрированного кластера контейнеров&quot;) вместо &quot;запуска контейнеров&quot;.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;"><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Оказалось, что многие пользователи Докера согласны с такими мыслями. Постепенно, Fig набрал популярность, Docker Inc. заметили, купили компанию и назвали проект Docker Compose.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Итак, зачем используется</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> </span><span style=" font-family:'Verdana,sans-serif'; font-style:italic; color:#000000;">Compose</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">? Это инструмент для простого определения и запуска многоконтейнерных Докер-приложений. В нем есть файл </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">docker-compose.yml</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">, и с его помощью можно одной командой поднять приложение с набором сервисов.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Давайте посмотрим, сможем ли мы создать файл </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">docker-compose.yml</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> для нашего приложения SF-Foodtrucks и проверим, способен ли он на то, что обещает.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Но вначале нужно установить Docker Compose. Есть у вас Windows или Mac, то Docker Compose уже установлен — он идет в комплекте с Docker Toolbox. На Linux можно установить Docker Compose следуя </span><a href="https://docs.docker.com/compose/install/"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">простым инструкциям</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> на сайте документации. Compose написан на Python, поэтому можно сделать просто </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">pip install docker-compose</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">. Проверить работоспособность так:</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ docker-compose version</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">docker-compose version 1.7.1, build 0a9ab35</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">docker-py version: 1.8.1</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">CPython version: 2.7.9</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">OpenSSL version: OpenSSL 1.0.1j 15 Oct 2014</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Теперь можно перейти к следующему шагу, то есть созданию файла </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">docker-compose.yml</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">. Синтаксис </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">yml</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">-файлов очень простой, и в репозитории уже есть </span><a href="https://github.com/prakhar1989/FoodTrucks/blob/master/docker-compose.yml"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">пример</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;">, который мы будем использовать</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">version: </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;2&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">services:</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">  es:</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">    image: elasticsearch</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">  web:</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">    image: prakhar1989/foodtrucks-web</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">    </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#0086b3; background-color:#f8f8f8;">command</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">: python app.py</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">    ports:</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">      - </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;5000:5000&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">    volumes:</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">      - .:/code</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">      </span></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Давайте я разберу это подробнее. На родительском уровне мы задали название неймспейса для наших сервисов:</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">es</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> и </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">web</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">. К каждому сервису можно добавить дополнительные параметры, среди которых </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">image</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> — обязательный. Для </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">es</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> мы указываем доступный на Docker Hub образ </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">elasticsearch</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">. Для Flask-приложения — тот образ, который мы создали самостоятельно в начале этого раздела.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">С помощью других параметров вроде</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">command</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> и </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">ports</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> можно предоставить информацию о контейнере.</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">volumes</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> отвечает за локацию монтирования, где будет находиться код в контейнере </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">web</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">. Это опциональный параметр, он полезен, если нужно обращаться к логам и так далее. Подробнее о параметрах и возможных значениях можно </span><a href="https://docs.docker.com/compose/compose-file"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">прочитать в документации</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;">.</span></p>
<p style=" margin-top:14px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;">Замечание: Нужно находиться в директории с файлом </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">docker-compose.yml</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> чтобы запускать большую часть команд Compose.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;"><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Отлично! Файл готов, давайте посмотрим на </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">docker-compose</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> в действии. Но вначале нужно удостовериться, что порты свободны. Так что если у вас запущены контейнеры Flask и ES, то пора их остановить:</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ docker stop $(docker ps -q)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">39a2f5df14ef</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">2a1b77e066e6</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Теперь можно запускать </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">docker-compose</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">. Перейдите в директорию с приложением Foodtrucks и выполните команду </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">docker-compose up</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">.</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ docker-compose up</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">Creating network </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;foodtrucks_default&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> with the default driver</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">Creating foodtrucks_es_1</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">Creating foodtrucks_web_1</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">Attaching to foodtrucks_es_1, foodtrucks_web_1</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">es_1  | [2016-01-11 03:43:50,300][INFO ][node                     ] [Comet] version[2.1.1], pid[1], build[40e2c53/2015-12-15T13:05:55Z]</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">es_1  | [2016-01-11 03:43:50,307][INFO ][node                     ] [Comet] initializing ...</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">es_1  | [2016-01-11 03:43:50,366][INFO ][plugins                  ] [Comet] loaded [], sites []</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">es_1  | [2016-01-11 03:43:50,421][INFO ][env                      ] [Comet] using [1] data paths, mounts [[/usr/share/elasticsearch/data (/dev/sda1)]], net usable_space [16gb], net total_space [18.1gb], spins? [possibly], types [ext4]</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">es_1  | [2016-01-11 03:43:52,626][INFO ][node                     ] [Comet] initialized</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">es_1  | [2016-01-11 03:43:52,632][INFO ][node                     ] [Comet] starting ...</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">es_1  | [2016-01-11 03:43:52,703][WARN ][common.network           ] [Comet] publish address: {0.0.0.0} is a wildcard address, falling back to first non-loopback: {172.17.0.2}</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">es_1  | [2016-01-11 03:43:52,704][INFO ][transport                ] [Comet] publish_address {172.17.0.2:9300}, bound_addresses {[::]:9300}</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">es_1  | [2016-01-11 03:43:52,721][INFO ][discovery                ] [Comet] elasticsearch/cEk4s7pdQ-evRc9MqS2wqw</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">es_1  | [2016-01-11 03:43:55,785][INFO ][cluster.service          ] [Comet] new_master {Comet}{cEk4s7pdQ-evRc9MqS2wqw}{172.17.0.2}{172.17.0.2:9300}, reason: zen-disco-join(elected_as_master, [0] joins received)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">es_1  | [2016-01-11 03:43:55,818][WARN ][common.network           ] [Comet] publish address: {0.0.0.0} is a wildcard address, falling back to first non-loopback: {172.17.0.2}</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">es_1  | [2016-01-11 03:43:55,819][INFO ][http                     ] [Comet] publish_address {172.17.0.2:9200}, bound_addresses {[::]:9200}</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">es_1  | [2016-01-11 03:43:55,819][INFO ][node                     ] [Comet] started</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">es_1  | [2016-01-11 03:43:55,826][INFO ][gateway                  ] [Comet] recovered [0] indices into cluster_state</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">es_1  | [2016-01-11 03:44:01,825][INFO ][cluster.metadata         ] [Comet] [sfdata] creating index, cause [auto(index api)], templates [], shards [5]/[1], mappings [truck]</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">es_1  | [2016-01-11 03:44:02,373][INFO ][cluster.metadata         ] [Comet] [sfdata] update_mapping [truck]</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">es_1  | [2016-01-11 03:44:02,510][INFO ][cluster.metadata         ] [Comet] [sfdata] update_mapping [truck]</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">es_1  | [2016-01-11 03:44:02,593][INFO ][cluster.metadata         ] [Comet] [sfdata] update_mapping [truck]</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">es_1  | [2016-01-11 03:44:02,708][INFO ][cluster.metadata         ] [Comet] [sfdata] update_mapping [truck]</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">es_1  | [2016-01-11 03:44:03,047][INFO ][cluster.metadata         ] [Comet] [sfdata] update_mapping [truck]</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">web_1 |  * Running on http://0.0.0.0:5000/ (Press CTRL+C to quit)</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Перейдите по IP чтобы увидеть приложение. Круто, да? Всего лишь пара строк конфигурации и несколько Докер-контейнеров работают в унисон. Давайте остановим сервисы и перезапустим в detached mode:</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">web_1 |  * Running on http://0.0.0.0:5000/ (Press CTRL+C to quit)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">Killing foodtrucks_web_1 ... </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-weight:696; color:#333333; background-color:#f8f8f8;">done</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">Killing foodtrucks_es_1 ... </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-weight:696; color:#333333; background-color:#f8f8f8;">done</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; font-weight:696; color:#333333; background-color:#ffffff;"></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ docker-compose up -d</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">Starting foodtrucks_es_1</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">Starting foodtrucks_web_1</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ docker-compose ps</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">      Name                    Command               State           Ports</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">----------------------------------------------------------------------------------</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">foodtrucks_es_1    /docker-entrypoint.sh elas ...   Up      9200/tcp, 9300/tcp</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">foodtrucks_web_1   python app.py                    Up      0.0.0.0:5000-&gt;5000/tcp</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Не удивительно, но оба контейнера успешно запущены. Откуда берутся имена? Их Compose придумал сам. Но что насчет сети? Его Compose тоже делаем сам? Хороший вопрос, давайте выясним.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Для начала, остановим запущенные сервисы. Их всегда можно вернуть одной командой:</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ docker-compose stop</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">Stopping foodtrucks_web_1 ... </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-weight:696; color:#333333; background-color:#f8f8f8;">done</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">Stopping foodtrucks_es_1 ... </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-weight:696; color:#333333; background-color:#f8f8f8;">done</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; font-weight:696; color:#333333; background-color:#ffffff;"></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; font-weight:696; color:#333333; background-color:#ffffff;"></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Заодно, давайте удалим сеть </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">foodtrucks</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">, которую создали в прошлый раз. Эта сеть нам не потребуется, потому что </span><span style=" font-family:'Verdana,sans-serif'; font-style:italic; color:#000000;">Compose</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> автоматически сделает все за нас.</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ docker network rm foodtrucks</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ docker network ls</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">NETWORK ID          NAME                DRIVER</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">4eec273c054e        bridge              bridge</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">9347ae8783bd        none                null</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">54df57d7f493        host                host</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Класс! Теперь в этом чистом состоянии можно проверить, способен ли </span><span style=" font-family:'Verdana,sans-serif'; font-style:italic; color:#000000;">Compose</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> на волшебство.</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ docker-compose up -d</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">Recreating foodtrucks_es_1</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">Recreating foodtrucks_web_1</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ docker ps</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">CONTAINER ID        IMAGE                        COMMAND                  CREATED             STATUS              PORTS                    NAMES</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">f50bb33a3242        prakhar1989/foodtrucks-web   </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;python app.py&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">          14 seconds ago      Up 13 seconds       0.0.0.0:5000-&gt;5000/tcp   foodtrucks_web_1</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">e299ceeb4caa        elasticsearch                </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;/docker-entrypoint.s&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">   14 seconds ago      Up 14 seconds       9200/tcp, 9300/tcp       foodtrucks_es_1</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Пока все хорошо. Проверим, создались ли какие-нибудь сети:</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ docker network ls</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">NETWORK ID          NAME                 DRIVER</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">0c8b474a9241        bridge               bridge              </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">293a141faac3        foodtrucks_default   bridge              </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">b44db703</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#0086b3; background-color:#f8f8f8;">cd</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">69        host                 host                </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">0474c9517805        none                 null  </span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Видно, что Compose самостоятельно создал сеть </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">foodtrucks_default</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> и подсоединил оба сервиса в эту сеть, так, чтобы они могли общаться друг с другом. Каждый контейнер для сервиса подключен к сети, и оба контейнера доступны другим контейнерам в сети. Они доступны по hostname, который совпадает с названием контейнера. Давайте проверим, находится ли эта информация в </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">/etc/hosts</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">.</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ docker ps</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">CONTAINER ID        IMAGE                        COMMAND                  CREATED             STATUS              PORTS                    NAMES</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">bb72dcebd379        prakhar1989/foodtrucks-web   </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;python app.py&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">          20 hours ago        Up 19 hours         0.0.0.0:5000-&gt;5000/tcp   foodtrucks_web_1</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">3338</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#0086b3; background-color:#f8f8f8;">fc</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">79be4b        elasticsearch                </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;/docker-entrypoint.s&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">   20 hours ago        Up 19 hours         9200/tcp, 9300/tcp       foodtrucks_es_1</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ docker </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#0086b3; background-color:#f8f8f8;">exec</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> -it bb72dcebd379 bash</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">root@bb72dcebd379:/opt/flask-app</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-style:italic; color:#999988; background-color:#f8f8f8;"># cat /etc/hosts</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">127.0.0.1   localhost</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">::1 localhost ip6-localhost ip6-loopback</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">fe00::0 ip6-localnet</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">ff00::0 ip6-mcastprefix</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">ff02::1 ip6-allnodes</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">ff02::2 ip6-allrouters</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">172.18.0.2  bb72dcebd379</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Упс! Оказывается, файл понятия не имеет о</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">es</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">. Как же наше приложение работает? Давайте попингуем его по названию хоста:</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">root@bb72dcebd379:/opt/flask-app</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-style:italic; color:#999988; background-color:#f8f8f8;"># ping es</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">PING es (172.18.0.3) 56(84) bytes of data.</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">64 bytes from foodtrucks_es_1.foodtrucks_default (172.18.0.3): icmp_seq=1 ttl=64 time=0.049 ms</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">64 bytes from foodtrucks_es_1.foodtrucks_default (172.18.0.3): icmp_seq=2 ttl=64 time=0.064 ms</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">^C</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">--- es ping statistics ---</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">2 packets transmitted, 2 received, 0% packet loss, time 999ms</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">rtt min/avg/max/mdev = 0.049/0.056/0.064/0.010 ms</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Вуаля! Работает! Каким-то магическим образом контейнер смог сделать пинг хоста</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">es</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">. Оказывается, Docker 1.10 добавили новую сетевую систему, которая производит обнаружение сервисов через DNS-сервер. Если интересно, то почитайте подробнее о </span><a href="https://github.com/docker/libnetwork/issues/767"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">предложении</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> и </span><a href="https://blog.docker.com/2016/02/docker-1-10/"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">release notes</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;">.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">На этом наш тур по Docker Compose завершен. С этим инструментом можно ставить сервисы на паузу, запускать отдельные команды в контейнере и даже масштабировать систему, то есть увеличивать количество контейнеров. Также советую изучать некоторые другие</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> </span><a href="https://docs.docker.com/compose/overview/#common-use-cases"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">примеры</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> использования Docker Compose.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Надеюсь, я продемонстрировал как на самом деле просто управлять многоконтейнерной средой с Compose. В последнем разделе мы задеплоим все на AWS!</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a name="awsecs"></a><span style=" font-family:'Verdana,sans-serif'; font-size:large; color:#000000; background-color:#ffffff;">3</span><span style=" font-family:'Verdana,sans-serif'; font-size:large; color:#000000; background-color:#ffffff;">.4 AWS Elastic Container Service</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">В прошлом разделе мы использовали </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">docker-compose</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> чтобы запустить наше приложение локально одной командой: </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">docker-compose up</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">. Теперь, когда приложение работает, мы хотим показать его миру, заполучить юзеров, поднять кучу денег и купить большой дом в Майами. Последние три шага выходят за пределы этого пособия, так что займемся выяснением деталей о деплое многоконтейнерного приложения в облако AWS.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Если вы дочитали до этого места, то скорее всего убедились, что Docker — довольно крутая технология. И вы не одиноки. Облачные провайдеры заметили взрывной рост популярности Докера и стали добавлять поддержку в свои сервисы. Сегодня, Докер-приложения можно деплоить на AWS, </span><a href="https://azure.microsoft.com/en-us/documentation/articles/virtual-machines-docker-vm-extension/"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">Azure</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;">,</span><a href="http://blog.rackspace.com/docker-with-the-rackspace-open-cloud/"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">Rackspace</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;">, </span><a href="https://www.digitalocean.com/community/tutorials/how-to-use-the-digitalocean-docker-application"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">DigitalOcean</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> и много других. Мы уже умеем деплоить приложение с одним контейнером на Elastic Beanstalk, а в этом разделе мы изучим AWS </span><a href="https://aws.amazon.com/ecs/"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">Elastic Container Service (или ECS)</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;">.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">AWS ECS — это масштабируемый и гибкий сервис по управлению контейнерами, и он поддерживает Докер. С его помощью можно управлять кластером на EC2 через простой API. В Beanstalk были нормальные настройки по умолчанию, но ECS позволяет настроить каждый аспект окружения по вашим потребностям. По этой причине ECS — не самый простой инструмент в начале пути.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">К счастью, у ECS есть удобный </span><a href="http://docs.aws.amazon.com/AmazonECS/latest/developerguide/ECS_CLI.html"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">инструмент командной строки (CLI)</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> с поддержкой Docker Compose и автоматической провизией на ECS! Так как у нас уже есть рабочий файл </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">docker-compose.yml</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">, настройка и запуск на AWS должна быть достаточно легкой. Начнем!</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Вначале нужно установить CLI. На момент написания этого пособия CLI-утилита не доступна на Windows. Инструкции по установке CLI на Mac и Linux хорошо описаны на сайте с</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> </span><a href="http://docs.aws.amazon.com/AmazonECS/latest/developerguide/ECS_CLI_installation.html"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">официальной документацией</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;">. Установите утилиту, а потом проверьте ее работоспособность так:</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ ecs-cli --version</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">ecs-cli version 0.1.0 (*cbdc2d5)</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Первый шаг — задать пару ключей для авторизации на инстансах. Зайдите на страницу </span><a href="https://console.aws.amazon.com/ec2/v2/home?region=us-east-1#KeyPairs:sort=keyName"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">EC2 Console</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> и создайте новый keypair. Скачайте файл и держите его в безопасном месте. Еще один момент — имя региона. Я назвал свой ключ </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">ecs</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> и указал регион </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">us-east-1</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">. Я продолжу повествование с этим допущением.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><img src="image3930.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Теперь настройте CLI:</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ ecs-cli configure --region us-east-1 --cluster foodtrucks</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">INFO[0000] Saved ECS CLI configuration </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-weight:696; color:#333333; background-color:#f8f8f8;">for</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> cluster (foodtrucks)</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Команда </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">configure</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> с именем региона, в котором хотим разместить наш кластер, и название кластера. Нужно указать </span><span style=" font-family:'Verdana,sans-serif'; font-weight:696; color:#000000;">тот же регион</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">, что использовался прри создании ключей. Если у вас не настроен </span><a href="https://aws.amazon.com/cli/"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">AWS CLI</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;">, то следуйте </span><a href="http://docs.aws.amazon.com/cli/latest/userguide/cli-chap-getting-set-up.html"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">руководству</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;">, которое подробно описывает все шаги.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Следующий шаг позволяет утилите создавать шаблон </span><a href="https://aws.amazon.com/cloudformation/"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">CloudFormation</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;">.</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ ecs-cli up --keypair ecs --capability-iam --size 2 --instance-type t2.micro</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">INFO[0000] Created cluster                               cluster=foodtrucks</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">INFO[0001] Waiting </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-weight:696; color:#333333; background-color:#f8f8f8;">for</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;"> your cluster resources to be created</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">INFO[0001] Cloudformation stack status                   stackStatus=CREATE_IN_PROGRESS</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">INFO[0061] Cloudformation stack status                   stackStatus=CREATE_IN_PROGRESS</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">INFO[0122] Cloudformation stack status                   stackStatus=CREATE_IN_PROGRESS</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">INFO[0182] Cloudformation stack status                   stackStatus=CREATE_IN_PROGRESS</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">INFO[0242] Cloudformation stack status                   stackStatus=CREATE_IN_PROGRESS</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Здесь мы указываем названия ключей, которые мы скачали (в моем случае</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">ecs</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">), количество инстансов (</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">--size</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">) и тип инстансов, на которых хотим запускать контейнеры. Флаг </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">--capability-iam</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> говорит утилите, что мы понимаем, что эта команда может создать ресурсы IAM.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">В последнем шаге мы используем файл</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">docker-compose.yml</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">. Требуется небольшое изменение, так что вместо модификации файла, давайте сделаем копию и назовем ее </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">aws-compose.yml</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">. Содержание </span><a href="https://github.com/prakhar1989/FoodTrucks/blob/master/aws-compose.yml"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">этого файла</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> (после изменений):</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">es:</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">  image: elasticsearch</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">  cpu_shares: 100</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">  mem_</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#0086b3; background-color:#f8f8f8;">limit</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">: 262144000</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">web:</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">  image: prakhar1989/foodtrucks-web</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">  cpu_shares: 100</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">  mem_</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#0086b3; background-color:#f8f8f8;">limit</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">: 262144000</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">  ports:</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">    - </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#dd1144; background-color:#f8f8f8;">&quot;80:5000&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">  links:</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">    - es</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">    </span></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Единственные отличия от оригинального файла </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">docker-compose.yml</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> это параметры </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">mem_limit</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> и</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">cpu_shares</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> для каждого контейнера.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Также, мы убрали</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">version</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> и </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">services</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">, так как AWS еще не поддерживает </span><a href="https://docs.docker.com/compose/compose-file/#version-2"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">версию 2</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> файлового формата Compose. Так как наше приложение будет работать на инстансах типа </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">t2.micro</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">, мы задали 250 мегабайт памяти. Теперь нам нужно опубликовать образ на Docker Hub. На момент написания этого пособия, ecs-cli </span><span style=" font-family:'Verdana,sans-serif'; font-weight:696; color:#000000;">не поддерживает</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> команду </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">build</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">. Но Docker Compose </span><a href="https://docs.docker.com/compose/compose-file/#build"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">поддерживает</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> ее без проблем.</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ docker push prakhar1989/foodtrucks-web</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Красота! Давайте запустим финальную команду, которая произведет деплой на ECS!</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">$ ecs-cli compose --file aws-compose.yml up</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">INFO[0000] Using ECS task definition                     TaskDefinition=ecscompose-foodtrucks:2</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">INFO[0000] Starting container...                         container=845e2368-170d-44a7-bf9f-84c7fcd9ae29/es</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">INFO[0000] Starting container...                         container=845e2368-170d-44a7-bf9f-84c7fcd9ae29/web</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">INFO[0000] Describe ECS container status                 container=845e2368-170d-44a7-bf9f-84c7fcd9ae29/web desiredStatus=RUNNING lastStatus=PENDING taskDefinition=ecscompose-foodtrucks:2</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">INFO[0000] Describe ECS container status                 container=845e2368-170d-44a7-bf9f-84c7fcd9ae29/es desiredStatus=RUNNING lastStatus=PENDING taskDefinition=ecscompose-foodtrucks:2</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">INFO[0036] Describe ECS container status                 container=845e2368-170d-44a7-bf9f-84c7fcd9ae29/es desiredStatus=RUNNING lastStatus=PENDING taskDefinition=ecscompose-foodtrucks:2</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">INFO[0048] Describe ECS container status                 container=845e2368-170d-44a7-bf9f-84c7fcd9ae29/web desiredStatus=RUNNING lastStatus=PENDING taskDefinition=ecscompose-foodtrucks:2</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">INFO[0048] Describe ECS container status                 container=845e2368-170d-44a7-bf9f-84c7fcd9ae29/es desiredStatus=RUNNING lastStatus=PENDING taskDefinition=ecscompose-foodtrucks:2</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">INFO[0060] Started container...                          container=845e2368-170d-44a7-bf9f-84c7fcd9ae29/web desiredStatus=RUNNING lastStatus=RUNNING taskDefinition=ecscompose-foodtrucks:2</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">INFO[0060] Started container...                          container=845e2368-170d-44a7-bf9f-84c7fcd9ae29/es desiredStatus=RUNNING lastStatus=RUNNING taskDefinition=ecscompose-foodtrucks:2</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">То, что вывод похож на вывод</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> </span><span style=" font-family:'Verdana,sans-serif'; font-weight:696; color:#000000;">Docker Compose</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> — не совпадени. Аргумент </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">--file</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> используется для переопределения файла по умолчанию (</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">docker-compose.yml</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">). Если все прошло хорошо, то вы увидите строку </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#222222;">desiredStatus=RUNNING lastStatus=RUNNING</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> в самом конце.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Круто! Теперь приложение запущено. Как к нему обратиться?</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">ecs-cli ps</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">Name                                      State    Ports                     TaskDefinition</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">845e2368-170d-44a7-bf9f-84c7fcd9ae29/web  RUNNING  54.86.14.14:80-&gt;5000/tcp  ecscompose-foodtrucks:2</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#f8f8f8;">845e2368-170d-44a7-bf9f-84c7fcd9ae29/es   RUNNING                            ecscompose-foodtrucks:2</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; color:#333333; background-color:#ffffff;"></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Откройте </span><a href="http://54.86.14.14/"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">http://54.86.14.14</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> в браузере, и увидите Food Trucks во всей своей желто-черной красе! Заодно, давайте взглянем на консоль </span><a href="https://console.aws.amazon.com/ecs/home?region=us-east-1#/clusters"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">AWS ECS</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;">.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><img src="image26474.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><img src="image4062.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Видно, что был создан ECS-кластер 'foodtrucks', и в нем выполняется одна задача с двумя инстансами. Советую поковыряться в этой консоли и изучить разные ее части и опции.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Вот и все. Всего несколько команд — и приложение работает на AWS!</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a name="outro"></a><span style=" font-family:'Verdana,sans-serif'; font-size:x-large; color:#000000; background-color:#ffffff;">4</span><span style=" font-family:'Verdana,sans-serif'; font-size:x-large; color:#000000; background-color:#ffffff;">.0 Заключение</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Мы подошли к концу. После длинного, изматывающего, но интересного пособия вы готовы захватить мир контейнеров! Если вы следовали пособию до самого конца, то можете заслуженно гордиться собой. Вы научились устанавливать Докер, запускать свои контейнеры, запускать статические и динамические веб-сайты и, самое главное, получили опыт деплоя приложений в облако.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Надеюсь, прохождение этого руководства помогло вам стать увереннее в своих способностях управляться с серверами. Когда у вас появится новая идея для сайта или приложения, можете быть уверены, что сможете показать его людям с минимальными усилиями.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a name="next"></a><span style=" font-family:'Verdana,sans-serif'; font-size:large; color:#000000; background-color:#ffffff;">4</span><span style=" font-family:'Verdana,sans-serif'; font-size:large; color:#000000; background-color:#ffffff;">.1 Следующие шаги</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Ваше путешествие в мир контейнеров только началось. Моей целью в этом руководстве было нагулять ваш аппетит и показать мощь Докера. В мире современных технологий иногда бывает сложно разобраться самостоятельно, и руководства вроде этого призваны помогать вам. Это такое пособие, которое мне хотелось бы иметь, когда я только знакомился с Докером сам. Надеюсь, ему удалось заинтересовать вас, так что теперь вы сможете следить за прогрессом в этом области не со стороны, а с позиции знающего человека.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Ниже — список дополнительных полезных ресурсов. Советую использовать Докер в вашем следующем проекте. И не забывайте — практика приводит к совершенству.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; font-weight:696; color:#000000;">Дополнительные ресурсы</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://github.com/veggiemonk/awesome-docker"><span style=" color:#990099;">Awesome Docker</span></a></li>
<li style=" font-family:'Verdana,sans-serif'; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://docker.atbaker.me/"><span style=" color:#990099;">Hello Docker Workshop</span></a></li>
<li style=" font-family:'Verdana,sans-serif'; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://www.youtube.com/watch?v=PJ95WY2DqXo"><span style=" color:#990099;">Building a microservice with Node.js and Docker</span></a></li>
<li style=" font-family:'Verdana,sans-serif'; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://blog.codeship.com/why-docker/"><span style=" color:#990099;">Why Docker</span></a></li>
<li style=" font-family:'Verdana,sans-serif'; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://www.docker.com/newsletter-subscription"><span style=" color:#990099;">Docker Weekly</span></a> and <a href="https://blog.docker.com/docker-weekly-archives/"><span style=" color:#990099;">archives</span></a></li>
<li style=" font-family:'Verdana,sans-serif'; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://blog.codeship.com/"><span style=" color:#990099;">Codeship Blog</span></a></li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Удачи, юный падаван!</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a name="feedback"></a><span style=" font-family:'Verdana,sans-serif'; font-size:large; color:#000000; background-color:#ffffff;">4</span><span style=" font-family:'Verdana,sans-serif'; font-size:large; color:#000000; background-color:#ffffff;">.2 Фидбек автору</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Теперь моя очередь задавать вопросы. Вам понравилось пособие? Оно показалось вам запутанным, или вам удалось научиться чему-то?</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Напишите мне (автору оригинального пособия, — прим. пер.) напрямую на</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> </span><a href="mailto:prakhar@prakhar.me"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">prakhar@prakhar.me</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> или просто </span><a href="https://github.com/prakhar1989/docker-curriculum/issues/new"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">создайте issue</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;">. Я есть в </span><a href="https://twitter.com/prakharsriv9"><span style=" font-family:'Verdana,sans-serif'; color:#990099;">Твиттере</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;">, так что если хотите, то можете писать туда.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; font-style:italic; color:#000000;">(Автор оригинального пособия говорит по-английски, — прим. пер.).</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000; background-color:#ffffff;">Буду рад услышать ваши отзывы. Не стесняйтесь предлагать улучшения или указывать на мои ошибки. Я хочу, чтобы это пособие стало одним из лучших стартовых руководств в интернете. У меня не получится это без вашей помощи.</span></p></body></html>