<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; font-size:10pt; font-weight:600; color:#333333;">Предлагается отчет, который за приемлемое время находит и показывает ВСЕ повторяющиеся фрагменты в текстах программных модулей анализируемой конфигурации. Приводятся подробности реализации отчета, основанного на алгоритме Манбера и Майерса построения суффиксного массива и на алгоритме Касаи построения LCP-массива. В данной реализации поиск повторов ведется до уровня строк. Отчет можно применять для определения повторяющихся последовательностей строк и в любых других текстах.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; font-size:10pt; font-weight:600; color:#333333;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><img src="image22351.png" /><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; font-size:10pt; color:#333333;"><br />Считать ли злом копирование фрагментов кода (копипаст) впроцессе программировании на 1С – решайте сами. Есть другой интересный вопрос – как найти и измерить копипаст в уженаписанной программе. Одна из возможностей - использование предлагаемого отчета.<br /><br />Перед использованием отчета тексты программных модулей анализируемой конфигурации необходимо выгрузить в некоторую папку. Это можно сделать через конфигуратор с использованием пункта меню &quot;Конфигурация\Выгрузить файлы конфигурации&quot;. Далее можно запустить формирование отчета, указав ту папку, в которую были выгружены файлы. Через несколько минут (время зависит от общего числа строк в программных модулях) отчет покажет список повторов в виде таблицы, каждая запись которой содержит размер повторяющегося фрагмента в строках, место фрагмента и его копии в сквозной нумерации строк всех модулей. Выделив конкретный повтор в списке, можно увидеть сам фрагмент, имя содержащего его модуля и номер строки начала фрагмента в данном модуле, а также имя модуля и номер строки копии фрагмента. </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; font-size:10pt; color:#333333;">Применив отчет к некоторым типовым конфигурациям, можно увидеть, что например, в 1С: Бухгалтерии 2.0 общее число строк всех модулей конфигурации превышает 3,5 миллиона (на их анализ ушло порядка 20 минут). При этом имеется очень большое количество повторений фрагментов. В основном повторяются тексты модулей в регламентированной отчетности. Длина цельнотянутых кусков достигает 10 тысяч строк! А повторение тысячи строк в этой подсистеме - вообще норма. В других подсистемах также можно встретить очень большие повторяющиеся куски. Впрочем, лучше один раз увидеть, чем сто раз услышать: смотрите и удивляйтесь!<br /><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'inherit,serif'; font-size:14.5pt; color:#333333;">Несколько слов о реализации.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; font-size:10pt; color:#333333;">Основная идея метода - использование LCP-массива, который строится по конкатенации текстов модулей анализируемой конфигурации.<br /><br />Формирование отчета состоит из этапов:<br /><br /></span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; color:#333333; background-color:#ffffff;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; font-size:10pt;">Чтение текстов модулей. При этом строки модулей получают сквозную нумерацию в массиве &quot;Ранг&quot;, запоминаются размеры модулей (чтобы потом можно было восстановить имя модуля и номер строки в нем), сама строка обрезается от пробелов слева и справа и получает ранг, равный количеству различных строк, встреченных в текстах модулей ранее. Таким образом, все разные строки обозначаются в массиве &quot;Ранг&quot; разными числами от нуля до старшего номера.</span> </li>
<li style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; color:#333333; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; font-size:10pt;">Построение суффиксного массива. Входной строкой при этом считается последовательность элементов массива &quot;Ранг&quot;. Здесь используется алгоритм, изобретенный в 1993 году Манбером (сейчас вице-президент Гугла) и Майерсом. Особенности данной реализации в том, что строка для удобства зациклена (адресуется по модулю длины строки), а не дополнена сентителами справа. А также в том, что раскладка по корзинам осуществляется с использованием такой структуры данных языка 1С, как массив массивов. При этом первый элемент каждого вложенного массива хранит предыдущий символ, положенный в соответствующую корзину. Смена символа отмечается добавлением к номеру нового символа одной десятой (чтобы не тратить на это дополнительную память). Далее массив &quot;Ранг&quot; обходится &quot;змеей&quot;: во внешней цикле по корзинам и во внутреннем цикле - по содержимому корзин и заново нумеруется. Порядок обхода задается следом змеи, а сдвиг (охват) между обрабатываемым символом и корзиной увеличивается каждый раз вдвое, пока все символы в массиве «Ранг» не кажутся разными. Вот код процедуры построения суффиксного массива:</span> </li></ol>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">Процедура</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">ПолучитьСуффиксныйМассив_</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">(</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Ранг</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">,</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">След</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">,</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Охват</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">=</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> 1</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">)</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">Экспорт</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">    </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">    </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Старший</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">=</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">След</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">.</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">ВГраница</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">();</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">    </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">К</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">=</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Ранг</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">.</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Количество</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">();</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">    </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">    </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">Пока</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Старший</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">&lt;</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Ранг</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">.</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">ВГраница</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">()</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">Цикл</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">        </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">        </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Змея</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">=</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">Новый</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Массив</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">(</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Ранг</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">.</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Количество</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">(),</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> 1</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">);</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">        </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">        </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">Для</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">у</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">=</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> 0 </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">По</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">След</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">.</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">ВГраница</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">()</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">Цикл</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">            </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">Для</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">ж</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">=</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> 1 </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">По</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">След</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">[</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">у</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">].</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">ВГраница</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">()</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">Цикл</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">                </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">                ё </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">=</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">(</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Цел</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">(</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">След</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">[</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">у</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">][</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">ж</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">])</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">-</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Охват</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">+</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">К</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">)</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">%</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">К</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">;</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">                </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">х</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">=</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Ранг</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">[(</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">ё </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">+</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Охват</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">)</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">%</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">К</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">];</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">                </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Змея</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">[</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Ранг</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">[</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">ё</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">]].</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Добавить</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">(</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">ё </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">+</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> 0</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">.</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">1 </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">*</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">(</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Змея</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">[</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Ранг</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">[</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">ё</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">]][</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">0</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">]</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">&lt;&gt;</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">х</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">));</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">                </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Змея</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">[</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Ранг</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">[</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">ё</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">]][</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">0</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">]</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">=</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">х</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">                </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">            </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">КонецЦикла</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">        </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">КонецЦикла;</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">        </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">        </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Старший</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">=</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">-</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> 1</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">;</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">        </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">        </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">Для</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">у</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">=</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> 0 </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">По</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">К</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">-</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> 1 </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">Цикл</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">            </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">Для</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">ж</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">=</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> 1 </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">По</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Змея</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">[</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">у</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">].</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">ВГраница</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">()</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">Цикл</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">                </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">                ё </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">=</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Змея</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">[</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">у</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">][</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">ж</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">];</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">                </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Старший</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">=</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Старший</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">+</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> ё </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">%</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> 1 </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">*</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> 10</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">;</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">                </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Ранг</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">[</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">ё</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">]</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">=</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Старший</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">                </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">            </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">КонецЦикла</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">        </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">КонецЦикла;</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">        </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Охват</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">=</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Охват</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">*</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> 2</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">;</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">        </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">        </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">След</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">=</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Змея</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">        </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">    </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">КонецЦикла</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">    </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">КонецПроцедуры</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; font-size:10pt; color:#333333;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; font-size:10pt; color:#333333;">Построение LCP-массива. LCP-массив показывает для каждого символа строки (это каждая строка программы в нашем случае) длину наибольшего общего префикса для подстроки, начинающейся в данном месте, и подстроки, следующей за ней в суффиксном массиве. Буквально это и есть длина наибольшего повторяющегося фрагмента, начинающегося в данном месте. Небольшая деталь заключается в несимметричности связи этих одинаковых фрагментов, которая в данном случае оказывается даже выгодной. Поскольку найденная копия окажется в суффиксном массиве позже, то для нее уже не будет копией текущий фрагмент.  Поэтому каждый фрагмент будет встречаться в выдаче алгоритма только один раз. Построение LCP-массива выполняется по алгоритму Касаи. Вот код процедуры построения LCP-массива:</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">Процедура</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">ПолучитьДлиныНаибольшихОбщихПрефиксов_</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">(</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Тень</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">,</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Ранг</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">,</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Путь</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">,</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Рост</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">,</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Плюс</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">=</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> 0</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">)</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">Экспорт</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">    </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">    </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">Для</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> ё </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">=</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> 0 </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">По</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Ранг</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">.</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">ВГраница</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">()</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">Цикл</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">        </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Путь</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">[</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Ранг</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">[</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">ё</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">]]</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">=</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> ё </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">    </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">КонецЦикла;</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">    </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">    </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">Для</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> ё </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">=</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> 0 </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">По</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Ранг</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">.</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">ВГраница</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">()</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">Цикл</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">        </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">        </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">ж</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">=</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">?(</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Ранг</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">[</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">ё</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">]</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">&lt;</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Ранг</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">.</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">ВГраница</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">(),</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Путь</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">[</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Ранг</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">[</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">ё</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">]</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">+</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> 1</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">],</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Ранг</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">.</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Количество</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">());</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">        </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">        </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">Пока</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Макс</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">(</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">ё</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">,</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">ж</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">)</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">+</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Плюс</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">&lt;</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Тень</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">.</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Количество</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">()</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">И</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Тень</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">[</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">ё </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">+</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Плюс</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">]</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">=</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Тень</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">[</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">ж</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">+</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Плюс</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">]</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">Цикл</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">            </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Плюс</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">=</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Плюс</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">+</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> 1 </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">        </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">КонецЦикла;</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">        </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">        </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Рост</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">[</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">ё</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">]</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">=</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Плюс</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">;</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">        </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Плюс</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">=</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Макс</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">(</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">0</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">,</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Плюс</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">-</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> 1</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">)</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">        </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">    </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">КонецЦикла</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">    </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">КонецПроцедуры</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; font-size:10pt; color:#333333;">Выделение повторов из LCP-массива. Если представить LCP-массив графиком, то интерес для отображения повторов будут иметь только зубцы этого графика, поскольку другие точки будут соответствовать меньшим по размеру повторам, полностью входящим в бОльший по размеру повтор слева (сверху). Наибольшие повторы отбираются простейшим алгоритмом сравнения текущего значения со значениями слева и справа. При этом в отчете можно задать порог, чтобы не выбирались повторы, число строк в которых меньше этого порога. Вот код выделения повторов:</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">Функция</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">ОтборМестПовторов_</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">(</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Ранг</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">,</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Путь</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">,</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Рост</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">)</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">Экспорт</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">    </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">    </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Ответ</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">=</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Повторы</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">.</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">ВыгрузитьКолонки</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">();</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">    </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">    </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">Для</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> ё </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">=</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> 0 </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">По</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Рост</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">.</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">ВГраница</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">()</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">Цикл</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">        </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">        </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">у</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">=</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Макс</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">(</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">0</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">,</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> ё </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">-</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> 1</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">);</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">ж</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">=</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Мин</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">(</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">ё </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">+</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> 1</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">,</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Рост</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">.</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">ВГраница</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">());</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">        </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">        </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">Если</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Порог</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">&lt;</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Рост</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">[</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">ё</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">]</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">И</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Рост</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">[</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">у</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">]</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">&lt;=</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Рост</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">[</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">ё</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">]</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">И</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Рост</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">[</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">ё</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">]</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">&gt;=</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Рост</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">[</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">ж</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">]</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">Тогда</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">            </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">            </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">э</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">=</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Ответ</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">.</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Добавить</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">();</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">            </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">э</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">.</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Место</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">=</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> ё</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">;</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">            </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">э</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">.</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Рост</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">=</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Рост</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">[</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">ё</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">];</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">            </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">э</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">.</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Копия</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">=</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Путь</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">[</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Ранг</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">[</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">ё</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">]</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">+</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> 1</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">]</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">            </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">        </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">КонецЕсли</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">        </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">    </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">КонецЦикла;</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">    </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">    </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">Возврат</span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Consolas'; font-size:8.25pt; color:#0000ff;">Ответ</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#333333;">    </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Consolas'; font-size:8.25pt; color:#ff0000;">КонецФункции</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; font-size:10pt; color:#333333;">И, наконец,повторы сортируются в порядке убывания их размеров.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'inherit,serif'; font-size:14.5pt; color:#333333;">Выводы</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; color:#333333; background-color:#ffffff;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; font-size:10pt;">Правильно выбранный алгоритм может скомпенсировать недостаточное быстродействие платформы 1С при проведении быстрых массовых вычислений без необходимости применения внешних компонент.</span> </li>
<li style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; color:#333333; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; font-size:10pt;">В данной задаче не усматривается необходимости применения более сложных алгоритмов построения суффиксного массива (типа алгоритма Каркайнена – Сандерса и других), так как для разовых применений быстродействия алгоритма достаточно.</span> </li>
<li style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; color:#333333; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; font-size:10pt;">Структуры данных платформы 1С позволяют получать компактный и выразительный код при реализации самых хитрых алгоритмов.</span> </li>
<li style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; color:#333333; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; font-size:10pt;">Подход,положенный в основу данного отчета, может послужить основой и для более изощренных методов обработки текстов программ. С его помощью можно искать часто встречающиеся полезные шаблоны (оставив в анализируемых текстах только ключевые слова или канонизировав тексты модулей другим способом). Можно автоматически выносить повторяющиеся функции и процедуры в общие модули. Можно искать зависимости при внесении изменений в конфигурации. И так далее.</span> </li>
<li style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; color:#333333; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; font-size:10pt;">Приведенные алгоритмы – это совсем небольшая (и довольно простая) часть алгоритмов над строками. Имеющих, кроме показанных в данном отчете, множество других применений. Например, на основе суффиксного массива часто строится индекс, используемый при полнотекстовом поиске. Знание этих алгоритмов позволяет эффективно решать и многие другие практические задачи.</span> </li>
<li style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; color:#333333; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; font-size:10pt;">Ну и остался загадкой вопрос: есть ли какие-либо фундаментальные причины у большой избыточности текстов программ типовых конфигураций, замеченной с помощью предлагаемого отчета, или играют роль организационный и человеческий факторы?</span> </li></ol>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'inherit,serif'; font-size:14.5pt; color:#333333;">Ссылки</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; color:#333333; background-color:#ffffff;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; font-size:10pt;">Суффиксный массив — удобная замена суффиксного дерева</span><span style=" font-family:'Verdana,sans-serif';"> </span><a href="http://infostart.ru/redirect.php?url=aHR0cDovL2hhYnJhaGFici5ydS9wb3N0LzExNTM0Ni8="><span style=" font-family:'Verdana,sans-serif'; font-size:10pt; text-decoration: underline; color:#428bca;">http://habrahabr.ru/post/115346/</span></a> </li>
<li style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; color:#333333; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; font-size:10pt;">MANBER U., MAYERS G.. Suffix arrays: a new methodfor on-line string searches // SIAM Journal on Computing. – 1993. – №22. – P.953–948.</span> </li>
<li style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; color:#333333; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://infostart.ru/redirect.php?url=aHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9TdWZmaXhfYXJyYXk="><span style=" font-family:'Verdana,sans-serif'; font-size:10pt; text-decoration: underline; color:#428bca;">http://en.wikipedia.org/wiki/Suffix_array</span></a> </li>
<li style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt; color:#333333; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; font-size:10pt;">Kasai, T.; Lee, G.; Arimura, H.;Arikawa, S.; Park, K. (2001). &quot;Linear-Time Longest-Common-PrefixComputation in Suffix Arrays and Its Applications&quot;. Proceedings ofthe 12th Annual Symposium on Combinatorial Pattern Matching. LectureNotes in Computer Science 2089. pp. 181–192. doi:10.1007/3-540-48194-X_17. ISBN 978-3-540-42271-6.</span> </li></ol>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;">  </span></p></body></html>