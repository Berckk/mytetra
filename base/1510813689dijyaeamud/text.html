<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:10px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:1.1%;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:296; color:#333333;">Обмен между базами 1С 8.3. Доработка типового плана обмена (синхронизации) между конфигурациями 1С на примере обмена 1С: Зарплата и управление персоналом 3 и 1С: Бухгалтерия предприятия 3</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> В каждом плане есть определенный список элементов, информацию об изменении которых он может хранить. Этот список называется «Состав плана обмена». Состав можно расширять, но при этом поддержка конфигурации снимается.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;">В «Макете плана» хранятся те самые правила, на основе которых работает синхронизация. Вот именно этот пакет конвертации (ПравилаРегистрации, ПравилаОбмена, ПравилаОбменаКорреспондента) нам и необходим для дальнейшего изучения.<br /><br /></span><img src="image19658.png" /><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"><br /><br />  Рассмотрим пример синхронизации данных между конфигурациями «1С:Зарплата и управление персоналом 3» (ЗУП) и «1С:Бухгалтерия предприятия 3» (БП). Отметим сразу, в данной задаче нам придется снять конфигурацию с поддержки. Данное потребуется по условию. </span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> </span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#333333;">Живой пример потребности в доработке типовых правил обмена</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> </span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;">Например, заказчик обратился к нам с такой проблемой: при синхронизации между ЗУП и БП нет возможности передать данные справочника «Регистрации в налоговом органе», которые необходимы для заполнения документа «Отражение зарплаты в бухучете». Сейчас табличная часть этого документа на стороне приемника БП содержит пустую «Регистрацию…» и пользователям приходится вручную создавать такие записи в справочнике. Согласитесь, это неудобно.  Можем доработать этот момент.<br /> </span><img src="image13423.png" /><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"><br /><br />  Решение проблемы: доработаем пакет конвертации из плана обмена ОбменЗарплата3Бухгалтерия3. Добавим в типовые «Правила обмена 1С» новое «Правило конвертации объектов» (ПКО) для справочника «Регистрации в налоговом органе» и соответственно «Конвертацию свойств» этого справочника (ПКС). Обязательно доработаем типовые «Правила регистрации объектов», т.к. возникла необходимость зарегистрировать изменения справочника на узле обмена. И пересмотрим «Правила обмена 1С» базы корреспондента.<br /><br />Где все это будем редактировать? для написания и изменения правил нам потребуется конфигурация «1С:Конвертация данных 2».</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> </span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#333333;">  Доработка типовых правил конвертации из Плана обмена ЗУП – БП</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> </span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;">Итак, доработку правил обмена 1С начнем с того, что в конфигураторе для плана обмена ОбменЗарплата3Бухгалтерия3 в состав добавим новый элемент – справочник РегистрацииВНалоговомОргане. Данное изменение сделаем в обоих конфигурациях «1С:Зарплата и управление предприятием 3» и «1С:Бухгалтерия предприятия 3».<br /><br /> </span><img src="image31510.png" /><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"><br /><br />  Сохраним и обновим конфигурации.<br /><br />В режиме предприятия для каждой базы выгрузим описание структуры метаданных с помощью обработки MD83Exp.epf для платформы «1С:Предприятие 8.3». Обработку можно найти в комплекте «1С:Конвертация данных».<br /><br />На следующем этапе выгрузим пакет конвертации из ЗУП и БП. Пакет должен состоять из 3 файлов: ПравилаРегистрации, ПравилаОбмена, ПравилаОбменаКорреспондента. <br /><br />В рамках данной статьи не будет описания как настраивается синхронизация данных, это можно прочитать на сайте компании «Кодерлайн» в разделе </span><a href="https://infostart.ru/redirect.php?url=aHR0cDovL3d3dy5rb2RlcmxpbmUucnUvZXhwZXJ0Lw=="><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">«Статьи экспертов»</span></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;">  либо посмотреть записи </span><a href="https://infostart.ru/redirect.php?url=aHR0cDovL3d3dy5rb2RlcmxpbmUucnUvd2ViaW5hci8="><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">вебинаров</span></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;">. Сейчас в базах уже настроена данная опция. Поэтому переходим в настройку синхронизации (Администрирование –&gt; Синхронизация данных –&gt; Настройка синхронизации данных), нажимаем кнопку «Загрузить правила». Перед нами откроется форма «Правил для синхронизации». По кнопке «Еще» выберем пункт «Сохранить правила в файл».<br /><br /><br /> </span><img src="image29069.png" /><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"><br /><br />  Вот такой пакет после выгрузки должен у нас получиться.<br /><br /> <br /></span><img src="image9558.png" /><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> <br /><br />Аналогичные действия выполним и для другой информационной базы «1С:Бухгалтерия предприятия».<br />В итоге все подготовительные работы для редактирования правил готовы. У нас есть:<br /><br />- описание структуры метаданных для загрузки в «1С:Конвертация данных 2» (для ЗУП и БП);<br /><br />- пакет конвертации, который содержит правила обмена 1С и правила регистрации, необходимые для загрузки в «1С:Конвертация данных 2» (для ЗУП и БП).<br /><br />Переходим в «1С:Конвертация данных 2» . Выполним следующие действия по порядку для обоих информационных баз:<br /><br />- загружаем структуры метаданных наших конфигураций;<br /><br />- создаем конвертации и загружаем правила обмена данными 1С из пакетов конвертации (файл правил называется ExchangeRules);<br /><br />- создаем регистрации и загружаем правила регистрации из пакетов конвертации (файл правил называется RegistrationRules).<br />   <br /><br /></span><img src="image8476.png" /><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"><br /><br />  <br />Переходим непосредственно к нашей доработке. В правила обмена 1С добавляем новое правило конвертации объектов (ПКО) – справочник «Регистрации в налоговом органе». Добавляем правило конвертации свойств (ПКС) для этого справочника и правило выгрузки данных (ПВД). Такого рода доработку необходимо выполнить как для правил из пакета ЗУП, так и для правил обмена из пакета БП. Выгружаем наши правила обмена в соответствующие файлы ExchangeRules.<br /><br /> </span><img src="image4695.png" /><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"><br /><br />  <br />Переходим к правилам регистрации нового элемента. Добавляем справочник «Регистрации в налоговом органе». Выгружаем правила регистрации в соответствующий файл из пакета RegistrationRules. Это действие также выполняем для обоих баз.<br /><br /> </span><img src="image21301.png" /><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"><br /><br />  Доработанные правила обмена и правила регистрации готовы. Теперь в правила корреспондента (CorrespondentExchangeRules) из пакета ЗУП копируем содержимое правил обмена (ExchangeRules) из пакета БП. В правила корреспондента (CorrespondentExchangeRules) из пакета БП копируем содержимое правил обмена (ExchangeRules) из пакета ЗУП.<br /><br />В итоге должно получиться следующее: <br /><br /></span><img src="image19549.png" /><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> <br />На этом работа в «1С:Конвертация данных 2» завершена. Доработанные пакеты правил конвертации готовы, осталось загрузить их обратно в информационные базы и проверить синхронизацию. <br /><br />Архивируем файлы из пакетов в Архив ZIP и загружаем в ЗУП и БП свои пакеты конвертации.<br /><br /></span><img src="image338.png" /><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"><br /><br />  Все готово. Осталось протестировать.<br /><br />Вспомним условия задачи. Необходимо было зарегистрировать к выгрузке справочник «Регистрации в налоговом органе» и проверить, как заполняется ТЧ документа «Отражение зарплаты в бухучете» на стороне «1С:Бухгалтерия предприятия 3».<br /><br />В источнике «1С:Зарплата и управление предприятием 3» регистрируем к выгрузке наш справочник. Выполняем синхронизацию. Переходим в базу приемник и тоже выполняем синхронизацию для получения данных. Обратим внимание, что теперь в плане обмена появился нужный справочник для регистрации изменений.<br /> <br /></span><img src="image17949.png" /><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"><br /><br />Проверяем на стороне «1С:Бухгалтерия предприятия 3»:<br /> <br /> </span><img src="image15850.png" /></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image28770.png" /><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"><br />  Подведем итог. Результат поставленной задачи выполнен успешно. Мы доработали план обмена ЗУП – БП, добавив новый элемент для регистрации изменений и дописали правила конвертации для синхронизации данных.</span></p>
<p style=" margin-top:20px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:296; color:#333333;">Скриншоты</span></p>
<p style=" margin-top:15px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image19658.png" /><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"><br />1.png</span></p>
<p style=" margin-top:15px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image13423.png" /><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"><br />2.png</span></p>
<p style=" margin-top:15px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image31510.png" /><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"><br />3.png</span></p>
<p style=" margin-top:15px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image29069.png" /><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"><br />4.png</span></p>
<p style=" margin-top:15px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image8476.png" /><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"><br />6.png</span></p>
<p style=" margin-top:15px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image4695.png" /><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"><br />7.png</span></p>
<p style=" margin-top:15px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image9558.png" /><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"><br />11111111111.png</span></p>
<p style=" margin-top:15px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image21301.png" /><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"><br />8.png</span></p>
<p style=" margin-top:15px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image19549.png" /><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"><br />9.png</span></p>
<p style=" margin-top:15px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image338.png" /><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"><br />10.png</span></p>
<p style=" margin-top:15px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image17949.png" /><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"><br />11.png</span></p>
<p style=" margin-top:15px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image15850.png" /><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"><br />12.png</span></p>
<p style=" margin-top:15px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image28770.png" /><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"><br />13.png</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://infostart.ru/public/697808/"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">Полная версия</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#333333;">© ООО &quot;Инфостарт&quot;, 2006-2013 </span><a href="http://infostart.ru/"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; text-decoration: underline; color:#428bca;">www.infostart.ru</span></a></p></body></html>