<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; font-size:10.5pt; color:#000000; background-color:#ffffff;">Есть очень много статей о том, как работать с XSL/XSD из 1С, но все они в стиле: возьмем нашу XSD схему (простую и удбоную) или наш web-сервис и смотрите, как все легко экспортировать или импортировать. А что делать, если нам дали пачку XSD-схем со сложным взаимосвязями и изменять мы них не можем, а работать и поддерживать актуальность схем надо? </span><span style=" font-family:'Verdana,sans-serif'; font-size:10.5pt; color:#000000;"><br /></span><a name="habracut"></a><span style=" font-family:'Verdana,sans-serif'; font-size:10.5pt; color:#000000;"><br /></span><span style=" font-family:'Verdana,sans-serif'; font-size:10.5pt; font-weight:600; font-style:italic; color:#000000; background-color:#ffffff;">Сразу скажу, вопросы шифрования/подписи по ГОСТУ при работе с ГИС ЖКХ за рамками этой статьи и на хабре уже освещались. Хотя без подписей запросы выполнить не удастся.</span><span style=" font-family:'Verdana,sans-serif'; font-size:10.5pt; color:#000000;"><br /><br /></span><img src="image16518.png" /><span style=" font-family:'Verdana,sans-serif'; font-size:10.5pt; color:#000000;"><br /></span><span style=" font-family:'Verdana,sans-serif'; font-size:10.5pt; color:#000000; background-color:#ffffff;">Начнем с простого — скачаем пакет форматов </span><a href="https://dom.gosuslugi.ru/#!/regulations"><span style=" font-family:'Verdana,sans-serif'; font-size:10.5pt; text-decoration: underline; color:#990099; background-color:#ffffff;">по интеграционному взаимодействию с ГИС ЖКХ</span></a><span style=" font-family:'Verdana,sans-serif'; font-size:10.5pt; color:#000000; background-color:#ffffff;">, импортируем все xsd схемы из пакета интеграций, наведем порядок переименуем все как нам удобно. В итоге получим как показано на картинке: </span><span style=" font-family:'Verdana,sans-serif'; font-size:10.5pt; color:#000000;"><br /><br /></span><span style=" font-family:'Verdana,sans-serif'; font-size:10.5pt; color:#000000; background-color:#ffffff;">Ну а теперь приступим к магии. Попробуем запросить данные из справочника организаций по ОРГН. Это подсистема organizations-registry-common метод exportOrgRegist.</span><span style=" font-family:'Verdana,sans-serif'; font-size:10.5pt; color:#000000;"><br /><br /></span><span style=" font-family:'Verdana,sans-serif'; font-size:10.5pt; color:#000000; background-color:#ffffff;">В hcs-organizations-registry-common-service.wsdl указано:</span><span style=" font-family:'Verdana,sans-serif'; font-size:10.5pt; color:#000000;"><br /><br /></span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; font-size:10.5pt; color:#6da3bd;">Спецификация из hcs-organizations-registry-common-service.wsdl</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; font-size:10.5pt; color:#000000;"><br /></span><span style=" font-family:'Verdana,sans-serif'; font-size:10.5pt; color:#000000; background-color:#ffffff;">Надо собрать SOAP пакет из заголовка ISRequestHeader, тела exportOrgRegistryRequest. Посмотрим их в xsd схемах спецификаций по интеграций.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; font-size:10.5pt; color:#6da3bd;">hcs-base.xsd</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; font-size:10.5pt; color:#6da3bd;">hcs-organizations-base.xsd</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; font-size:10.5pt; color:#6da3bd;">hcs-organizations-registry-common-types.xsd</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; font-size:10.5pt; color:#000000;"><br /></span><span style=" font-family:'Verdana,sans-serif'; font-size:10.5pt; color:#000000; background-color:#ffffff;">Ну приступим, откроем нужные нам пакеты XDTO. Оказывается, нужные сущности являются не типами, а свойствами, как с этим работать в документации на XDTO в статьях, которые я находил, не описано, поэтому воспользуемся урокам магии:</span><span style=" font-family:'Verdana,sans-serif'; font-size:10.5pt; color:#000000;"><br /><br /><br /></span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Symbol'; font-size:10pt; color:#000000;">·</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#000000;">         </span><span style=" font-family:'Verdana,sans-serif'; font-size:10.5pt; color:#000000;">Создадим объекты из свойств</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Symbol'; font-size:10pt; color:#000000;">·</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#000000;">         </span><span style=" font-family:'Verdana,sans-serif'; font-size:10.5pt; color:#000000;">Создадим объекты из внутренних типов свойств или тип объектов</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Symbol'; font-size:10pt; color:#000000;">·</span><span style=" font-family:'Times New Roman'; font-size:7pt; color:#000000;">         </span><span style=" font-family:'Verdana,sans-serif'; font-size:10.5pt; color:#000000;">Создадим объекты из Типов значений</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; font-size:10.5pt; color:#000000;"><br /></span><img src="image17099.png" /><span style=" font-family:'Verdana,sans-serif'; font-size:10.5pt; color:#000000;"><br /><br /></span><span style=" font-family:'Verdana,sans-serif'; font-size:10.5pt; color:#000000; background-color:#ffffff;">Начнем с тела exportOrgRegistryRequest.</span><span style=" font-family:'Verdana,sans-serif'; font-size:10.5pt; color:#000000;"><br /><br /><br /></span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">&amp;НаСервереБезКонтекста</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; font-weight:600; color:#333333; background-color:#f8f8f8;">Функция</span><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;"> </span><span style=" font-family:'Courier New'; font-size:9pt; font-weight:600; color:#990000; background-color:#f8f8f8;">ПолучитьДанныеОрганизацияПоОГРН</span><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">(ОГРН)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">  </span><span style=" font-family:'Courier New'; font-size:9pt; font-style:italic; color:#999988; background-color:#f8f8f8;">//Получим нужные пакеты</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">  ПакетOrgRegCom = ФабрикаXDTO.Пакеты.Получить(</span><span style=" font-family:'Courier New'; font-size:9pt; color:#dd1144; background-color:#f8f8f8;">&quot;http://dom.gosuslugi.ru/schema/integration/organizations-registry-common/&quot;</span><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">);</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">  ПакетOrgBase = ФабрикаXDTO.Пакеты.Получить(</span><span style=" font-family:'Courier New'; font-size:9pt; color:#dd1144; background-color:#f8f8f8;">&quot;http://dom.gosuslugi.ru/schema/integration/organizations-base/&quot;</span><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">);</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">  </span><span style=" font-family:'Courier New'; font-size:9pt; font-style:italic; color:#999988; background-color:#f8f8f8;">//Магия:выйдем на нужный тип через свойство, этот метод нам очень часто пригодится:</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">  СвойствоXDTO = ПакетOrgRegCom.КорневыеСвойства.Получить(</span><span style=" font-family:'Courier New'; font-size:9pt; color:#dd1144; background-color:#f8f8f8;">&quot;exportOrgRegistryRequest&quot;</span><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">);</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">  </span><span style=" font-family:'Courier New'; font-size:9pt; font-style:italic; color:#999988; background-color:#f8f8f8;">//Создадим сам объект для тела запроса</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">  ОбъектXDTO = ФабрикаXDTO.Создать(СвойствоXDTO.Тип);</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">  </span><span style=" font-family:'Courier New'; font-size:9pt; font-style:italic; color:#999988; background-color:#f8f8f8;">//признак что это элемент надо подписать сертификатом</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">  ОбъектXDTO.Id = </span><span style=" font-family:'Courier New'; font-size:9pt; color:#dd1144; background-color:#f8f8f8;">&quot;signed-data-container&quot;</span><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">  </span><span style=" font-family:'Courier New'; font-size:9pt; font-style:italic; color:#999988; background-color:#f8f8f8;">//требования стандарта, импорт XDTO не обрабатывает аттрибут fixed </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">  ОбъектXDTO.version = </span><span style=" font-family:'Courier New'; font-size:9pt; color:#dd1144; background-color:#f8f8f8;">&quot;10.0.2.1&quot;</span><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;"> </span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">  </span><span style=" font-family:'Courier New'; font-size:9pt; font-style:italic; color:#999988; background-color:#f8f8f8;">//критерий поиска</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">  </span><span style=" font-family:'Courier New'; font-size:9pt; font-style:italic; color:#999988; background-color:#f8f8f8;">//Магия:опять выйдем на строенный тип, через свойства объекта</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">  SearchCriteriaЗапись = ФабрикаXDTO.Создать(ОбъектXDTO.SearchCriteria.ВладеющееСвойство.Тип);</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">         </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">  </span><span style=" font-family:'Courier New'; font-size:9pt; font-style:italic; color:#999988; background-color:#f8f8f8;">//огрн надо ставить через типизированное значение</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">  OGRN = ФабрикаXDTO.Создать(ПакетOrgBase.КорневыеСвойства.Получить(</span><span style=" font-family:'Courier New'; font-size:9pt; color:#dd1144; background-color:#f8f8f8;">&quot;OGRN&quot;</span><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">).Тип, </span><span style=" font-family:'Courier New'; font-size:9pt; font-weight:600; color:#333333; background-color:#f8f8f8;">Строка</span><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">(ОГРН));</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">  SearchCriteriaЗапись.OGRN = OGRN;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">  ОбъектXDTO.SearchCriteria.Добавить(SearchCriteriaЗапись);</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">         </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">  </span><span style=" font-family:'Courier New'; font-size:9pt; font-style:italic; color:#999988; background-color:#f8f8f8;">//сохраним тело</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">  Запрос = Новый Структура(</span><span style=" font-family:'Courier New'; font-size:9pt; color:#dd1144; background-color:#f8f8f8;">&quot;ОбъектXDTO,СвойствоXDTO,Имя&quot;</span><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">, ОбъектXDTO, СвойствоXDTO);</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">  </span><span style=" font-family:'Courier New'; font-size:9pt; font-style:italic; color:#999988; background-color:#f8f8f8;">//сохраним тип ответа, нам по надобиться для десериализаций ответа</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">  ОтветСвойствоXDTOResult = ПакетOrgRegCom.КорневыеСвойства.Получить(</span><span style=" font-family:'Courier New'; font-size:9pt; color:#dd1144; background-color:#f8f8f8;">&quot;exportOrgRegistryResult&quot;</span><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">);</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">         </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">  </span><span style=" font-family:'Courier New'; font-size:9pt; font-weight:600; color:#333333; background-color:#f8f8f8;">Возврат</span><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;"> СформироватьXMLЗапрос(Новый УникальныйИдентификатор, Запрос, ОтветСвойствоXDTOResult );</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; font-weight:600; color:#333333; background-color:#f8f8f8;">КонецФункции</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; font-size:10.5pt; color:#000000;"><br /></span><span style=" font-family:'Verdana,sans-serif'; font-size:10.5pt; color:#000000; background-color:#ffffff;">Напишем функцию для сбора XML-запроса:</span><span style=" font-family:'Verdana,sans-serif'; font-size:10.5pt; color:#000000;"><br /><br /><br /></span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">&amp;НаСервереБезКонтекста</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; font-weight:600; color:#333333; background-color:#f8f8f8;">Функция</span><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;"> </span><span style=" font-family:'Courier New'; font-size:9pt; font-weight:600; color:#990000; background-color:#f8f8f8;">СформироватьXMLЗапрос</span><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">(GuidЗаголовка, ОтправкаXDTO, ОтветXDTO)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">  ПакетBase = ФабрикаXDTO.Пакеты.Получить(</span><span style=" font-family:'Courier New'; font-size:9pt; color:#dd1144; background-color:#f8f8f8;">&quot;http://dom.gosuslugi.ru/schema/integration/base/&quot;</span><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">);</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">  ПространствоИменSOAP = </span><span style=" font-family:'Courier New'; font-size:9pt; color:#dd1144; background-color:#f8f8f8;">&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;</span><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">  </span><span style=" font-family:'Courier New'; font-size:9pt; font-style:italic; color:#999988; background-color:#f8f8f8;">//XML файл     </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">  ЗаписьXML = Новый ЗаписьXML;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">  ПараметрыЗаписиXML = Новый ПараметрыЗаписиXML(</span><span style=" font-family:'Courier New'; font-size:9pt; color:#dd1144; background-color:#f8f8f8;">&quot;UTF-8&quot;</span><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">);</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">  ЗаписьXML.УстановитьСтроку(ПараметрыЗаписиXML);</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">  ЗаписьXML.ЗаписатьОбъявлениеXML();</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">    ЗаписьXML.ЗаписатьНачалоЭлемента(</span><span style=" font-family:'Courier New'; font-size:9pt; color:#dd1144; background-color:#f8f8f8;">&quot;Envelope&quot;</span><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">, ПространствоИменSOAP);</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">    ЗаписьXML.ЗаписатьСоответствиеПространстваИмен(</span><span style=" font-family:'Courier New'; font-size:9pt; color:#dd1144; background-color:#f8f8f8;">&quot;soap&quot;</span><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">, ПространствоИменSOAP);</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">    ЗаписьXML.ЗаписатьСоответствиеПространстваИмен(</span><span style=" font-family:'Courier New'; font-size:9pt; color:#dd1144; background-color:#f8f8f8;">&quot;xsi&quot;</span><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">, </span><span style=" font-family:'Courier New'; font-size:9pt; color:#dd1144; background-color:#f8f8f8;">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">);</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">    ЗаписьXML.ЗаписатьСоответствиеПространстваИмен(</span><span style=" font-family:'Courier New'; font-size:9pt; color:#dd1144; background-color:#f8f8f8;">&quot;xs&quot;</span><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">, </span><span style=" font-family:'Courier New'; font-size:9pt; color:#dd1144; background-color:#f8f8f8;">&quot;http://www.w3.org/2001/XMLSchema&quot;</span><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">);</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">                 </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">    ЗаписьXML.ЗаписатьСоответствиеПространстваИмен(</span><span style=" font-family:'Courier New'; font-size:9pt; color:#dd1144; background-color:#f8f8f8;">&quot;base&quot;</span><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">, </span><span style=" font-family:'Courier New'; font-size:9pt; color:#dd1144; background-color:#f8f8f8;">&quot;http://dom.gosuslugi.ru/schema/integration/base/&quot;</span><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">);</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">    ЗаписьXML.ЗаписатьСоответствиеПространстваИмен(</span><span style=" font-family:'Courier New'; font-size:9pt; color:#dd1144; background-color:#f8f8f8;">&quot;organizations-registry-base&quot;</span><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">, </span><span style=" font-family:'Courier New'; font-size:9pt; color:#dd1144; background-color:#f8f8f8;">&quot;http://dom.gosuslugi.ru/schema/integration/organizations-registry-base/&quot;</span><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">); </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">    ЗаписьXML.ЗаписатьСоответствиеПространстваИмен(</span><span style=" font-family:'Courier New'; font-size:9pt; color:#dd1144; background-color:#f8f8f8;">&quot;ns&quot;</span><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">, </span><span style=" font-family:'Courier New'; font-size:9pt; color:#dd1144; background-color:#f8f8f8;">&quot;http://www.w3.org/2000/09/xmldsig#&quot;</span><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">);</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">    ЗаписьXML.ЗаписатьСоответствиеПространстваИмен(</span><span style=" font-family:'Courier New'; font-size:9pt; color:#dd1144; background-color:#f8f8f8;">&quot;ro&quot;</span><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">, </span><span style=" font-family:'Courier New'; font-size:9pt; color:#dd1144; background-color:#f8f8f8;">&quot;http://dom.gosuslugi.ru/schema/integration/organizations-registry-common/&quot;</span><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">);</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">                 </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">     </span><span style=" font-family:'Courier New'; font-size:9pt; font-style:italic; color:#999988; background-color:#f8f8f8;">//Заголовок ISRequestHeader</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">    ЗаписьXML.ЗаписатьНачалоЭлемента(</span><span style=" font-family:'Courier New'; font-size:9pt; color:#dd1144; background-color:#f8f8f8;">&quot;Header&quot;</span><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">, ПространствоИменSOAP);</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">      </span><span style=" font-family:'Courier New'; font-size:9pt; font-style:italic; color:#999988; background-color:#f8f8f8;">//снова метод через свойства</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">      ЗаголовокСвойствоXDTO = ПакетBase.КорневыеСвойства.Получить(</span><span style=" font-family:'Courier New'; font-size:9pt; color:#dd1144; background-color:#f8f8f8;">&quot;ISRequestHeader&quot;</span><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">);</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">      ЗаголовокЗапроса = ФабрикаXDTO.Создать(ЗаголовокСвойствоXDTO.Тип);</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">      ЗаголовокЗапроса.Date = </span><span style=" font-family:'Courier New'; font-size:9pt; color:#0086b3; background-color:#f8f8f8;">ТекущаяДата</span><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">();</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">      ЗаголовокЗапроса.MessageGUID = ФабрикаXDTO.Создать(ФабрикаXDTO.Тип(</span><span style=" font-family:'Courier New'; font-size:9pt; color:#dd1144; background-color:#f8f8f8;">&quot;http://dom.gosuslugi.ru/schema/integration/base/&quot;</span><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">, </span><span style=" font-family:'Courier New'; font-size:9pt; color:#dd1144; background-color:#f8f8f8;">&quot;GUIDType&quot;</span><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">), </span><span style=" font-family:'Courier New'; font-size:9pt; font-weight:600; color:#333333; background-color:#f8f8f8;">Строка</span><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">(GuidЗаголовка));</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">      ФабрикаXDTO.ЗаписатьXML(ЗаписьXML, ЗаголовокЗапроса, ЗаголовокСвойствоXDTO.ЛокальноеИмя);</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">    ЗаписьXML.ЗаписатьКонецЭлемента();      </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">    </span><span style=" font-family:'Courier New'; font-size:9pt; font-style:italic; color:#999988; background-color:#f8f8f8;">//Тело у нас будет подготовленый exportOrgRegistryRequest</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">    ЗаписьXML.ЗаписатьНачалоЭлемента(</span><span style=" font-family:'Courier New'; font-size:9pt; color:#dd1144; background-color:#f8f8f8;">&quot;Body&quot;</span><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">, ПространствоИменSOAP);</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">      ФабрикаXDTO.ЗаписатьXML(ЗаписьXML, ОтправкаXDTO.ОбъектXDTO, ОтправкаXDTO.СвойствоXDTO.ЛокальноеИмя, ОтправкаXDTO.СвойствоXDTO.URIПространстваИмен);</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">      ЗаписьXML.ЗаписатьКонецЭлемента();</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">  ЗаписьXML.ЗаписатьКонецЭлемента();</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">  </span><span style=" font-family:'Courier New'; font-size:9pt; font-style:italic; color:#999988; background-color:#f8f8f8;">//отдаем результат для отправки</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">  XMLЗапрос = Новый Структура();</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">  XMLЗапрос.Вставить(</span><span style=" font-family:'Courier New'; font-size:9pt; color:#dd1144; background-color:#f8f8f8;">&quot;XMLTекст&quot;</span><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">, ЗаписьXML.Закрыть());</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">  XMLЗапрос.Вставить(</span><span style=" font-family:'Courier New'; font-size:9pt; color:#dd1144; background-color:#f8f8f8;">&quot;ОтветXDTO&quot;</span><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">, ОтветXDTO);</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">  </span><span style=" font-family:'Courier New'; font-size:9pt; font-weight:600; color:#333333; background-color:#f8f8f8;">Возврат</span><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;"> XMLЗапрос;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; font-weight:600; color:#333333; background-color:#f8f8f8;">КонецФункции</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; font-size:10.5pt; color:#000000;"><br /></span><span style=" font-family:'Verdana,sans-serif'; font-size:10.5pt; color:#000000; background-color:#ffffff;">В итоге получим запрос:</span><span style=" font-family:'Verdana,sans-serif'; font-size:10.5pt; color:#000000;"><br /><br /></span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; font-size:10.5pt; color:#6da3bd;">XML запрос exportOrgRegistryRequest</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; font-size:10.5pt; color:#000000;"><br /></span><span style=" font-family:'Verdana,sans-serif'; font-size:10.5pt; color:#000000; background-color:#ffffff;">Отправим запрос:</span><span style=" font-family:'Verdana,sans-serif'; font-size:10.5pt; color:#000000;"><br /><br /><br /></span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">&amp;НаСервере</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; font-weight:600; color:#333333; background-color:#f8f8f8;">Процедура</span><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;"> </span><span style=" font-family:'Courier New'; font-size:9pt; font-weight:600; color:#990000; background-color:#f8f8f8;">ТестоваяОтправкаНаСервере</span><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">()</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">  </span><span style=" font-family:'Courier New'; font-size:9pt; font-style:italic; color:#999988; background-color:#f8f8f8;">//Узнаем данные по Сбербанку</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">  XMLЗапрос = ПолучитьДанныеОрганизацияПоОГРН(</span><span style=" font-family:'Courier New'; font-size:9pt; color:#dd1144; background-color:#f8f8f8;">&quot;1027700132195&quot;</span><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">);</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">  </span><span style=" font-family:'Courier New'; font-size:9pt; font-style:italic; color:#999988; background-color:#f8f8f8;">//Это тема для другой статья</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">  </span><span style=" font-family:'Courier New'; font-size:9pt; font-style:italic; color:#999988; background-color:#f8f8f8;">//тут мы подписываем пакет данных</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">  </span><span style=" font-family:'Courier New'; font-size:9pt; font-style:italic; color:#999988; background-color:#f8f8f8;">//и отправляем Post запрос на сервис </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">  XMLОтвет = ОтправкаXMLЗапроса(XMLЗапрос);</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">  </span><span style=" font-family:'Courier New'; font-size:9pt; font-weight:600; color:#333333; background-color:#f8f8f8;">Если</span><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;"> XMLОтвет.КодОтвета &lt; </span><span style=" font-family:'Courier New'; font-size:9pt; color:#008080; background-color:#f8f8f8;">299</span><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;"> </span><span style=" font-family:'Courier New'; font-size:9pt; font-weight:600; color:#333333; background-color:#f8f8f8;">Тогда</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">    </span><span style=" font-family:'Courier New'; font-size:9pt; font-style:italic; color:#999988; background-color:#f8f8f8;">//запрос успешен</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">    ОбъектXDTO = ДесериализацияОтвета(XMLОтвет.ИмяФайлРезультата, XMLЗапрос.ОтветXDTO)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">  </span><span style=" font-family:'Courier New'; font-size:9pt; font-weight:600; color:#333333; background-color:#f8f8f8;">КонецЕсли</span><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">; </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; font-weight:600; color:#333333; background-color:#f8f8f8;">КонецПроцедуры</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; font-size:10.5pt; color:#000000;"><br /></span><span style=" font-family:'Verdana,sans-serif'; font-size:10.5pt; color:#000000; background-color:#ffffff;">Ответ от серверов ГИС ЖКХ (СИТ-1):</span><span style=" font-family:'Verdana,sans-serif'; font-size:10.5pt; color:#000000;"><br /><br /></span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; font-size:10.5pt; color:#6da3bd;">XML ответ exportOrgRegistryResult</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; font-size:10.5pt; color:#000000;"><br /></span><span style=" font-family:'Verdana,sans-serif'; font-size:10.5pt; color:#000000; background-color:#ffffff;">Как мы видим, ответ напрямую десериализовать не получится, потому что нет такого типа в предложенных xsd схемах. Нам надо как-то пропустить часть тэгов и обработать только область ответа. На эту тему я тоже не нашел информации, но методом проб и ошибок приходим к кусочку магий:</span><span style=" font-family:'Verdana,sans-serif'; font-size:10.5pt; color:#000000;"><br /><br /><br /></span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">&amp;НаСервереБезКонтекста</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; font-weight:600; color:#333333; background-color:#f8f8f8;">Функция</span><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;"> </span><span style=" font-family:'Courier New'; font-size:9pt; font-weight:600; color:#990000; background-color:#f8f8f8;">ДесериализацияОтвета</span><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">(ПутьКФайлу, ОтветXDTO)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">  </span><span style=" font-family:'Courier New'; font-size:9pt; font-style:italic; color:#999988; background-color:#f8f8f8;">//Откроем файл</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">  Чтение = новый ЧтениеXML;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">  Чтение.ОткрытьФайл(ПутьКФайлу, , , </span><span style=" font-family:'Courier New'; font-size:9pt; color:#dd1144; background-color:#f8f8f8;">&quot;UTF-8&quot;</span><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">); </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">  </span><span style=" font-family:'Courier New'; font-size:9pt; font-style:italic; color:#999988; background-color:#f8f8f8;">//Начинаем пропускать все служебное заголовки, тело ищем наш тэг ответа</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">  </span><span style=" font-family:'Courier New'; font-size:9pt; font-weight:600; color:#333333; background-color:#f8f8f8;">Пока</span><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;"> Чтение.Прочитать() </span><span style=" font-family:'Courier New'; font-size:9pt; font-weight:600; color:#333333; background-color:#f8f8f8;">Цикл</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">    </span><span style=" font-family:'Courier New'; font-size:9pt; font-weight:600; color:#333333; background-color:#f8f8f8;">Если</span><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;"> Чтение.ЛокальноеИмя = ОтветXDTO.СвойствоXDTO.Имя </span><span style=" font-family:'Courier New'; font-size:9pt; font-weight:600; color:#333333; background-color:#f8f8f8;">Тогда</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">      </span><span style=" font-family:'Courier New'; font-size:9pt; font-style:italic; color:#999988; background-color:#f8f8f8;">//т.к. вы спозиционировались на нужном место можно десериализовать данные. Магия</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">      ОбъектXDTO = ФабрикаXDTO.ПрочитатьXML(Чтение, ОтветXDTO.СвойствоXDTO.Тип); </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">      </span><span style=" font-family:'Courier New'; font-size:9pt; font-weight:600; color:#333333; background-color:#f8f8f8;">КонецЕсли</span><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">; </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">  </span><span style=" font-family:'Courier New'; font-size:9pt; font-weight:600; color:#333333; background-color:#f8f8f8;">КонецЦикла</span><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;">  </span><span style=" font-family:'Courier New'; font-size:9pt; font-weight:600; color:#333333; background-color:#f8f8f8;">Возврат</span><span style=" font-family:'Courier New'; font-size:9pt; color:#333333; background-color:#f8f8f8;"> ОбъектXDTO;</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:9pt; font-weight:600; color:#333333; background-color:#f8f8f8;">КонецФункции</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; font-size:10.5pt; color:#000000;"><br /></span><span style=" font-family:'Verdana,sans-serif'; font-size:10.5pt; color:#000000; background-color:#ffffff;">В итоге работать можно с очень сложными xsd схемами через стандартные инструменты платформы. В целом 1С контролируют типизацию и заполнения, бывает чересчур излишне, особенно когда внутри свойства пакета используется базовый тип другого пакета, но в любом случае тип нужно привести к локальному из-за другого пространства URI. Удобно работать с десериализоваными данными, так как там всю работу на себя берет платформа. Но проверки происходят на этапе выполнения, а при написания кода платформа 1С не предоставляет никаких подсказок и проходится пользоваться сторонними утилитами, и даже при выполнении большая часть элементов находится в состоянии «Неопределено» и даже тип или его свойство можно увидеть только в спецификации.</span><span style=" font-family:'MS Shell Dlg 2'; font-size:8.25pt;"> </span></p></body></html>