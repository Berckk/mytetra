<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#4682b4;">Про циклы в одну строку</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Первым номером нашей программы выступает код добавления (копирования) строк из одной таблицы значений в другую ТЗ или из одной табличной части в другую ТЧ. Ну, и т.д. Т.е. строки из обоих источников объединяются, совпадающие по имени колонки заполняются.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">Для каждого </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">СтрокаТЗ </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">Из </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Таблица1 </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">Цикл </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ЗаполнитьЗначенияСвойств</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Таблица2</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Добавить</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(), </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">СтрокаТЗ</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">) КонецЦикла;<br /></span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"><br />Соответственно код добавления элементов из массива в массив будет такой.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">Для каждого </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ЭлементМассива </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">Из </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Массив1 </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">Цикл </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Массив2</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Добавить</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ЭлементМассива</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">) КонецЦикла;<br /></span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"><br />Всего одна команда в цикле - что может быть проще?</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Наверное, вы уже обратили внимание на запись циклов в одну строку. Так программный код выполняется несколько быстрее. Всё дело в том, что в строках есть дополнительные данные, которые используются, например, при отладке. Меньше строк - меньше дополнительных данных. Это прекрасно видно, если смотреть замер производительности в режиме отладки - цикл в строке</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'courier new,courier'; font-size:8.25pt; color:#ff0000;">Для</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> из 10000 повторов записанный обычной структурой будет выполнен 10001 раз, а записанный в 1 строку будет выполнен 1 раз. Разумеется, что при этом результат выполнения программного кода будет абсолютно одинаковый, а вот время выполнения будет разное. Не верится? Смотрим </span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#333333;">&quot;Пример 1&quot;</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;">.<br /></span><a href="http://www.infostart.ru/public/download.php?file=71179"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">Скачать Пример 1...</span></a></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Следует заметить, что править такую форму записи очень сложно. Поэтому, если команды отрабатываются 1 раз, то нет особого смысла записывать их в 1 строку друг за другом.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Также &quot;тонким&quot; моментом будет использование команды</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'courier new,courier'; font-size:8.25pt; color:#0000ff;">ОбработкаПрерыванияПользователя</span><span style=" font-family:'courier new,courier'; font-size:8.25pt; color:#ff0000;">()</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;">. Если в цикле, записанном в 1 строку, используется данная команда, то вероятность срабатывания прерывания выполнения программы по Ctrl+Break становится не четким. Ну, может за исключением тех случаев, когда в цикле кроме этой других команд нет. </span><img src="image6108.png" /></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Хочу сразу обратить ваше внимание на комментарии</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> </span><a href="http://www.infostart.ru/profile/13819/"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">awa</span></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> к этой статье. Всё сразу станет понятнее.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Обработку для сворачивания программного кода в 1 строку можно скачать</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> </span><a href="http://infostart.ru/public/download.php?file=94068"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">здесь</span></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;">.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a href="http://infostart.ru/public/71130/?ID=71130&amp;PAGEN_1=5#Oglavlenie"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">Вернуться к оглавлению...</span></a></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#4682b4;"><br /></span><a name="Pro_bystrye_massivy"></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#4682b4;">П</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#4682b4;">ро быстрые массивы</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Теперь посмотрим что-нибудь простенькое. Например, разбор строки с разделителями в массив элементов. В типовых конфигурациях есть функция</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'courier new,courier'; font-size:8.25pt; color:#0000ff;">РазложитьСтрокуВМассивПодстрок</span><span style=" font-family:'courier new,courier'; font-size:8.25pt; color:#ff0000;">()</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;">. Предлагаю рассмотреть альтернативное решение. Вот код для строковых значений.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'courier new,courier'; font-size:8pt; color:#008000;">// РазбираемаяСтрока - строка исходного текста<br />// Разделитель - разделитель элементов строки<br /></span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ЗначениеИзСтрокиВнутр</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">&quot;{&quot;&quot;#&quot;&quot;,51e7a0d2-530b-11d4-b98a-008048da3034,{0,{&quot;&quot;S&quot;&quot;,&quot;&quot;&quot; </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">+ </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">СтрЗаменить</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">СтрЗаменить</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">РазбираемаяСтрока</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">,</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">&quot;&quot;&quot;&quot;</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">, </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">&quot;&quot;&quot;&quot;&quot;&quot;</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">), </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Разделитель</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">, </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">&quot;&quot;&quot;},{&quot;&quot;S&quot;&quot;,&quot;&quot;&quot;</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">) + </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">&quot;&quot;&quot;}}}&quot;</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">);<br /></span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"><br />Вот код для числовых значений.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff; background-color:#ffffff;">ЗначениеИзСтрокиВнутр</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">&quot;{&quot;&quot;#&quot;&quot;,51e7a0d2-530b-11d4-b98a-008048da3034,{0,{&quot;&quot;N&quot;&quot;,&quot; </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">+ </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">СтрЗаменить</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">РазбираемаяСтрока</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">, </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Разделитель</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">, </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">&quot;},{&quot;&quot;N&quot;&quot;,&quot;</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">) + </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">&quot;}}}&quot;</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">);<br /></span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"><br />Посмотреть, как это работает можно </span><a href="http://www.infostart.ru/public/69707/"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">здесь</span></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;">, </span><a href="http://www.infostart.ru/public/19856/"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">здесь</span></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> и </span><a href="http://www.infostart.ru/public/71130/files/"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">здесь</span></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;">.<br />В </span><a href="http://forum.infostart.ru/forum24/topic33723/message396076/#message396076"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">(150)</span></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> комментарии к статье было высказано предположение, что данный метод не эффективен, поэтому был добавлен </span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#333333;">&quot;Пример 7&quot;</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;">. Действительно, на коротких строках предложенное в </span><a href="http://forum.infostart.ru/forum24/topic33723/message396076/#message396076"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">(150)</span></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> комментарии решение с разбором строки эффективнее, но сложнее в исполнении. Ещё более эффективное решение и ещё более сложное в исполнении </span><img src="image6108.png" /><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> читаем </span><a href="http://infostart.ru/public/71130/?ID=71130&amp;PAGEN_1=5#Komment_302"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">ниже...</span></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"><br /></span><a href="http://www.infostart.ru/public/download.php?file=77187"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">Скачать Пример 7...</span></a></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;"> </span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Так, так, так. А вот довольно шустренький программный код для сворачивания элементов массива. Результат записывается в НовыйМассив.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff; background-color:#ffffff;">НовыйМассив</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;"> </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= Новый </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Массив</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">; </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Соответствие </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= Новый </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Соответствие</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">;<br />Для каждого </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ЭлементМассива </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">Из </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Массив </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">Цикл </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Соответствие</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Вставить</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ЭлементМассива</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">) КонецЦикла;<br />Для каждого </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">КлючИЗначение </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">Из </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Соответствие </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">Цикл </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">НовыйМассив</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Добавить</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">КлючИЗначение</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Ключ</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">) КонецЦикла;<br /></span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"><br />Для сравнения в </span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#333333;">&quot;Пример 4&quot;</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> приведено 4 варианта реализации сворачивания массива: через массив, через таблицу значений, через соответствие и вариант, реализованный в типовых конфигурациях 1С. Поэкспериментируйте и выберите тот, что вам больше понравится.<br /></span><a href="http://www.infostart.ru/public/download.php?file=71303"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">Скачать Пример 4...</span></a></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;"> </span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Если вдруг понадобится отсортировать элементы в массиве, то быстро это можно сделать так:</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff; background-color:#ffffff;">СписокЗначений</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;"> </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= Новый </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">СписокЗначений</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">;<br /></span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">СписокЗначений</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ЗагрузитьЗначения</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Массив</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">);<br /></span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">СписокЗначений</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">СортироватьПоЗначению</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">();<br /></span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Массив </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">СписокЗначений</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ВыгрузитьЗначения</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">();</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">В некоторых случаях больше подойдет сортировка не по значению, а по представлению.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a href="http://infostart.ru/public/71130/?ID=71130&amp;PAGEN_1=5#Oglavlenie"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">Вернуться к оглавлению...</span></a></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#4682b4;"><br /></span><a name="Pro_dlinnye_stroki"></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#4682b4;">П</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#4682b4;">ро длинные строки</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Получить строку из пробелов нужной длины можно собирая пробелы в цикле. Но можно использовать следующую конструкцию:</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'courier new,courier'; font-size:8pt; color:#008000;">// Получаем строку пробелов длиной 10000 символов<br /></span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">СтрокаПробелов </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">СтрЗаменить</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Формат</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">0</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">, </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">&quot;ЧЦ=100; ЧН=; ЧВН=; ЧГ=&quot;</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">), </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">&quot;0&quot;</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">,<br />                 </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">СтрЗаменить</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Формат</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">0</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">, </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">&quot;ЧЦ=100; ЧН=; ЧВН=; ЧГ=&quot;</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">), </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">&quot;0&quot;</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">, </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">&quot; &quot;</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">));</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;"> </span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"><br />Интересное наблюдение при работе со строками большой длины можно сделать в </span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#333333;">&quot;Пример 5&quot;</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;">. Использование трехуровневой буферизации может дать ускорение в десятки и даже тысячи раз. Код может выглядеть так:</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff; background-color:#ffffff;">Данные</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;"> </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">&quot;&quot;</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">;<br /></span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Результат </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">&quot;&quot;</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">;<br /></span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Результат1 </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">&quot;&quot;</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">;<br /></span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Результат2 </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">&quot;&quot;</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">;<br /></span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#008000;">// Получаем Данные и записываем в Результат<br /></span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">Пока </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ПолучитьДанные</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Данные</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">) Цикл<br />    </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Результат2 </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Результат2 </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">+ </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Данные</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">;<br />    Если </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">СтрДлина</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Результат2</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">) &gt; </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">100 </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">Тогда<br />        </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Результат1 </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Результат1 </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">+ </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Результат2</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">;<br />        </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Результат2 </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">&quot;&quot;</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">;<br />        Если </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">СтрДлина</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Результат1</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">) &gt; </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">10000 </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">Тогда<br />            </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Результат </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Результат </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">+ </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Результат1</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">;<br />            </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Результат1 </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">&quot;&quot;</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">;<br />        КонецЕсли;<br />    КонецЕсли;<br />КонецЦикла;<br /></span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Результат </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Результат </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">+ </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Результат1 </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">+ </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Результат2</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">;<br /></span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"><br />Конечно, и здесь цикл можно записать в одну строку, но это не сделано только для сохранения читаемости программного кода в статье.<br /></span><a href="http://www.infostart.ru/public/download.php?file=71606"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">Скачать Пример 5...</span></a></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a name="Komment_302"></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;">В</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> </span><a href="http://forum.infostart.ru/forum24/topic33723/message499665/#message499665"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">(302)</span></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> комментарии к статье приведен интересный код для разбора длинных текстовых строк, позволяющий проводить предварительную обработку данных, например, перед помещением их в массив. Применительно к задаче помещения данных в массив на больших объемах данных он работает конечно медленнее, чем код описанный в разделе </span><a href="http://infostart.ru/public/71130/?ID=71130&amp;PAGEN_1=5#Pro_bystrye_massivy"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">Про быстрые массивы</span></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;">, но возможность предварительной обработки данных дорогого стоит. Предлагаю рассмотреть альтернативное решение без использования объекта ТекстовыйДокумент. Оно конечно сложнее в исполнении, но эффективнее в работе и также позволяет добавить предварительную обработку данных, например, перед помещением их в массив.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff; background-color:#ffffff;">ДлинаСтроки</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;"> </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">СтрДлина</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">РазбираемаяСтрока</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">);<br /><br />Если </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ДлинаСтроки </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">&gt; </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">1000 </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">Тогда<br />    </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#008000;">// Порежем строку на блоки для более эффективного поиска<br />    </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">МассивСтрок </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= Новый </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Массив</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">;<br />    </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Индекс </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">1</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">;<br />    Пока </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Индекс </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">&lt;= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ДлинаСтроки </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">Цикл<br />        </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">МассивСтрок</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Добавить</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Сред</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">РазбираемаяСтрока</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">, </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Индекс</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">, </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">1000</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">));<br />        </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Индекс </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Индекс </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">+ </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">1000</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">;<br />    КонецЦикла;<br /><br />    </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">мИсходныйКод </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">МассивСтрок</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">[</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">0</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">];<br />    </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ГраницаКода </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">МассивСтрок</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ВГраница</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">();<br />Иначе<br />    </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">мИсходныйКод </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">РазбираемаяСтрока</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">;<br />    </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ГраницаКода </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">0</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">;<br />КонецЕсли;<br /><br /></span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">мСтрок </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= Новый </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Массив</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">;<br /></span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ИндексКода </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">0</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">;<br /></span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ДлинаРазделителя </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">СтрДлина</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Разделитель</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">);<br /></span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">НеПоследняяСтрока </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= Истина;<br /><br />Пока </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">НеПоследняяСтрока </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">Цикл<br />    </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Позиция </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Найти</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">мИсходныйКод</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">, </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Разделитель</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">);<br />    Пока </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Позиция </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">0 </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">Цикл<br />        Если </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ИндексКода </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ГраницаКода </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">Тогда<br />            </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#008000;">// Последний элемент<br />            </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Позиция </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">СтрДлина</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">мИсходныйКод</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">);<br />            </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">НеПоследняяСтрока </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= Ложь;<br />            Прервать;<br />        КонецЕсли;<br /><br />        </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ИндексКода </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ИндексКода </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">+ </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">1</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">;<br />        </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">мИсходныйКод </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">мИсходныйКод </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">+ </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">МассивСтрок</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">[</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ИндексКода</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">];<br />        </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Позиция </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Найти</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">мИсходныйКод</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">, </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Разделитель</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">);<br />    КонецЦикла;<br /><br />    </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">мСтрок</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Добавить</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Лев</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">мИсходныйКод</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">, </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Позиция</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">));<br />    </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">мИсходныйКод </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Сред</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">мИсходныйКод</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">, </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Позиция </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">+ </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ДлинаРазделителя</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">);<br />КонецЦикла;<br /><br />Возврат </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">мСтрок</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">;</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"><br />Посмотреть как это работает можно </span><a href="http://www.infostart.ru/public/download.php?file=77187"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">здесь</span></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> и </span><a href="http://infostart.ru/public/19856/"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">здесь</span></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;">.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;"> </span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Если вы подумали, что эта статья только об оптимизации производительности, то это не так. Статья об оптимизации производительности</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> </span><a href="http://www.infostart.ru/public/18924/"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">здесь</span></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;">, и не смотря на то, что статья посвящена 7.7, многие приемы оптимизации работают и в 8.х.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a href="http://infostart.ru/public/71130/?ID=71130&amp;PAGEN_1=5#Oglavlenie"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">Вернуться к оглавлению...</span></a></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#4682b4;"><br /></span><a name="Pro_tipy_dannyh_Dinamicheskaya_nastroika_kolonok_tablichnogo_polya"></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#4682b4;">П</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#4682b4;">ро типы данных. Динамическая настройка колонок табличного поля</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Иногда бывает нужно проверить тип данных какого-либо ревизита. Для типов данных без квалификаторов проверку типа данных легко сделать с помощью</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'courier new,courier'; font-size:8.25pt; color:#0000ff;">ОписаниеТипов</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;">. А вот для типов данных Число, Строка и Дата можно использовать другую конструкцию с использованием массива типов. Вот пример для динамической настройки табличного поля. В примере использованы оба способа сравнения типов.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff; background-color:#ffffff;">ТипЧисло</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;"> </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Тип</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">&quot;Число&quot;</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">);<br /></span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ОписаниеТипаБулево </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= Новый </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ОписаниеТипов</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">&quot;Булево&quot;</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">);<br /><br /></span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">мВыводитьПодвал </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= Ложь;<br /></span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ТабличноеПоле</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">СоздатьКолонки</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">();<br /></span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">КолонкиИсточника </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ТабличноеПоле</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Значение</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Колонки</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">;<br /><br /></span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#008000;">// Отобразим булево как галочки, а отрицательные числа красным<br /></span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">Для каждого </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">КолонкаТЧ </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">Из </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ТабличноеПоле</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Колонки </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">Цикл<br />    </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ИмяКолонкиТЧ </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">КолонкаТЧ</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Имя</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">;<br />    </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ТипЗначенияКолонки </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">КолонкиИсточника</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">[</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ИмяКолонкиТЧ</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">].</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ТипЗначения</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">;<br />    Если </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ТипЗначенияКолонки </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ОписаниеТипаБулево </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">Тогда<br />        </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">КолонкаТЧ</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ДанныеФлажка </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">КолонкаТЧ</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Данные</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">;<br />        </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">КолонкаТЧ</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Данные </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">&quot;&quot;</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">;<br />    ИначеЕсли </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ИмяКолонкиТЧ </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">&lt;&gt; </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">&quot;НомерСтроки&quot; </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">Тогда<br />        </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">МассивТипов </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ТипЗначенияКолонки</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Типы</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">();<br />        Если </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">МассивТипов</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Количество</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">() = </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">1 </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">и </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">МассивТипов</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">[</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">0</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">] = </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ТипЧисло </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">Тогда<br />            </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">КолонкаТЧ</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ВыделятьОтрицательные </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= Истина;<br />            </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">КолонкаТЧ</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ОтображатьИтогиВПодвале </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= Истина;<br />            </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">КолонкаТЧ</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ГоризонтальноеПоложениеВПодвале </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ГоризонтальноеПоложение</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Право</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">;<br />            </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">мВыводитьПодвал </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= Истина;<br />        КонецЕсли;<br />    КонецЕсли;<br />КонецЦикла;<br /></span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ТабличноеПоле</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Подвал </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">мВыводитьПодвал</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">;</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"><br />К вопросу &quot;Почему не воспользоваться методом </span><span style=" font-family:'courier new,courier'; font-size:8.25pt; color:#0000ff;">СодержитТип</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;">?&quot;. Метод </span><span style=" font-family:'courier new,courier'; font-size:8.25pt; color:#0000ff;">СодержитТип</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> не дает однозначного ответа на вопрос &quot;Какой тип реквизита?&quot;. Он только подтверждает, что реквизит может быть, например, числом. А если реквизит составного типа?</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Как это работает можно посмотреть</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> </span><a href="http://infostart.ru/public/69707/"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">здесь</span></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;">.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a href="http://infostart.ru/public/71130/?ID=71130&amp;PAGEN_1=5#Oglavlenie"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">Вернуться к оглавлению...</span></a></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#4682b4;"><br /></span><a name="Pro_tipy_dannyh_Raschet_summ_po_vydelennym_yacheikam_tablichnogo_polya"></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#4682b4;">П</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#4682b4;">ро типы данных. Расчет сумм по выделенным ячейкам табличного поля</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">В некоторых типовых конфигурациях 1С и публикациях в интернете используется очень удобный сервис</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#333333;">&quot;расчет сумм по выделенным ячейкам табличного поля&quot;</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;">. К сожалению все попавшие на глаза варианты реализации работают &quot;неверно&quot; при подсчете сумм по накладывающимся выделенным областям. При подсчете суммы из ячеек в персекающихся областях учитываются несколько раз.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Предлагаю простенькую функцию, в которой данный &quot;эффект&quot; устранен.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">Функция </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">РасчетСуммыПоЯчейкам</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ТабличноеПоле</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">) Экспорт<br /><br />    </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Сумма </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">0</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">;<br />    </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">КоличествоСумм </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">0</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">;<br />    </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">СоответствиеЯчеек </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= Новый </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Соответствие</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">;<br />    </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ОписаниеТипов </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= Новый </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ОписаниеТипов</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">&quot;Число&quot;</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">);<br /><br />    Для Каждого </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ВыделеннаяОбласть </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">Из </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ТабличноеПоле</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ВыделенныеОбласти </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">Цикл<br />        Для </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Индекс1 </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ВыделеннаяОбласть</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Лево </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">По </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ВыделеннаяОбласть</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Право </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">Цикл<br />            Для </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Индекс2 </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ВыделеннаяОбласть</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Верх </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">По </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ВыделеннаяОбласть</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Низ </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">Цикл<br />                </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Область </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ТабличноеПоле</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Область</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Индекс2</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">, </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Индекс1</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">, </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Индекс2</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">, </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Индекс1</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">);<br />                </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Значение </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ОписаниеТипов</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ПривестиЗначение</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Область</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Текст</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">);<br />                </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">СоответствиеЯчеек</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Вставить</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Область</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Имя</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">, </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Значение</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">);<br />            КонецЦикла;<br />        КонецЦикла;<br />    КонецЦикла;<br /><br />    Для каждого </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Ячейка </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">Из </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">СоответствиеЯчеек </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">Цикл<br />        </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Значение </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Ячейка</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Значение</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">;<br />        Если </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Значение </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">&lt;&gt; </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">0 </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">Тогда<br />            </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Сумма </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Сумма </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">+ </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Значение</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">;<br />            </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">КоличествоСумм </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">КоличествоСумм </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">+ </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">1</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">;<br />        КонецЕсли;<br />    КонецЦикла;<br /><br />    </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">КоличествоВыделено </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">СоответствиеЯчеек</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Количество</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">();<br />    Если </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">КоличествоВыделено </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">&gt; </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">1 </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">Тогда<br />        </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ТекстИтогов </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">&quot; Выделено ячеек: &quot; </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">+ </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">КоличествоВыделено<br />            </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">+ </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">&quot;    Просуммировано ячеек: &quot; </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">+ </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">КоличествоСумм<br />            </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">+ </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">&quot;    Итого по выделенным ячейкам: &quot; </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">+ </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Сумма</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">;<br />    Иначе<br />        </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ТекстИтогов </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">&quot;&quot;</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">;<br />    КонецЕсли;<br /><br />    Возврат </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ТекстИтогов</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">;<br /><br />КонецФункции </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#008000;">// РасчетСуммыПоЯчейкам()<br /></span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"><br />Использование метода </span><span style=" font-family:'courier new,courier'; font-size:8.25pt; color:#0000ff;">ПривестиЗначение</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> вместо встречающегося в типовых конфигурациях преобразования через </span><span style=" font-family:'courier new,courier'; font-size:8.25pt; color:#ff0000;">Попытка</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;">, дает в среднем ускорение на преобразовании типов в 4 раза. А использование отложенного вызова функции расчета суммы всего лишь на 0.2 секунды с легкостью решает проблему с задержками при выделении пользователем большого количества ячеек.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Посмотреть как это работает можно</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> </span><a href="http://infostart.ru/public/69707/"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">здесь</span></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> и </span><a href="http://infostart.ru/public/84642/"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">здесь</span></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;">.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Ещё про работу с типами данных можно почитать</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> </span><a href="http://infostart.ru/public/71130/?ID=71130&amp;PAGEN_1=5#Pro_tablicu_znachenii"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">ниже...</span></a></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a href="http://infostart.ru/public/71130/?ID=71130&amp;PAGEN_1=5#Oglavlenie"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">Вернуться к оглавлению...</span></a></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#4682b4;"><br /></span><a name="Pro_hitrye_zaprosy_Ne_standartnoe_ispolzovanie_itogov"></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#4682b4;">П</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#4682b4;">ро хитрые запросы. Не стандартное использование итогов</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">А что сейчас? А сейчас запросы. Не все конечно, а несколько каких-нибудь простеньких и интересненьких. Например, построение запросом двухуровневого дерева структуры задолженности для формы элемента справочника Контрагенты. Исходим из того, что чем меньше команд, тем быстрее работает. Ну, обычно быстрее. Ведь 1С это все-таки интерпретатор.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Итак, строим запросом дерево по структуре задолженности как на картинке ниже, смотрим закладку Задолженность. На закладке добавлено табличное поле с деревом значений Задолженность.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><img src="image15525.png" /></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Получаем в детальных строках договоры контрагентов, а в итоговых строках организации. Приведенный ниже в качестве примера программный код будет работать в УТ и УПП. Для остальных конфигураций код запроса нужно немного подправить.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff; background-color:#ffffff;">Запрос</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;"> </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= Новый </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Запрос</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(<br />    </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">&quot;ВЫБРАТЬ РАЗРЕШЕННЫЕ<br />    | ДоговорыКонтрагентов.Организация КАК Организация,<br />    | ДоговорыКонтрагентов.Ссылка КАК СтруктураДоговоров,<br />    | -ЕСТЬNULL(ВзаиморасчетыОстатки.СуммаВзаиморасчетовОстаток, 0) КАК Сумма<br />    |ИЗ<br />    | Справочник.ДоговорыКонтрагентов КАК ДоговорыКонтрагентов<br />    |  ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.ВзаиморасчетыСКонтрагентами.Остатки(<br />    |       , Контрагент = &amp;Контрагент) КАК ВзаиморасчетыОстатки<br />    |  ПО ДоговорыКонтрагентов.Ссылка = ВзаиморасчетыОстатки.ДоговорКонтрагента<br />    |ГДЕ<br />    | ДоговорыКонтрагентов.Владелец = &amp;Контрагент<br />    |<br />    |УПОРЯДОЧИТЬ ПО<br />    | Организация,<br />    | СтруктураДоговоров<br />    |ИТОГИ<br />    | Организация КАК СтруктураДоговоров,<br />    | СУММА(Сумма)<br />    |ПО<br />    | Организация&quot;</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">);<br /></span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Запрос</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">УстановитьПараметр</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">&quot;Контрагент&quot;</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">, </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Ссылка</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">);<br /></span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Задолженность </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Запрос</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Выполнить</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">().</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Выгрузить</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ОбходРезультатаЗапроса</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ПоГруппировкам</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">);<br /></span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"><br />Получилось простенько и симпатично.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">В итогах Организация используется без агрегатной функции - это возможно потому, что по Организации выполняется группировка. Ещё примеры построения двухуровневого дерева можно посмотреть</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> </span><a href="http://www.infostart.ru/public/69707/"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">здесь</span></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;">.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a href="http://infostart.ru/public/71130/?ID=71130&amp;PAGEN_1=5#Oglavlenie"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">Вернуться к оглавлению...</span></a></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#4682b4;"><br /></span><a name="Pro_hitrye_zaprosy_Teta_soedineniya_1"></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#4682b4;">П</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#4682b4;">ро хитрые запросы. Тэта-соединения 1</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Кажется тема с запросами получилась интересной. Тогда ещё один примерчик</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#333333;">&quot;Пример 2&quot;</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;">, который можно подержать в руках - изменение курсов валют с группировкой по месяцам.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;"> </span><img src="image16734.png" /></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff; background-color:#ffffff;">Запрос</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;"> </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= Новый </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Запрос</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(<br />    </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">&quot;ВЫБРАТЬ РАЗРЕШЕННЫЕ<br />    |   КурсыВалют.Период КАК Период1,<br />    |   МАКСИМУМ(ЕСТЬNULL(КурсыВалют1.Период, КурсыВалют.Период)) КАК Период2<br />    |ПОМЕСТИТЬ Соединения<br />    |ИЗ<br />    |   РегистрСведений.КурсыВалют КАК КурсыВалют<br />    |       ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КурсыВалют КАК КурсыВалют1<br />    |       ПО КурсыВалют.Валюта = КурсыВалют1.Валюта<br />    |           И КурсыВалют.Период &gt; КурсыВалют1.Период<br />    |           И (КурсыВалют1.Валюта = &amp;Валюта)<br />    |ГДЕ<br />    |   КурсыВалют.Валюта = &amp;Валюта<br />    |<br />    |СГРУППИРОВАТЬ ПО<br />    |   КурсыВалют.Период<br />    |;<br />    |<br />    |////////////////////////////////////////////////////////////////////////////////<br />    |ВЫБРАТЬ РАЗРЕШЕННЫЕ<br />    |   КурсыВалют.Период КАК Период,<br />    |   НАЧАЛОПЕРИОДА(КурсыВалют.Период, МЕСЯЦ) КАК ПериодДляИтогов,<br />    |   КурсыВалют.Курс,<br />    |   КурсыВалют.Курс - КурсыВалют1.Курс КАК ИзменениеКурса<br />    |ИЗ<br />    |   РегистрСведений.КурсыВалют КАК КурсыВалют<br />    |       ВНУТРЕННЕЕ СОЕДИНЕНИЕ Соединения КАК Соединения<br />    |           ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.КурсыВалют КАК КурсыВалют1<br />    |           ПО Соединения.Период2 = КурсыВалют1.Период<br />    |               И (КурсыВалют1.Валюта = &amp;Валюта)<br />    |       ПО КурсыВалют.Период = Соединения.Период1<br />    |           И (КурсыВалют.Валюта = &amp;Валюта)<br />    |ИТОГИ<br />    |   ПериодДляИтогов КАК Период,<br />    |   СУММА(ИзменениеКурса)<br />    |ПО<br />    |   ПериодДляИтогов&quot;</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">);<br /></span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Запрос</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">УстановитьПараметр</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">&quot;Валюта&quot;</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">, </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Валюта</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">);<br /></span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">КурсыВалют </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Запрос</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Выполнить</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">().</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Выгрузить</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ОбходРезультатаЗапроса</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ПоГруппировкам</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">);</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;"> </span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"><br />Аналогично можно построить и другие запросы, в которых отслеживается изменение значений показателей, например, изменение цен.<br /></span><a href="http://www.infostart.ru/public/download.php?file=71272"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">Скачать Пример 2...</span></a></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a href="http://infostart.ru/public/71130/?ID=71130&amp;PAGEN_1=5#Oglavlenie"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">Вернуться к оглавлению...</span></a></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#4682b4;"><br /></span><a name="Pro_hitrye_zaprosy_Teta_soedineniya_2"></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#4682b4;">П</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#4682b4;">ро хитрые запросы. Тэта-соединения 2</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">&quot;Продолжаем разговор&quot;. В качестве ещё одного примера работы с запросами добавлен</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#333333;">&quot;Пример 3&quot;</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;">, в котором реализовано получение периодов действия установленных значений периодических регистров сведений. Перечитал предыдущее предложение - получилось немного тяжеловато, ну, да ладно. Предложенное решение в </span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#333333;">&quot;Пример 3&quot;</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;">может быть использовано, например, при решении задач по расчету заработной платы или при начислениях в ЖКХ.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><img src="image28778.png" /></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Фишка этого запроса в том, чтобы убрать повторяющиеся данные из цепочки, а оставить только точки перехода с датами, когда данный переход был выполнен.</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> <br />Т.е. для цепочки значений </span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#000080;">0</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#000080;">, </span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#000080;">0</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#000080;">, </span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#000080;">1</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#000080;">, </span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#000080;">1</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#000080;">, </span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#000080;">1</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#000080;">, </span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#000080;">0</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#000080;">, </span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#000080;">0</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#000080;">, </span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#000080;">0</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#000080;">, </span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#000080;">1</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> <br />должны остаться только значения </span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#008000;">0</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#008000;">, </span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#008000;">1</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#008000;">, </span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#008000;">0</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#008000;">, </span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#008000;">1</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> и соответственно даты, когда значения в цепочке поменялись.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">И несколько слов об оптимизации тэта-соединений. Во вложении 3 варианта реализации с использованием запросов, поэтому в статье текстов этих запросов нет - очень объемно получается. При больших объемах информации оптимизированный вариант запросов дает значительное ускорение, особенно в файловой версии. Это собственно и не удивительно, оптимизатор SQL сервера делает своё дело. Автором одного из вариантов является</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> </span><a href="http://www.infostart.ru/profile/53661/"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">Ish_2</span></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> - это вариант &quot;Гостинец&quot;.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a href="http://www.infostart.ru/public/download.php?file=71302"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">Скачать Пример 3 без оптимизации...</span></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"><br /></span><a href="http://www.infostart.ru/public/download.php?file=71363"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">Скачать Пример 3 с оптимизацией...</span></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"><br /></span><a href="http://www.infostart.ru/public/download.php?file=71607"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">Скачать Гостинец от Ish_2...</span></a></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Суть оптимизации сводится к уменьшению количества записей используемых в соединениях, аналогами которых являются нарастающие итоги. Подробнее про подобный подход можно почитать</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> </span><a href="http://www.infostart.ru/public/61295/"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">здесь</span></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;">.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Также интересный эффект получается при использовании индексов для временных таблиц. Попробуйте поиграть с объемами данных и галочками &quot;Использовать индексы в запросе&quot;. Обещаю весьма неожиданный результат.</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> </span><img src="image6108.png" /></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Так уж получилось, что большинство комментариев к данной статье посвящено именно этому запросу. Видимо в нем есть тайное знание доступное теперь всем желающим.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Ещё про запросы можно посмотреть</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> </span><a href="http://www.infostart.ru/public/16630/"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">здесь</span></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;">, а про запросы с датами можно посмотреть </span><a href="http://www.infostart.ru/public/68269/"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">здесь</span></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;">.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a href="http://infostart.ru/public/71130/?ID=71130&amp;PAGEN_1=5#Oglavlenie"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">Вернуться к оглавлению...</span></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> </span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#4682b4;"><br /></span><a name="Pro_hitrye_zaprosy_Teta_soedineniya_3"></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#4682b4;">П</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#4682b4;">ро хитрые запросы. Тэта-соединения 3. Строки неограниченной длины</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Делал загрузку прайсов из Excel. Если прайс и справочник Номенклатура маленькие, то конечно всё работает сравнительно быстро. Несколько секунд и сопоставление выполнено вне зависимости от того выполняется ли поиск в одном запросе или используется поиск по реквизитам справочника в цикле. Но в моём случае и справочник и прайс содержат десятки тысяч позиций. Всё бы ничего, но уж очень медленно получается при поиске соответствий Номенклатуры по полному наименованию.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Постановка задачи: найти элементы справочника Номенклатура, полное наименование которых совпадает с наименованием в прайсе поставщика. При больших объемах данных решение напрашивается само собой - использовать запрос.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Не буду долго рассуждать о поиске варианта решения. Сразу покажу запрос, который показал себя наиболее эффективным. ТаблицаДляПоиска это таблица значений, в которой 1 колонка заполненная значениями, загруженными из прайса.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff; background-color:#ffffff;">Запрос</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;"> </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= Новый </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Запрос</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(<br />    </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">&quot;ВЫБРАТЬ<br />    |   ПОДСТРОКА(ТаблицаДляПоиска.НоменклатураXLS, 1, 40) КАК НоменклатураXLS_Индекс,<br />    |   ТаблицаДляПоиска.НоменклатураXLS КАК НоменклатураXLS<br />    |ПОМЕСТИТЬ ТаблицаДляПоиска<br />    |ИЗ<br />    |   &amp;ТаблицаДляПоиска КАК ТаблицаДляПоиска<br />    |<br />    |ИНДЕКСИРОВАТЬ ПО<br />    |   НоменклатураXLS_Индекс<br />    |;<br />    |<br />    |////////////////////////////////////////////////////////////////////////////////<br />    |ВЫБРАТЬ<br />    |   СправочникНоменклатура.Ссылка КАК Номенклатура,<br />    |   СправочникНоменклатура.НаименованиеПолное КАК НоменклатураНаименование<br />    |ИЗ<br />    |   Справочник.Номенклатура КАК СправочникНоменклатура<br />    |       ВНУТРЕННЕЕ СОЕДИНЕНИЕ ТаблицаДляПоиска КАК ТаблицаДляПоиска<br />    |       ПО ПОДСТРОКА(СправочникНоменклатура.НаименованиеПолное, 1, 40) = ТаблицаДляПоиска.НоменклатураXLS_Индекс<br />    |           И ПОДСТРОКА(СправочникНоменклатура.НаименованиеПолное, 1, 1000) = ТаблицаДляПоиска.НоменклатураXLS<br />    |ГДЕ<br />    |   СправочникНоменклатура.ЭтоГруппа = ЛОЖЬ<br />    |   И СправочникНоменклатура.Услуга = ЛОЖЬ&quot;</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">);<br /><br /></span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Запрос</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">УстановитьПараметр</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">&quot;ТаблицаДляПоиска&quot;</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">, </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ТаблицаДляПоиска</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">);<br /></span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">РезультатЗапроса </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Запрос</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Выполнить</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">();</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Решение лежало на поверхности. Правда?</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a href="http://infostart.ru/public/71130/?ID=71130&amp;PAGEN_1=5#Oglavlenie"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">Вернуться к оглавлению...</span></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> </span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#4682b4;"><br /></span><a name="Pro_paketnye_zaprosy_Indeksy_vo_vremennyh_tablicah"></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#4682b4;">П</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#4682b4;">ро пакетные запросы. Индексы во временных таблицах</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Сегодня с утра была пятница. Пришло время открыть великую тайну-у-у-у.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">В пакетных запросах в качестве источника данных часто выступает временная таблица. У временной таблицы есть возможность создавать индексы. В каких случаях создание индекса может ускорить выполнение запроса, а в каких наоборот?</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Начнем с того, что посмотрим, когда не нужно создавать индексы. Ведь на создание индекса тратится время и ресурсы. Если индекс не будет использоваться, то его создание только замедлит выполнение запроса. Нет смысла создавать индексы, если временная таблица очень маленькая. Нет смысла создавать индексы, если временная таблица соединяется с другой таблицей по полям, которые во второй таблице уже проиндексированы.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Так когда же имеет смысл создавать индексы? Оказывается всё очень просто. Индексы имеет смысл создавать в случае, если выполняется условие сравнения на равенство. В качестве примера можно посмотреть запрос в предыдущем пункте Заметочек. Там как раз используется индекс именно в подобной ситуации.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Возможно со временем индексы будут использоваться и при других вариантах сравнения. Поживем, увидим.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a href="http://infostart.ru/public/71130/?ID=71130&amp;PAGEN_1=5#Oglavlenie"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">Вернуться к оглавлению...</span></a></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#4682b4;"><br /></span><a name="Pro_SKD_i_zaprosy_s_itogami"></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#4682b4;">П</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#4682b4;">ро СКД и запросы с итогами</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">В комментариях к публикациям</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> </span><a href="http://infostart.ru/public/79992/"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">Как выгрузить итоги запроса в одну колонку ?</span></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> и </span><a href="http://infostart.ru/public/80055/"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">Запросики для восьмерочки</span></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;">развернулась настоящая битва между </span><a href="http://infostart.ru/profile/53661/"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">Ish_2</span></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> и </span><a href="http://infostart.ru/profile/23149/"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">tango</span></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;">. Просто жуть какая-то. Но вопросы были подняты очень интересные. Я очень внимательно следил за ходом обсуждения и после </span><a href="http://forum.infostart.ru/forum24/topic37331/message408282/#message408282"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">очередного комментария с примером обработки</span></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;">от </span><a href="http://infostart.ru/profile/53661/"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">Ish_2</span></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;">, появилась обработка, которая демонстрирует построение многоуровнего дерева в одной колонке &quot;Поле4&quot; с использованием как запроса с итогами, так и СКД. За основу была взята обработка, приложенная к </span><a href="http://forum.infostart.ru/forum24/topic37331/message408282/#message408282"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">комментарию</span></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;">.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><img src="image10320.png" /><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> </span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Ах, да. &quot;В чем же фишка?&quot; - спросите вы. Всё просто. Из СКД сложное многоуровневое дерево в дерево значений выгружается быстрее. На контрольном примере разница составила в 30 раз. При использовании запроса сам запрос выполняется сравнительно быстро, а вот скорость выгрузки результата запроса в дерево значений оставляет желать лучшего.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Так как программного кода как такового при использовании СДК нет, то не совсем очевиден способ реализации. Куда смотреть? Смотреть нужно в пользовательских полях. </span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;"> </span><img src="image31600.png" /></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Собственно весь вывод данных в обработке при использовании СКД построен на пользовательских полях. Это сделано для того, чтобы сохранить нужную последовательность колонок в дереве значений. Если порядок следования реквизитов не важен или реквизиты не нужны в результирующем дереве значений, то и добавлять реквизиты в пользовательские поля не нужно.</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"><br /></span><a href="http://infostart.ru/public/download.php?file=80200"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">Скачать Пример 8...</span></a></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Но как вы, наверное, догадываетесь,</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#333333;">&quot;Пример 8&quot;</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> это не единственный вариант реализации многоуровневого дерева в одной колонке с использованием СКД. Поэтому был добавлен </span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#333333;">&quot;Пример 9&quot;</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;">, в котором &quot;Поле4&quot; строится не через пользовательские поля, а через ресурсы. Чем он лучше варианта в </span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#333333;">&quot;Пример 8&quot;</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;">? Работает немного быстрее предыдущего примера и названия колонок в результирующем дереве значений получаются более &quot;ожидаемые&quot;.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Особенностью реализации</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#333333;">&quot;Пример 9&quot;</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> является расположение ресурсов в группировках. Это сделано только для того, чтобы управлять порядком следования колонок в результирующем дереве значений. Иначе колонки с группировками будут расположены впереди, а уже за ними колонка &quot;Поле4&quot;. Чтобы можно было управлять порядком расположения реквизитов необходимо вначале сформировать группировки по реквизитам, а затем реквизиты описать как ресурсы. При необходимости формирования определенного порядка следования колонок в результирующем дереве необходимо для некоторых группировок заменить состав выбранных полей с </span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#008000;">Авто</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> на требуемый. Если порядок следования реквизитов не важен или реквизиты не нужны в результирующем дереве значений, то и добавлять реквизиты в ресурсы не нужно.<br /></span><a href="http://infostart.ru/public/download.php?file=80240"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">Скачать Пример 9...</span></a></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Возможность выбора варианта реализации многоуровнего дерева в одной колонке дерева значений есть. В данной публикации приведено 4 способа. Выбирайте. Реализуйте.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a href="http://infostart.ru/public/71130/?ID=71130&amp;PAGEN_1=5#Oglavlenie"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">Вернуться к оглавлению...</span></a></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#4682b4;"><br /></span><a name="Pro_derevo_znachenii"></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#4682b4;">П</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#4682b4;">ро дерево значений</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Уже были рассмотрены примеры заполнения дерева значений с использованием запроса и СКД. Сейчас предлагаю рассмотреть несколько иной вариант работы с деревом значений.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Краткое описание исходных условий для этого варианта. Работаем с деревом значений имеющим 2 уровня. Для первоначального отображения формируется только первый уровень строк дерева и добавляется по одной пустой строке на втором уровне для отображения плюсиков возле строк. Первый уровень свернут. Далее, при разворачивании пользователем строки первого уровня, пустая строка второго уровня заменяется на необходимый набор данных. Необходимый набор данных получаем, например, запросом в виде таблицы значений.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Что мы получаем при использовании такого варианта работы с деревом? Быстрое первоначальное отображение дерева для пользователя. Что ещё? Немного больше кода при работе с деревом.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Вот тут мы и попляшем немного вокруг вопроса: &quot;Как поместить необходимый набор данных в строки второго уровня?&quot; Есть варианты.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Наиболее очевидный вариант описан в начале этой статьи в части &quot;Про циклы в одну строку&quot;. Но он не единственный. Предлагаю рассмотреть ещё один кусочек кода, который намного производительнее при большом количестве строк в необходимом наборе данных.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">Процедура </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ДеревоЗначенийПередРазворачиванием</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Элемент</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">, </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">СтрокаДереваЗначений</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">, </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Отказ</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">)<br /><br />    Если </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">СтрокаДереваЗначений</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">УровеньРазвернут </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">Тогда<br />        Возврат;<br />    КонецЕсли;<br /><br />    </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">СтрокиГруппировки </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">СтрокаДереваЗначений</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Строки</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">;<br />    </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">СтрокиГруппировки</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Очистить</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">();<br /><br />    </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ТаблицаЗначений </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ПолучитьНаборНеобходимыхДанных</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">СтрокаДереваЗначений</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">);<br /><br />    Если </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ТаблицаЗначений</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Колонки</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Количество</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">() * </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">2 </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">&gt; </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ТаблицаЗначений</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Количество</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">() Тогда<br />        Для каждого </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">СтрокаТаблицыЗначений </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">Из </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ТаблицаЗначений </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">Цикл<br />            </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ЗаполнитьЗначенияСвойств</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">СтрокиГруппировки</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Добавить</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(), </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">СтрокаТаблицыЗначений</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">);<br />        КонецЦикла;<br />    Иначе<br />        Для </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Индекс </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">1 </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">По </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ТаблицаЗначений</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Количество</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">() Цикл<br />            </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">СтрокиГруппировки</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Добавить</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">();<br />        КонецЦикла;<br /><br />        Для каждого </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Колонка </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">Из </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ТаблицаЗначений</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Колонки </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">Цикл<br />            </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">СтрокиГруппировки</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ЗагрузитьКолонку</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ТаблицаЗначений</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ВыгрузитьКолонку</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Колонка</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Имя</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">), </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Колонка</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Имя</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">);<br />        КонецЦикла;<br />    КонецЕсли;<br /><br />    </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">СтрокаДереваЗначений</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">УровеньРазвернут </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= Истина;<br /><br />КонецПроцедуры </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#008000;">// ДеревоЗначенийПередРазворачиванием()</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Циклы также можно оформить в одну строку, но для сохранения читаемости кода этого не сделано. На контрольном примере предложенный вариант заполнения был производительнее в 4 раза. Конечно же всё зависит от исходных данных и на других данных результаты могут быть другие, но о том, что 1С всё таки интерпретатор не стоит забывать. Правило &quot;Чем меньше команд, тем быстрее работает программа&quot; остается актуальным и по сей день.</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"><br /><br /></span><a href="http://infostart.ru/public/69707/"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">Скачать пример...</span></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"><br />Ещё про дерево значений можно посмотреть </span><a href="http://infostart.ru/public/79771/"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">здесь...</span></a></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a href="http://infostart.ru/public/71130/?ID=71130&amp;PAGEN_1=5#Oglavlenie"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">Вернуться к оглавлению...</span></a></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#4682b4;"><br /></span><a name="Pro_tablicu_znachenii"></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#4682b4;">П</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#4682b4;">ро таблицу значений</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Увидел публикацию</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> </span><a href="http://infostart.ru/public/140594/"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">Преобразование ТаблицыЗначений во Временную таблицу</span></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> автора </span><a href="http://infostart.ru/profile/195483/"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">sashapere</span></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;">, в которой ТаблицаЗначений с колонками неопределенного типа подготавливается для использования в запросах. Т.е. проверяются типы значений в колонках, а затем создается новая таблица значений с колонками нужного типа и данные переносятся в неё. Такую таблицу значений уже можно использовать в запросах, передавая её в качестве параметра или источника данных для ПостроителяЗапросов и ПостроителяОтчетов.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Мне показалось, что код не очень эффективен и это можно сделать быстрее. Вот что из этого получилось.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff; background-color:#ffffff;">КолонкиТаблицыЗначений</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;"> </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ТаблицаЗначений</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Колонки</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">;<br />Для </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Индекс </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">0 </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">По </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">КолонкиТаблицыЗначений</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Количество</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">() - </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">1 </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">Цикл<br />    </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">МассивЗначений </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ТаблицаЗначений</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ВыгрузитьКолонку</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">0</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">);<br /><br />    </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#008000;">// Получаем типы значений, которые используются в колонке<br />    </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Соответствие </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= Новый </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Соответствие</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">;<br />    </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">СтТипЗначения </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ТипЗнч</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(Неопределено);<br />    Для каждого </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Значение </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">Из </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">МассивЗначений </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">Цикл<br />        </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ТипЗначения </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ТипЗнч</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Значение</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">);<br />        Если </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">СтТипЗначения </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">&lt;&gt; </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ТипЗначения </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">Тогда<br />            </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">СтТипЗначения </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ТипЗначения</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">;<br />            </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Соответствие</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Вставить</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ТипЗначения</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">);<br />        КонецЕсли;<br />    КонецЦикла;<br /><br />    </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#008000;">// Преобразуем соответствие в массив типов значений<br />    </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">МассивТипов </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= Новый </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Массив</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">;<br />    Для каждого </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">КлючИЗначение </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">Из </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Соответствие </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">Цикл<br />        </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">МассивТипов</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Добавить</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">КлючИЗначение</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Ключ</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">);<br />    КонецЦикла;<br /><br />    </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#008000;">// Удаляем старую колонку без установленного типа значения<br />    </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ИмяКолонки </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">КолонкиТаблицыЗначений</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">[</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">0</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">].</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Имя</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">;<br />    </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">КолонкиТаблицыЗначений</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Удалить</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">0</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">);<br />    Если </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">МассивТипов</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Количество</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">() = </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">0 </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">или </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">МассивТипов</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Количество</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">() = </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">1 </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">и </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">МассивТипов</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">[</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">0</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">] = </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ТипЗнч</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(Неопределено) Тогда<br />        </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#008000;">// Устанавливаем тип значения по умолчанию для колонок, в которых не установлены значения<br />        // По умолчанию Строка<br />        </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">КолонкиТаблицыЗначений</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Добавить</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ИмяКолонки</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">, Новый </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ОписаниеТипов</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">&quot;Строка&quot;</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">));<br />    Иначе<br />        </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#008000;">// Создаем и заполняем колонку с установленным типом<br />        </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ТаблицаЗначений</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ЗагрузитьКолонку</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">МассивЗначений</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">,<br />            </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">КолонкиТаблицыЗначений</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">Добавить</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ИмяКолонки</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">, Новый </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ОписаниеТипов</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">МассивТипов</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">)));<br />    КонецЕсли;<br />КонецЦикла;<br /></span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Допускаю, что и этот код тоже можно оптимизировать. Нет предела совершенству. Поэтому предлагаю сравнить с другими вариантами в</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#333333;">&quot;Примере 10&quot;</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;">. Авторы двух добавленных вариантов </span><a href="http://infostart.ru/profile/195483/"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">sashapere</span></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> и </span><a href="http://infostart.ru/profile/173686/"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">i132</span></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;">.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a href="http://infostart.ru/public/download.php?file=140914"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">Скачать Пример 10...</span></a></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a href="http://infostart.ru/public/71130/?ID=71130&amp;PAGEN_1=5#Oglavlenie"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">Вернуться к оглавлению...</span></a></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#4682b4;"><br /></span><a name="Pro_rabotu_s_COMObekt_V81_Application_ili_kak razognat_1S_v_1000_raz"></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#4682b4;">П</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#4682b4;">ро работу с COMОбъект(&quot;V81.Application&quot;) или как разогнать 1С в 1000 раз</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Очень интересная публикация </span><a href="http://www.infostart.ru/public/76382/"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">OLE - монитор</span></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> автора </span><a href="http://www.infostart.ru/profile/75854/"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">ghostishe</span></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;">, в которой приложена обработка </span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#000080;">COM MONITOR</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;">. Мне как раз необходимо было сверить справочники в двух базах данных. В предложенной обработке всё понятно, но скорость получения данных из подключенной базы мне показалась крайне низкой. После небольшого эксперимента удалось получить такие же данные как в этой обработке, только в 30 раз быстрее, а после небольшой модификации удалось поднять скорость получения данных из подключенной базы ещё в 5 раз. Добавил </span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#333333;">&quot;Пример 6&quot;</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;">. В предлагаемом примере разница во времени выполнения по сравнению с исходным образцом может составить от 15 до 1500 раз - это зависит от состояния базы данных и от объема получаемых данных. Чем больше данных нужно получить, тем больше может получиться разница.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Итак, что и как сравниваем. Во вложении 2 обработки:</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#333399;">COM MONITOR</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> и </span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#008000;">Пример 6 для COM Monitor</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;">.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#000080;">COM MONITOR</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> - во вложении, это почти оригинальная обработка, в которую добавлены команды для выполнения замера времени получения данных из подключенной базы. </span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#000080;">COM MONITOR</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> работает в двух режимах: с закрытым окном подключенной базы данных и с открытым. Т.к. с открытым окном обработка работает очень медленно, то для сравнения берем только замер с закрытым окном.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#008000;">Пример 6 для COM Monitor</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> - эта обработка построена на основе </span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#000080;">COM MONITOR</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;">, ну, или почти так. Во всяком случае основной функционал (идею) постарался сохранить. </span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#008000;">Пример 6 для COM Monitor</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> работает в двух режимах: с использованием дополнительной обработки и без неё. При установке соответствующего флажка используется дополнительная внешняя обработка, которая запускается в подключенной базе данных. Данные внешней обработке передаются через COMSafeArray, который в дальнейшем и обрабатывается. Обратно данные передаются аналогичным образом. Ни каких внешних компонент, всё по честному. AutoIt используется только чтобы вернуть фокус в 1С:Предприятие, а WScript для замера времени выполнения.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a href="http://www.infostart.ru/public/download.php?file=76745"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">Скачать COM MONITOR от ghostishe...</span></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"><br /></span><a href="http://www.infostart.ru/public/download.php?file=76746"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">Скачать Пример 6 для COM Monitor...</span></a></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">А теперь главный вопрос: за счет чего получается столь значительное ускорение? Ответ прост: за счет снижения количества разыменований. Да, да. На такой пустяковой операции как разыменование можно добиться столь значительного ускорения. Чем меньше точек в тексте модуля, тем выше скорость его выполнения. Разница особенно заметна при использовании</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#333333;">COMОбъект().</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> Т. к. кроме разыменования здесь немаловажную роль играет передача данных между приложениями, то именно этот момент и решает применение дополнительной обработки. Данные между приложениями передаются всего 2 раза: туда и обратно.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Запускайте, тестируйте, удивляйтесь.</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> </span><img src="image29639.png" /></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a href="http://infostart.ru/public/71130/?ID=71130&amp;PAGEN_1=5#Oglavlenie"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">Вернуться к оглавлению...</span></a></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#4682b4;"><br /></span><a name="Pro_rabotu_s_NastroikaPerioda_ZapolnitZnacheniyaSvoistv_i_voobsche"></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#4682b4;">П</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#4682b4;">ро работу с НастройкаПериода, ЗаполнитьЗначенияСвойств и вообще</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Вводные данные, ну, или описание исходной задачи были следующие:</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:13px;">Есть форма Основная, в которой есть возможность настраивать период. Для настройки периода используется объект НастройкаПериода, который вызывается на редактирование по кнопке.</span></li>
<li style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:13px;">Также ещё есть форма Настройка, в которой также можно редактировать период, но не только через объект НастройкаПериода, а ещё и через поля ввода дат начала и окончания периода.</span></li>
<li style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;" style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:13px;">Необходимо чтобы настройки указанные в форме Настройка можно принять и перенести в форму Основная или отказаться от сделанных изменений.</span></li></ul>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Казалось бы, всё просто, нужно в форме Настройка создать ещё один объект НастройкаПериода и заполнить его свойства. Например, так:</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">Функция </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">СкопироватьНустройкуПериода</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">НастройкаПериодаИсходный</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">)<br />    </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">НастройкаПериодаРезультат </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= Новый </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">НастройкаПериода</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">;<br />    </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ЗаполнитьЗначенияСвойств</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">НастройкаПериодаРезультат</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">, </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">НастройкаПериодаИсходный</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">);<br />    Возврат </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">НастройкаПериодаРезультат</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">;<br />КонецФункции</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Вот тут и начинается самое интересное. При использовании команды ЗаполнитьЗначенияСвойств свойства объекта НастройкаПериодаРезультат заполняются неверно, т.е. свойства, конечно, заполняются, но не так как в исходном объекте. А в некоторых случаях вообще возникает ошибка.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Почему нельзя просто присвоить?</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">НастройкаПериодаРезультат </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">НастройкаПериодаИсходный</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">;</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> Потому, что получится не новый объект, а ссылка на исходный объект.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Один из вариантов создания нового объекта НастройкаПериода может быть таким:</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">Функция </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">СкопироватьНустройкуПериода</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">НастройкаПериодаИсходный</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">)<br />    Возврат </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ЗначениеИзСтрокиВнутр</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ЗначениеВСтрокуВнутр</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">НастройкаПериодаИсходный</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">));<br />КонецФункции</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">С этим разобрались и новый объект НастройкаПериода у нас есть - можно редактировать. Теперь в случае отказа можно просто ничего не делать. Закрыть форму Настройка и всё.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Теперь рассмотрим сохранение (перенос) измененных данных периода в основную форму. Если редактирование периода было выполнено через объект НастройкаПериода, то всё просто.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">НастройкаПериодаИсходный </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">НастройкаПериодаРезультат</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">;</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">А вот в случае редактирования дат периода не всё так однозначно. Потому что способ, который используется в типовых конфигурациях, в некоторых случаях опять же дает неожиданный результат. Т.е. иногда срабатывает, а иногда нет. Вот код с заплаткой.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff; background-color:#ffffff;">НастройкаПериодаИсходный</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;"> </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">НастройкаПериодаРезультат</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">;<br /><br />Если </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ДатаНачала </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">&lt;&gt; </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">НастройкаПериодаИсходный</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ПолучитьДатуНачала</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">()<br />    или </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ДатаОкончания </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">&lt;&gt; </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">НастройкаПериодаИсходный</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ПолучитьДатуОкончания</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">() Тогда<br />    </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">НастройкаПериодаИсходный</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">УстановитьПериод</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ДатаНачала</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">, ?(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ДатаОкончания </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">'00010101'</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">, </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ДатаОкончания</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">, </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">КонецДня</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ДатаОкончания</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">)));<br /><br />    </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#008000;">// Заплатка<br />    </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">Если </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ДатаНачала </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">&lt;&gt; </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">НастройкаПериодаИсходный</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ПолучитьДатуНачала</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">()<br />        или </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ДатаОкончания </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">&lt;&gt; </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">НастройкаПериодаИсходный</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ПолучитьДатуОкончания</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">() Тогда<br />        </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">НастройкаПериодаИсходный </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= Новый </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">НастройкаПериода</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">;<br />        </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">НастройкаПериодаИсходный</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ВариантНачала </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ВариантГраницыИнтервала</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">КонкретнаяДата</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">;<br />        </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">НастройкаПериодаИсходный</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ВариантОкончания </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ВариантГраницыИнтервала</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">КонкретнаяДата</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">;<br />        </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">НастройкаПериодаИсходный</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ДатаНачала </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ДатаНачала</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">;<br />        </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">НастройкаПериодаИсходный</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ДатаОкончания </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">= </span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ДатаОкончания</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">;<br />    КонецЕсли;<br />КонецЕсли;</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Как видно из кода, заплатка в качестве периода устанавливает ПроизвольныйПериод. Ах, да. Не видно. Но всё равно в качестве периода устанавливается ПроизвольныйПериод.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Я прекрасно понимаю, что здесь рассмотрен некоторый частный случай, который в типовых конфигурациях не встречается. Но. Есть ли что-то особенное в постановке задачи? По моему нет. Так почему же такой подход не используется в типовых конфигурациях? Не связано ли это с тем, что разработчики типовых конфигураций фирмы 1С не смогли победить объект НастройкаПериода.</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> </span><img src="image6108.png" /></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">В качестве примера приведу &quot;Универсальный отчет&quot;, в котором также есть как Основная форма, так и форма Настройки. При этом если изменить период в форме Настройки, он тут же изменяется и в Основной форме. Т.е. закрыв форму Настройки можно отказаться от всех сделанных изменений кроме изменений периода. Вот такие пироги.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a href="http://infostart.ru/public/69707/"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">Скачать пример...</span></a></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a href="http://infostart.ru/public/71130/?ID=71130&amp;PAGEN_1=5#Oglavlenie"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">Вернуться к оглавлению...</span></a></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#4682b4;"><br /></span><a name="Pro_itogi_v_registrah_nakopleniya"></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#4682b4;">П</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#4682b4;">ро итоги в регистрах накопления</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Пришло время испытать</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> </span><a href="http://infostart.ru/public/82178/"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">публикацию</span></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> </span><a href="http://infostart.ru/profile/1106/"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">MMF</span></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> на довольно большой базе данных. Обнаружился очень интересный факт. Таблица итогов по регистру остатков ЗаказыПокупателей была больше таблицы самого регистра в 50 раз и составляла 20% от всей базы УПП. Все попытки побороть это явление &quot;цивилизованными&quot; способами привели к уменьшению таблицы итогов лишь в 2.5 раза, при этом таблица самого регистра накопления выросла в 2 раза. Тогда было принято решение отключить расчет итогов по этому регистру. На производительности и функциональности это ни как не сказалось, а вот на размерах базы данных и на размерах архивных копий отразилось самым положительным образом.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Т.к. через интерфейс это сделать не получилось, то вот, собственно, код:</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff; background-color:#ffffff;">РегистрыНакопления</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">ЗаказыПокупателей</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">.</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#0000ff;">УстановитьПериодРассчитанныхИтогов</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">(</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#000000;">'00010101'</span><span style=" font-family:'courier new,courier'; font-size:8pt; color:#ff0000;">);</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">С методической точки зрения, возможно, это не самое лучшее решение. Но меня поразила его эффективность и простота.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a href="http://infostart.ru/public/18394/"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">Скачать пример...</span></a></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Для просмотра внутренней структуры файловой базы данных 1С:Предприятия 8 предлагаю обратить внимание на</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;"> </span><a href="http://infostart.ru/public/19633/"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">Tool_1CD</span></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333;">.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a href="http://infostart.ru/public/71130/?ID=71130&amp;PAGEN_1=5#Oglavlenie"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#428bca;">Вернуться к оглавлению...</span></a></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#4682b4;"><br /></span><a name="Pro_tancy_s_bubnom"></a><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#4682b4;">П</span><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; font-weight:696; color:#4682b4;">ро танцы с бубном</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Пришло время разучить новый танец. Ни когда раньше такого не делал, но вот пришлось.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Что есть? Конфигурация на базе типового решения 1С:Бухгалтерия предприятия 8 (2.0.31.36) - Учет в МФО (релиз 2.0.31.36), разработчик Фирма &quot;Альянс-Информ&quot;. База работает на платформе 8.2.13.219.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Что хотим? Перейти на платформу 8.2.15.294.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Казалось бы, что ничего сложного нет. Установить платформу, запустить базу, сконвертировать базу при запуске и работать в своё удовольствие. Но не тут то было. После конвертации база почему-то начинает падать при запуске на любой версии платформы, начиная с 8.2.14.519. При этом на 8.2.13.219 всё работало как в режиме Конфигуратор, так и в режиме 1С:Предприятие.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Восстанавливаем архив, лезем в конфигуратор и видим, что конфигурация на поддержке без возможности изменения, т.е. типовая. Нужно что-то делать. Но что? Тестирование/исправление, реструктуризация, выгрузка/загрузка - все ранее применявшиеся движения шаманского танца не помогли. После конвертации база падает при запуске.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Что дальше? Разучим новые движения незамысловатого шаманского танца. Начинаем сначала. Заходим в конфигуратор платформы 8.2.13.219 пустой базы. Восстанавливаем архив базы данных из DT-файла. Сохраняем конфигурацию в CF-файл в меню Конфигурация - Сохранить конфигурацию в файл. Включаем возможность изменения в меню Конфигурация - Поддержка - Настройка поддержки. Обновляем конфигурацию базы данных (F7) или в меню Конфигурация - Обновить конфигурацию базы данных. Выходим из конфигуратора. Заходим в конфигуратор платформы 8.2.15.294. Выбираем ту же базу. Соглашаемся с предложением сконвертировать базу данных. Загружаем выгруженный ранее CF-файл в меню Конфигурация - Загрузить конфигурацию из файла. Обновляем конфигурацию базы данных (F7) или в меню Конфигурация - Обновить конфигурацию базы данных. Вот собственно и всё. Получаем работающую базу под платформой 8.2.15.294 с типовой конфигурацией на поддержке без возможности изменения. Т.е. всё то, что и хотелось получить первоначально.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:8.25pt; color:#333333; background-color:#ffffff;">Вывод. В арсенале настоящего шамана может быть много разных танцев, но архивную копию делать нужно.</span></p></body></html>