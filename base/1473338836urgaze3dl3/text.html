<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'Courier New'; font-size:12pt; font-weight:400; font-style:normal;">
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana'; color:#000000;">В этой статье приведены некоторые особенности работы с COM-объектами, которые могут оказаться полезными в практической деятельности.</span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="chapter1"></a><span style=" font-family:'Arial,Tahoma'; font-size:14pt; font-weight:600; color:#000000;">И</span><span style=" font-family:'Arial,Tahoma'; font-size:14pt; font-weight:600; color:#000000;">спользование оператора доступа по индексу []</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana'; color:#000000;">В технологии Automation не предусмотрено штатных средств для реализации обращений по индексам, а доступ к индексированным свойствам (т.е. выражения вида МояФункция(X, Y) = Z) через Automation допускает неоднозначность толкования и не поддерживается встроенным языком 1С:Предприятия.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana'; color:#000000;">Для обработки свойств-коллекций рекомендуется использовать оператор цикла </span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">Для Каждого ...</span><span style=" font-family:'Verdana'; color:#000000;">, использующий стандартный для Automation интерфейс </span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">IEnumVARIANT</span><span style=" font-family:'Verdana'; color:#000000;">. Для доступа по индексу через Automation объекты-коллекции 1С:Предприятия также реализуют методы </span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">Получить()</span><span style=" font-family:'Verdana'; color:#000000;"> и </span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">Установить()</span><span style=" font-family:'Verdana'; color:#000000;">.</span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial,Tahoma'; font-size:14pt; font-weight:600; color:#000000;">Передача параметров в конструктор объекта</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana'; color:#000000;">Метод </span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">NewObject()</span><span style=" font-family:'Verdana'; color:#000000;"> объекта Automation 1С:Предприятия имеет переменное число параметров - первым параметром в </span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">NewObject()</span><span style=" font-family:'Verdana'; color:#000000;"> всегда передается имя типа создаваемого объекта, а последующие параметры могут быть использованы для передачи данных в конструктор создаваемого объекта.</span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial,Tahoma'; font-size:14pt; font-weight:600; color:#000000;">Совпадение имен свойств и методов объекта</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana'; color:#000000;">Технология Automation подразумевает возможность двоякого толкования некоторых элементов агрегатного объекта. Например, могут не различаться одноименные свойство и метод, возвращающий значение и не имеющий параметров. Эту особенность следует иметь в виду при работе с объектами 1С:Предприятия через Automation.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana'; color:#000000;">Например, если реквизит справочника назван так же, как и один его методов (реквизит </span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">ПолноеНаименование</span><span style=" font-family:'Verdana'; color:#000000;"> и метод </span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">ПолноеНаименование()</span><span style=" font-family:'Verdana'; color:#000000;">), то получение реквизита </span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">Справочник.ПолноеНаименование</span><span style=" font-family:'Verdana'; color:#000000;"> может привести к вызову метода </span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">Справочник.ПолноеНаименование()</span><span style=" font-family:'Verdana'; color:#000000;">. Такая неразличимость возможна именно при работе через Automation, во встроенном языке 1С:Предприятия свойства и методы объектов 1С:Предприятия разделены.</span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="chapter1.2"></a><span style=" font-family:'Arial,Tahoma'; font-size:14pt; font-weight:600; color:#000000;">О</span><span style=" font-family:'Arial,Tahoma'; font-size:14pt; font-weight:600; color:#000000;">тображение в отладчике свойств со значением &quot;Ошибка чтения значения&quot;</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana'; color:#000000;">Упомянутая выше возможность двоякого толкования элементов агрегатного объекта имеет и визуальное отображение - при просмотре в отладчике 1С:Предприятия свойств COM-объектов можно видеть свойства со значением &quot;Ошибка чтения значения&quot;. В действительности эти свойства являются методами, однако могут использоваться и как свойства (например, в таком языке как Visual Basic).</span></p></body></html>