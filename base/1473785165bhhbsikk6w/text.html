<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'Courier New'; font-size:12pt; font-weight:400; font-style:normal;">
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana'; font-size:9pt; color:#000000;">В версии 8.2 приложение не работает непосредственно с локальными файлами, расположенными на компьютере. Файлы должны находиться на сервере. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana'; font-size:9pt; color:#000000;">Поэтому для открытия внешней обработки нужно выполнить следующую последовательность действий:</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Verdana'; font-size:9pt; color:#000000;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Передать файл внешней обработки на сервер</li>
<li style=" font-family:'Verdana'; font-size:9pt; color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Подключить внешнюю обработку</li>
<li style=" font-family:'Verdana'; font-size:9pt; color:#000000;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Открыть форму внешней обработки<br /></li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana'; font-size:9pt; color:#000000;">Чтобы передать файл на сервер, его нужно поместить во временное хранилище. Для этого сначала на клиенте, в обработчике команды открытия внешней обработки, методом глобального контекста</span><span style=" font-family:'Verdana'; font-size:9pt; font-weight:600; color:#000000;">ПоместитьФайл()</span><span style=" font-family:'Verdana'; font-size:9pt; color:#000000;"> мы помещаем файл из локальной файловой системы во временное хранилище.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana'; font-size:9pt; color:#000000;">В четвертом параметре этого метода указывается признак интерактивного режима выбора файла внешней обработки. Если этот параметр </span><span style=" font-family:'Verdana'; font-size:9pt; font-weight:600; color:#000000;">Истина</span><span style=" font-family:'Verdana'; font-size:9pt; color:#000000;">, то появляется диалог выбора файла, в котором можно выбрать файл для помещения в хранилище. В нашем примере этот параметр - </span><span style=" font-family:'Verdana'; font-size:9pt; font-weight:600; color:#000000;">Ложь</span><span style=" font-family:'Verdana'; font-size:9pt; color:#000000;">, а путь к файлу, данные из которого будут помещены во временное хранилище, явно задан во втором параметре метода.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana'; font-size:9pt; color:#000000;">При вызове метода </span><span style=" font-family:'Verdana'; font-size:9pt; font-weight:600; color:#000000;">ПоместитьФайл()</span><span style=" font-family:'Verdana'; font-size:9pt; color:#000000;"> первым его параметром, </span><span style=" font-family:'Verdana'; font-size:9pt; font-weight:600; color:#000000;">АдресХранилища</span><span style=" font-family:'Verdana'; font-size:9pt; color:#000000;">, мы указываем пустую строку. После выполнения метода в нее будет помещен путь к файлу внешней обработки во временном хранилище. Этот путь мы используем для того, чтобы подключить внешнюю обработку.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana'; font-size:9pt; color:#000000;">Подключение внешней обработки выполняется на сервере методом </span><span style=" font-family:'Verdana'; font-size:9pt; font-weight:600; color:#000000;">Подключить()</span><span style=" font-family:'Verdana'; font-size:9pt; color:#000000;"> менеджера внешних обработок. В качестве параметра ему передается путь к файлу внешней обработки во временном хранилище - </span><span style=" font-family:'Verdana'; font-size:9pt; font-weight:600; color:#000000;">АдресХранилища</span><span style=" font-family:'Verdana'; font-size:9pt; color:#000000;">. Возвращает этот метод имя подключенной внешней обработки, - </span><span style=" font-family:'Verdana'; font-size:9pt; font-weight:600; color:#000000;">ИмяОбработки</span><span style=" font-family:'Verdana'; font-size:9pt; color:#000000;">, - которое мы используем для того, чтобы открыть форму этой обработки.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana'; font-size:9pt; color:#000000;">Для открытия формы внешней обработки используется метод глобального контекста </span><span style=" font-family:'Verdana'; font-size:9pt; font-weight:600; color:#000000;">ОткрытьФорму()</span><span style=" font-family:'Verdana'; font-size:9pt; color:#000000;">, в который передается имя формы в виде следующей строки: </span><span style=" font-family:'Verdana'; font-size:9pt; font-weight:600; color:#000000;">&quot;ВнешняяОбработка.&quot;+ ИмяОбработки +&quot;.Форма&quot;</span><span style=" font-family:'Verdana'; font-size:9pt; color:#000000;">. В приведенном варианте открывается основная форма обработки. Можно открыть также и неосновную форму обработки - об этом рассказывается в вопросе </span><a href="http://its.1c.ru/db/content/metod8dev/src/developers/platform/qanda/form/form_open/i8103546.htm?_=1473671124"><span style=" font-family:'Verdana'; font-size:9pt; font-weight:600; text-decoration: underline; color:#cc0000;">Как получить неосновную форму обработки?</span></a><span style=" font-family:'Verdana'; font-size:9pt; color:#000000;">.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="javascript:"><span style=" font-size:9pt; font-weight:600; text-decoration: underline; color:#cc0000; background-color:#e6e6e6;">Копировать в буфер обмена</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#0000ff; background-color:#f0f0f0;">&amp;НаКлиенте</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#ff0000;">Процедура</span><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#0000ff;"> ОбработкаКоманды</span><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#ff0000;">(</span><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#0000ff;">ПараметрКоманды</span><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#ff0000;">,</span><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#0000ff;"> ПараметрыВыполненияКоманды</span><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#ff0000;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:9pt; color:#ff0000; background-color:#f0f0f0;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#0000ff;">    </span><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#008000;">//Помещаем обработку во временном хранилище</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#0000ff;">    АдресХранилища </span><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#ff0000;">=</span><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#0000ff;"> </span><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#000000;">&quot;&quot;</span><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#ff0000;">;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#0000ff;">    Результат </span><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#ff0000;">=</span><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#0000ff;"> ПоместитьФайл</span><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#ff0000;">(</span><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#0000ff;">АдресХранилища</span><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#ff0000;">,</span><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#0000ff;"> </span><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#000000;">&quot;C:\ВнешняяОбработка.epf&quot;</span><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#ff0000;">,</span><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#0000ff;"> </span><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#ff0000;">,</span><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#0000ff;"> </span><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#ff0000;">Ложь);</span><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#0000ff;">           </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#0000ff;">    ИмяОбработки </span><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#ff0000;">=</span><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#0000ff;"> ПодключитьВнешнююОбработку</span><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#ff0000;">(</span><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#0000ff;">АдресХранилища</span><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#ff0000;">);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#0000ff;">    </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#0000ff;">    </span><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#008000;">// Откроем форму подключенной внешней обработки</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#0000ff;">    ОткрытьФорму</span><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#ff0000;">(</span><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#000000;">&quot;ВнешняяОбработка.&quot;</span><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#ff0000;">+</span><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#0000ff;"> ИмяОбработки </span><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#ff0000;">+</span><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#000000;">&quot;.Форма&quot;</span><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#ff0000;">);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:9pt; color:#ff0000; background-color:#f0f0f0;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#ff0000;">КонецПроцедуры</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:9pt; color:#ff0000; background-color:#f0f0f0;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#0000ff;">&amp;НаСервере</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#ff0000;">Функция</span><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#0000ff;"> ПодключитьВнешнююОбработку</span><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#ff0000;">(</span><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#0000ff;">АдресХранилища</span><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#ff0000;">)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:9pt; color:#ff0000; background-color:#f0f0f0;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#0000ff;">    </span><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#ff0000;">Возврат</span><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#0000ff;"> ВнешниеОбработки</span><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#ff0000;">.</span><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#0000ff;">Подключить</span><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#ff0000;">(</span><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#0000ff;">АдресХранилища</span><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#ff0000;">);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:9pt; color:#ff0000; background-color:#f0f0f0;"></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#ff0000;">КонецФункции</span><span style=" font-family:'Courier New,courier'; font-size:9pt; color:#0000ff;">       <br /></span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana'; font-size:9pt; color:#000000;">При работе в внешними обработками нужно учитывать, что по-умолчанию они запускаются в безопасном режиме исполнения программного кода. Это значит, что некоторые возможности встроенного языка будут для них недоступны. Если есть уверенность, что внешняя обработка не содержит вредоносного кода, ее можно подключить в обычном режиме исполнения программного кода. Для этого используется третий параметр метода </span><span style=" font-family:'Verdana'; font-size:9pt; font-weight:600; color:#000000;">Подключить() </span><span style=" font-family:'Verdana'; font-size:9pt; color:#000000;">менеджера внешних обработок.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana'; font-size:9pt; color:#000000;">Подробнее о режиме безопасного исполнения программного кода можно прочитать в документации: </span><span style=" font-family:'Verdana'; font-size:9pt; font-weight:600; color:#000000;">1С:Предприятие 8.2. Руководство разработчика</span><span style=" font-family:'Verdana'; font-size:9pt; color:#000000;">, Раздел 5.5.4.3: </span><span style=" font-family:'Verdana'; font-size:9pt; font-weight:600; color:#000000;">Объекты конфигурации</span><span style=" font-family:'Verdana'; font-size:9pt; color:#000000;"> - </span><span style=" font-family:'Verdana'; font-size:9pt; font-weight:600; color:#000000;">Ветвь конфигурации «Общие»</span><span style=" font-family:'Verdana'; font-size:9pt; color:#000000;"> - </span><span style=" font-family:'Verdana'; font-size:9pt; font-weight:600; color:#000000;">Роли и права доступа</span><span style=" font-family:'Verdana'; font-size:9pt; color:#000000;"> - </span><span style=" font-family:'Verdana'; font-size:9pt; font-weight:600; color:#000000;">Безопасный режим работы</span><span style=" font-family:'Verdana'; font-size:9pt; color:#000000;">.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana'; font-size:9pt; color:#000000;">Подробнее об использовании метода </span><span style=" font-family:'Verdana'; font-size:9pt; font-weight:600; color:#000000;">ПоместитьФайл()</span><span style=" font-family:'Verdana'; font-size:9pt; color:#000000;"> можно прочитать в синтакс-помощнике: </span><span style=" font-family:'Verdana'; font-size:9pt; font-weight:600; color:#000000;">Глобальный контекст - Процедуры и функции работы с файлами.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana'; font-size:9pt; color:#000000;">Подробнее об использовании метода </span><span style=" font-family:'Verdana'; font-size:9pt; font-weight:600; color:#000000;">Подключить()</span><span style=" font-family:'Verdana'; font-size:9pt; color:#000000;"> можно прочитать в синтакс-помощнике: </span><span style=" font-family:'Verdana'; font-size:9pt; font-weight:600; color:#000000;">Прикладные объекты - Внешние обработки и отчеты - ВнешниеОбработкиМенеджер - Методы.</span></p></body></html>