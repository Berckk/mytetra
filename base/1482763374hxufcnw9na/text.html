<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; font-size:8.25pt; color:#000000; background-color:#ffffff;">..., даже если проект не планируется развивать и вы не собираетесь делиться исходными кодами, потому что через 20 лет какой-нибудь маньяк будет изучать и дорабатывать машинный код вашего продукта, и он может захотеть вас найти. </span><img src="image22579.png" /><span style=" font-family:'Verdana,sans-serif'; font-size:8.25pt; color:#000000; background-color:#ffffff;"> Вообще я достаточно редко играю в компьютерные игры. Бывало, не играл по несколько лет подряд. Но иногда во мне просыпается маленький реверс-инженер, который мотивирует меня забраться в машинный код какой-нибудь любимой игрушки из прошлого. В последний год я занимался </span><a href="http://veg.by/ru/projects/nfs3/"><span style=" font-family:'Verdana,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#990099; background-color:#ffffff;">доработкой Need For Speed III: Hot Pursuit (1998 года)</span></a><span style=" font-family:'Verdana,sans-serif'; font-size:8.25pt; color:#000000; background-color:#ffffff;">. Это моя любимая игра в жанре, но теперь я, к своему сожалению, знаю о том, насколько отвратительно она написана. Большое количество маленьких багов в самых неожиданных местах — прямое следствие низкого качества кода. </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; font-size:8.25pt; color:#000000; background-color:#ffffff;">Насколько всё плохо?</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; font-size:8.25pt; color:#000000; background-color:#ffffff;">В исполняемом файле огромное количество кода, который остался в наследство от предыдущих частей игры и не используется, то есть устаревший код не удалялся разработчиками, причём мне встречались случаи, когда какой-то устаревший код вызывался, но результаты его работы игнорировались, потому что обновлённому коду они уже были не нужны. В игре всюду используются статичные массивы фиксированного размера, во многих случаях отсутствуют проверки выхода за пределы массива, что приводит к падениям, когда какого-то зарезервированного объёма памяти не хватает. В игре используется большое количество грязных хаков. Например, функция гонки по отражённому варианту трассы реализована не отражением модели трассы при её загрузке, а переворотом каждого кадра при рендеринге, с инверсией кнопок «лево» и «право» и ряда аналогичных подмен там, где разработчики не забыли добавить соответствующий код. Из-за этого надписи на машинах (например, копов) отражены, а во время гонок копы путают «право» и «лево» при переговорах по рации. Есть и ошибки, явно связанные с использованием магических чисел в коде вместо именованных констант, когда значение константы в процессе разработки было изменено, но остался код, который использует старое значение и работает неправильно. Но один случай оказался забавным настолько, что мне захотелось поделиться им в рамках небольшой заметки. </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; font-size:8.25pt; color:#000000; background-color:#ffffff;">Сколько ошибок может быть в 4 вариантах одного и того же кода?</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; font-size:8.25pt; color:#000000; background-color:#ffffff;">В игре присутствовал один незначительный баг, связанный с отступами в выпадающих меню. Например, если был выбран режим «Hot Pursuit», левый отступ всех верхних выпадающих списков значительно увеличивался без явной на то необходимости. </span><img src="image20556.png" /><span style=" font-family:'Verdana,sans-serif'; font-size:8.25pt; color:#000000; background-color:#ffffff;"> </span><img src="image5063.png" /><span style=" font-family:'Verdana,sans-serif'; font-size:8.25pt; color:#000000; background-color:#ffffff;"> Я предположил, что это связано с ошибкой в коде, который добавляет пространство для вывода иконок прохождения в выпадающем списке трасс, которые как раз и должны отображаться только в режиме «Hot Pursuit». </span><img src="image12021.png" /><span style=" font-family:'Verdana,sans-serif'; font-size:8.25pt; color:#000000; background-color:#ffffff;"> </span><img src="image12730.png" /><span style=" font-family:'Verdana,sans-serif'; font-size:8.25pt; color:#000000; background-color:#ffffff;"> Обычные выпадающие списки тоже имели проблемы с отступами в зависимости от режима, но не в такой явной форме. Поскольку я как раз копался рядом с соответствующим кодом, решил заодно исправить и это странное поведение. Тут стоит отметить, что в коде игры не встречаются следы вещей вроде наследования, так что скорее всего она писалась на чистом C. В игре реализован код, который читает списки элементов меню и их свойства из внешних текстовых файлов, но разработчики часто ленились добавлять поддержку какого-то нового свойства, и писали дополнительный код, опираясь просто на имя элемента. Например, код вывода выпадающих списков сам проверяет название текущего элемента и какие-то другие переменные, и в зависимости от этого может применять какую-то дополнительную логику. Так оказалось и здесь. Поскольку в меню используется два разных типа выпадающих списков (обычный и верхний), весь код работы с ними был целиком продублирован дважды. Помимо этого оказалось, что левый отступ выбирается разными фрагментами кода при вычислении левой и правой границы выпадающего списка. Итого — по идее у нас должно быть 4 копии одного и того же кода. Как бы не так! Вариант 1 (при вычислении отступа левой границы обычной выпадашки): </span><img src="image23783.png" /><span style=" font-family:'Verdana,sans-serif'; font-size:8.25pt; color:#000000; background-color:#ffffff;"> На C это выглядело примерно так: </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#333333; background-color:#f8f8f8;">dw_padding = (stricmp(str_element_name, </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#dd1144; background-color:#f8f8f8;">&quot;tracks&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#333333; background-color:#f8f8f8;">) == </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#008080; background-color:#f8f8f8;">0</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#333333; background-color:#f8f8f8;"> &amp;&amp; dw_cfg_race_type == </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#008080; background-color:#f8f8f8;">3</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#333333; background-color:#f8f8f8;">) ? </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#008080; background-color:#f8f8f8;">35</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#333333; background-color:#f8f8f8;"> : </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#008080; background-color:#f8f8f8;">15</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#333333; background-color:#f8f8f8;">;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#333333; background-color:#ffffff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; font-size:8.25pt; color:#000000; background-color:#ffffff;">Вариант 2 (при вычислении отступа правой границы обычной выпадашки): </span><img src="image28573.png" /><span style=" font-family:'Verdana,sans-serif'; font-size:8.25pt; color:#000000; background-color:#ffffff;"> На C это выглядело примерно так: </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#333333; background-color:#f8f8f8;">dw_padding = (stricmp(str_element_name, </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#dd1144; background-color:#f8f8f8;">&quot;tracks&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#333333; background-color:#f8f8f8;">) == </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#008080; background-color:#f8f8f8;">0</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#333333; background-color:#f8f8f8;"> || stricmp(str_element_name, </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#dd1144; background-color:#f8f8f8;">&quot;rectrk&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#333333; background-color:#f8f8f8;">) == </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#008080; background-color:#f8f8f8;">0</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#333333; background-color:#f8f8f8;">) ? </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#008080; background-color:#f8f8f8;">35</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#333333; background-color:#f8f8f8;"> : </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#008080; background-color:#f8f8f8;">15</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#333333; background-color:#f8f8f8;">;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#333333; background-color:#ffffff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; font-size:8.25pt; color:#000000; background-color:#ffffff;">Варианты 3 и 4 (при вычислении отступа левой и правой границ выпадашки под заголовком): </span><img src="image11961.png" /><span style=" font-family:'Verdana,sans-serif'; font-size:8.25pt; color:#000000; background-color:#ffffff;"> </span><img src="image12259.png" /><span style=" font-family:'Verdana,sans-serif'; font-size:8.25pt; color:#000000; background-color:#ffffff;"> На C это выглядело примерно так: </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#333333; background-color:#f8f8f8;">dw_padding = (dw_cfg_race_type == </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#008080; background-color:#f8f8f8;">3</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#333333; background-color:#f8f8f8;">) ? </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#008080; background-color:#f8f8f8;">35</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#333333; background-color:#f8f8f8;"> : </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#008080; background-color:#f8f8f8;">15</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#333333; background-color:#f8f8f8;">;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#333333; background-color:#ffffff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; font-size:8.25pt; color:#000000; background-color:#ffffff;">Все варианты вместе (для наглядности): </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#333333; background-color:#f8f8f8;">dw_padding = (stricmp(str_element_name, </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#dd1144; background-color:#f8f8f8;">&quot;tracks&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#333333; background-color:#f8f8f8;">) == </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#008080; background-color:#f8f8f8;">0</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#333333; background-color:#f8f8f8;"> &amp;&amp; dw_cfg_race_type == </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#008080; background-color:#f8f8f8;">3</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#333333; background-color:#f8f8f8;">) ? </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#008080; background-color:#f8f8f8;">35</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#333333; background-color:#f8f8f8;"> : </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#008080; background-color:#f8f8f8;">15</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#333333; background-color:#f8f8f8;">;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#333333; background-color:#f8f8f8;">dw_padding = (stricmp(str_element_name, </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#dd1144; background-color:#f8f8f8;">&quot;tracks&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#333333; background-color:#f8f8f8;">) == </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#008080; background-color:#f8f8f8;">0</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#333333; background-color:#f8f8f8;"> || stricmp(str_element_name, </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#dd1144; background-color:#f8f8f8;">&quot;rectrk&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#333333; background-color:#f8f8f8;">) == </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#008080; background-color:#f8f8f8;">0</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#333333; background-color:#f8f8f8;">) ? </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#008080; background-color:#f8f8f8;">35</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#333333; background-color:#f8f8f8;"> : </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#008080; background-color:#f8f8f8;">15</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#333333; background-color:#f8f8f8;">;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#333333; background-color:#f8f8f8;">dw_padding = (dw_cfg_race_type == </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#008080; background-color:#f8f8f8;">3</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#333333; background-color:#f8f8f8;">) ? </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#008080; background-color:#f8f8f8;">35</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#333333; background-color:#f8f8f8;"> : </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#008080; background-color:#f8f8f8;">15</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#333333; background-color:#f8f8f8;">;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#333333; background-color:#ffffff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; font-size:8.25pt; color:#000000; background-color:#ffffff;">Какой же вариант правильный? Ответ: ни один! Только если мы объединим все проверки вместе, мы можем получить единственно верный вариант кода, и выглядел бы он примерно так: </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#333333; background-color:#f8f8f8;">dw_padding = (dw_cfg_race_type == </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#008080; background-color:#f8f8f8;">3</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#333333; background-color:#f8f8f8;"> &amp;&amp; (stricmp(str_element_name, </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#dd1144; background-color:#f8f8f8;">&quot;tracks&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#333333; background-color:#f8f8f8;">) == </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#008080; background-color:#f8f8f8;">0</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#333333; background-color:#f8f8f8;"> || stricmp(str_element_name, </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#dd1144; background-color:#f8f8f8;">&quot;rectrk&quot;</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#333333; background-color:#f8f8f8;">) == </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#008080; background-color:#f8f8f8;">0</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#333333; background-color:#f8f8f8;">)) ? </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#008080; background-color:#f8f8f8;">35</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#333333; background-color:#f8f8f8;"> : </span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#008080; background-color:#f8f8f8;">15</span><span style=" font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#333333; background-color:#f8f8f8;">;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Menlo,Monaco,Courier New,monospace'; font-size:8.25pt; color:#333333; background-color:#ffffff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; font-size:8.25pt; color:#000000; background-color:#ffffff;">Итого у нас 4 варианта одного и того же кода, при этом в разных вариантах допущено 3 разные ошибки! Просто уникальный случай и отличная демонстрация того, почему копипаста — это плохая идея. </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; font-size:8.25pt; color:#000000; background-color:#ffffff;">Как это было исправлено?</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; font-size:8.25pt; color:#000000; background-color:#ffffff;">О том, как вносятся изменения в машинный код, я </span><a href="https://habrahabr.ru/post/51857/"><span style=" font-family:'Verdana,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#990099; background-color:#ffffff;">писал ранее</span></a><span style=" font-family:'Verdana,sans-serif'; font-size:8.25pt; color:#000000; background-color:#ffffff;">. Для исправления проблемы я написал одну функцию: </span><img src="image17498.png" /><span style=" font-family:'Verdana,sans-serif'; font-size:8.25pt; color:#000000; background-color:#ffffff;"> Все приведённые выше фрагменты кода были заменены на вызов этой функции. Теперь отступы в списках выбираются правильно :) И это лишь одно из более чем 200 изменений, которые были сделаны в </span><a href="http://veg.by/ru/projects/nfs3/"><span style=" font-family:'Verdana,sans-serif'; font-size:8.25pt; text-decoration: underline; color:#990099; background-color:#ffffff;">патче</span></a><span style=" font-family:'Verdana,sans-serif'; font-size:8.25pt; color:#000000; background-color:#ffffff;">. Описанное изменение на самом деле одно из самых маленьких, но зато сама ошибка, на мой взгляд, была интересной (как демонстрация вреда от соответствующего антипаттерна). </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; font-size:8.25pt; color:#000000; background-color:#ffffff;">Выводы?</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; font-size:8.25pt; color:#000000; background-color:#ffffff;">А теперь подумайте. Если здесь нашёлся самозванец, который взялся исправлять без спроса чужие баги в программе без исходных кодов, может найтись и тот, кто в итоге будет настолько зол, что у него появится желание отыскать разработчика или его родственников. А оно вам надо? Пишите качественный код :)</span></p></body></html>