<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'Courier New'; font-size:12pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-size:xx-large; font-weight:296; color:#333333; background-color:#ffffff;">Взаимодействие между базами 1С через COM</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; font-weight:600; color:#333333; background-color:#ffffff;">Рассмотрено много особенностей взаимодействия между базами 1С по COM технологии</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="docs-internal-guid-9bfcc3c1-16d1-b466-2c8f-4f5faae88d6c"></a><span style=" font-family:'Arial'; font-size:x-large; font-weight:600; color:#000000; background-color:#ffffff;">В</span><span style=" font-family:'Arial'; font-size:x-large; font-weight:600; color:#000000; background-color:#ffffff;">заимодействие между базами 1С через COM</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;">В этой статье я расскажу о многих особенностях взаимодействия между базами 1С по COM технологии, накопленных за годы развития и использования интеграционного коммерческого продукта 2iS:Интеграция нашей компании 2iS.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial'; font-size:x-large; font-weight:600; color:#000000; background-color:#ffffff;">Термины</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;">ОС – операционная система</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;">COM-клиент – процесс(поток) ОС, запросивший создание COM-объекта</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;">COM-сервер – COM-объект, созданный по запросу клиента</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;">Издание платформы – подстрока до 2-й точки версии платформы (например 8.2, 8.3)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;">Com-соединитель – COM-объект V8X.ComСonnector для создания внешних соединений с базами 1С<br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;">Automation-сервер – он же OLE-сервер, COM-объект V8X.Application для создания приложений 1С</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;">Сборка платформы – полная строка версии платформы (например 8.2.19.130, 8.2.16.352)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; color:#333333;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="docs-internal-guid-f4b50e7b-7e33-2052-110e-9221a8afae4d"></a><span style=" font-family:'Arial'; font-size:x-large; font-weight:600; color:#000000; background-color:#ffffff;">C</span><span style=" font-family:'Arial'; font-size:x-large; font-weight:600; color:#000000; background-color:#ffffff;">OM классы платформы</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial'; font-size:large; font-weight:600; color:#000000; background-color:#ffffff;">Виды COM классов</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; color:#333333;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;">Для каждого издания платформы в системном реестре регистрируются собственные классы для взаимодействия с базами. Символ “X” обозначает место подстановки номера издания платформы (например 0,1,2,3,4).</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; color:#333333;"> </span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">V8X.ComСonnector - Com-соединитель / Менеджер COM-соединений</li>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 2;"><li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">С помощью данного объекта выполняется установка внешнего соединения с информационной базой 1С:Предприятия 8 и администрирование кластера серверов. С помощью одного экземпляра объекта может быть установлено неограниченное число соединений.</li>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Регистрация и отмена регистрации выполняется отдельно для каждой разрядности (32b и 64b)</li></ol>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 3;"><li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Регистрация: Regsvr32 “&lt;ПутьНужнойРазрядности&gt;\bin\comcntr.dll”</li>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Отмена регистрации: Regsvr32 “&lt;ПутьНужнойРазрядности&gt;\bin\comcntr.dll” /u</li></ol>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">V8X.Application - Automation-сервер толстого клиента</li>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 2;"><li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Предоставляет доступ ко всем свойствам и методам глобального контекста клиентского приложения, а также включение и выключение пользовательского интерфейса (главного окна приложения).</li>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Может запускать как обычное, так и управляемое приложение в зависимости от параметров конфигурации и пользователя базы, но явно задавать тип приложения нельзя.</li>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Регистрация и отмена регистрации</li></ol>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 3;"><li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Регистрация - 1cv8.exe /regserver</li>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Отмена регистрации - 1cv8.exe /unregserver</li></ol>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">V8Xc.Application - Automation-сервер тонкого клиента</li></ol>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 2;"><li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Предоставляет доступ ко всем свойствам и методам глобального контекста клиентского приложения, а также включение и выключение пользовательского интерфейса (главного окна приложения).</li>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Регистрация и отмена регистрации</li></ol>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 3;"><li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Регистрация - 1cv8c.exe /regserver</li>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Отмена регистрации - 1cv8c.exe /unregserver</li></ol>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial'; font-size:large; font-weight:600; color:#000000; background-color:#ffffff;">Привязка COM классов к dll-файлам</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; color:#333333;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;">Привязка имени COM класса к конкретному dll-файлу осуществляется через ветку HKEY_CLASSES_ROOT системного реестра, которая собирается </span><a href="http://infostart.ru/redirect.php?url=aHR0cHM6Ly9tc2RuLm1pY3Jvc29mdC5jb20vZW4tdXMvbGlicmFyeS93aW5kb3dzL2Rlc2t0b3AvbXM3MjQ0OTglMjh2PXZzLjg1JTI5LmFzcHg="><span style=" font-family:'Calibri'; text-decoration: underline; color:#1155cc; background-color:#ffffff;">следующим образом</span></a><span style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;">:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; color:#333333;"> </span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Берется содержимое ветки HKEY_CURRENT_USER\Software\Classes</li>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Добавляется содержимое ветки HKEY_LOCAL_MACHINE\Software\Classes, но только те ключи, которые отсутствуют в п.1.</li></ol>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; color:#333333;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;">Поэтому регистрация класса от имени пользователя имеет приоритет на общей регистрацией.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;"><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;">Для 32-b и 64-b режимов исполнения кода в реестре хранятся отдельные ветки и соответственно отдельные привязки. Поэтому управление COM-классами для них осуществляется независимо. В частности это касается класса V8X.ComConnector (на 64-b операционной системе)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; color:#333333;"> </span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">64-b - c:\Program Files\1cv8*\&lt;Версия&gt;\bin\comcntr.dll</li>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">32-b - c:\Program Files (x86)\1cv8*\&lt;Версия&gt;\bin\comcntr.dll</li></ol>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial'; font-size:x-large; font-weight:600; color:#000000; background-color:#ffffff;">Подключение внешнего соединения</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;">Рассмотрим алгоритм подключения внешнего соединения в деталях</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Создание COM-объекта Com-соединитель (Имя класса - V8X.ComConnector). Варианты:</li></ol>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 3;"><li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:-72px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Внутрипроцессное (inproc)</li>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 4;"><li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:-72px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Должен быть зарегистрирован класс V8X.ComConnector той же разрядности, что и COM-клиент</li>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 5;"><li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:-72px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Если издание платформы COM-клиента совпадает с изданием платформы COM-сервера, то также требуется равенство сборки платформы COM-клиента и COM-сервера.</li>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:-72px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Он регистрируется при установке платформы с опцией «Внешнее соединение». В любой момент его можно зарегистрировать командой «Regsvr32 comcntr.dll» в каталоге исполняемых файлов платформы.</li></ol>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:-72px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">COM-объект создается в памяти COM-клиента</li>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:-72px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Затраты на создание примерно – 0.01(первое)/0.001(второе) cек</li>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:-72px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Пример <br /><span style=" color:#0000ff;">КомСоединитель </span><span style=" color:#ff0000;">= Новый</span><span style=" color:#0000ff;"> COMОбъект</span><span style=" color:#ff0000;">(</span><span style=" color:#0000ff;">“V83</span><span style=" color:#ff0000;">.</span><span style=" color:#0000ff;">ComConnector”</span><span style=" color:#ff0000;">);</span><span style=" color:#0000ff;"><br />ВнешнееСоединение </span><span style=" color:#ff0000;">=</span><span style=" color:#0000ff;"> КомСоединитель</span><span style=" color:#ff0000;">.</span><span style=" color:#0000ff;">Connect</span><span style=" color:#ff0000;">(</span><span style=" color:#0000ff;">СтрокаСоединения</span><span style=" color:#ff0000;">);</span></li></ol>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:-72px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Внепроцессное локальное (local)</li>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 4;"><li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:-72px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Должен быть зарегистрирован класс V8X.ComConnector любой разрядности и сборки платформы. Необходимо настроить через dcomcnfg.exe COM+ приложение с активацией «серверное приложение»/«Server apllication». Подробнее рассмотрено далее.</li>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:-72px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">COM-объект создается в памяти служебного хост-процесса (dllhost.exe) на компьютере COM-клиента</li>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:-72px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Затраты на создание примерно – 0.06(первое)/0.03(второе) сек</li>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:-72px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Пример <br /><span style=" color:#0000ff;">КомСоединитель </span><span style=" color:#ff0000;">= Новый</span><span style=" color:#0000ff;"> COMОбъект</span><span style=" color:#ff0000;">(</span><span style=" color:#0000ff;">“V83</span><span style=" color:#ff0000;">.</span><span style=" color:#0000ff;">ComConnector”</span><span style=" color:#ff0000;">);</span><span style=" color:#0000ff;"><br />ВнешнееСоединение </span><span style=" color:#ff0000;">=</span><span style=" color:#0000ff;"> КомСоединитель</span><span style=" color:#ff0000;">.</span><span style=" color:#0000ff;">Connect</span><span style=" color:#ff0000;">(</span><span style=" color:#0000ff;">СтрокаСоединения</span><span style=" color:#ff0000;">);</span></li></ol>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:-72px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Внепроцессное нелокальное (DCOM)</li></ol>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 4;"><li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:-72px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">На нелокальном компьютере должен быть зарегистрирован класс V8X.ComConnector любой разрядности и сборки платформы. Необходимо настроить на нелокальном компьютере через dcomcnfg.exe COM+ приложение с активацией «Cерверное приложение»/«Server apllication». Подробнее рассмотрено далее.</li>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:-72px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Необходимо настроить на нелокальном компьютере роль «Сервер приложений»/«Application server» и включить нелокальный доступ к COM+, выбрав опцию «Сетевой доступ к COM+»/”COM+ network access”. Подробнее рассмотрено далее.</li>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:-72px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">COM-объект создается в памяти служебного хост-процесса (dllhost.exe) на другом компьютере</li>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:-72px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Затраты на создание примерно</li></ol>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image4597.png" /><span style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;"><br />На графике видно, что длительность создания этого COM-объекта прямо пропорциональна задержке канала и коэффициент пропорциональности составляет  примерно 24. Можно предположить, что при создании этого COM-объекта происходит 24 вызова через канал.</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 4;"><li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:-72px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Пример<br /><span style=" color:#0000ff;">КомСоединитель </span><span style=" color:#ff0000;">= Новый</span><span style=" color:#0000ff;"> COMОбъект</span><span style=" color:#ff0000;">(</span><span style=" color:#0000ff;">“V83</span><span style=" color:#ff0000;">.</span><span style=" color:#0000ff;">ComConnector”</span><span style=" color:#ff0000;">,</span><span style=" color:#0000ff;"> ИмяКомпьютера</span><span style=" color:#ff0000;">);</span><span style=" color:#0000ff;"><br />ВнешнееСоединение </span><span style=" color:#ff0000;">=</span><span style=" color:#0000ff;"> КомСоединитель</span><span style=" color:#ff0000;">.</span><span style=" color:#0000ff;">Connect</span><span style=" color:#ff0000;">(</span><span style=" color:#0000ff;">СтрокаСоединения</span><span style=" color:#ff0000;">);</span></li></ol>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;">         2. Выполнение метода Connect (создание внешнего соединения)</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 3;"><li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:-72px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Создание сеанса – 1 сек</li>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:-72px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Инициализация сеанса – [0;?] сек</li></ol>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 4;"><li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:-72px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Подгрузка нужных метаданных (кэш метаданных не используется)</li>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:-72px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Инициализация параметров сеанса</li>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:-72px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Событие ПриНачалеРаботыСистемы</li></ol>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="docs-internal-guid-b3e40d21-e04a-ba8b-3bf6-48ae16188ad1"></a><span style=" font-family:'Arial'; font-size:x-large; font-weight:600; color:#000000; background-color:#ffffff;">П</span><span style=" font-family:'Arial'; font-size:x-large; font-weight:600; color:#000000; background-color:#ffffff;">одключение Automation-сервера (OLE)</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Создание COM-объекта Automation-сервера (Имя класса - V8X.Application).</li>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 2;"><li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Затраты на создание примерно – 0.5 cек</li></ol>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Выполнение метода Connect</li>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 2;"><li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Создание сеанса – 1 сек</li>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Инициализация сеанса – [0;?] сек</li></ol>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 3;"><li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Подгрузка нужных метаданных (кэш метаданных используется, если база есть в списке пользователя)</li>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Инициализация параметров сеанса</li>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">ПередНачаломРаботыСистемы</li>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">ПриНачалеРаботыСистемы</li></ol>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Пример<br /><span style=" color:#0000ff;">AutomationСервер </span><span style=" color:#ff0000;">= Новый</span><span style=" color:#0000ff;"> COMОбъект</span><span style=" color:#ff0000;">(</span>&quot;V83.Application&quot;<span style=" color:#ff0000;">);</span><span style=" color:#0000ff;"><br />AutomationСервер</span><span style=" color:#ff0000;">.</span><span style=" color:#0000ff;">Connect</span><span style=" color:#ff0000;">(</span><span style=" color:#0000ff;">СтрокаСоединения</span><span style=" color:#ff0000;">);</span></li></ol>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; color:#333333;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial'; font-size:x-large; font-weight:600; color:#000000; background-color:#ffffff;">Затраты на COM-вызовы</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;">Каждый раз, когда мы обращаемся во встроенном языке к свойству или методу COM-объекта (выполняем COM-вызов), происходит ряд дополнительных действий по сравнению с обращением к родному объекту встроенного языка. Если COM-сервер находится в другом локальном процессе, то при этом еще сначала выполняется перенос всех параметров из COM-клиента в COM-сервер и в конце выполняется обратный перенос параметров в COM-клиент. Для такого переноса информация естественно должна быть сериализована на стороне отправителя и  затем десериализована на стороне получателя, что в совокупности с некоторыми другими действиями получило название маршалинга и демаршалинга. В нелокальном режиме (DCOM) такой перенос будет еще тратить время на сетевые коммуникации и при первом обращении к новому COM-объекту на передачу его «скелета», и поэтому задержка канала будет играть решающую роль (</span><a href="http://infostart.ru/redirect.php?url=aHR0cDovL3d3dy5kZXZlbG9waW5nLnJ1L2NvbS9iZW5lZml0X29mX3ZpY2UuaHRtbA=="><span style=" font-family:'Calibri'; text-decoration: underline; color:#0000ff; background-color:#ffffff;">Подробнее о COM вызовах</span></a><span style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;">, </span><a href="http://infostart.ru/redirect.php?url=aHR0cHM6Ly9ydS53aWtpcGVkaWEub3JnL3dpa2kvRENPTQ=="><span style=" font-family:'Calibri'; text-decoration: underline; color:#0000ff; background-color:#ffffff;">DCOM в википедии</span></a><span style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;">, </span><a href="http://infostart.ru/redirect.php?url=aHR0cDovL3d3dy5pbnRlcmZhY2UucnUvbWFnYXppbmUvdGNzL0FyY2hpdmUvMTk4L0RDT00vZGNvbS5odG0="><span style=" font-family:'Calibri'; text-decoration: underline; color:#0000ff; background-color:#ffffff;">Технический обзор DCOM</span></a><span style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;">,)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial'; font-size:large; font-weight:600; color:#000000; background-color:#ffffff;">Соотношение затрат на вызов по типам расположения COM-сервера</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Минимальные для внутрипроцессного Com-сервера</li></ol>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Средние для локального внепроцессного Com-сервера</li>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">От средних до больших для нелокального внепроцессного Cоm-сервера в зависимости от качества канала связи</li></ol>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial'; font-size:large; font-weight:600; color:#000000; background-color:#ffffff;">Минимизация количества COM-вызовов</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Создаем базовую внешнюю обработку с набором общих методов для приема вызовов от COM-клиента на стороне COM-сервера</li>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 2;"><li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Теперь нам не нужно изменять конфигурацию базы COM-сервера, чтобы использовать там сложный функционал.</li>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В нашем продукте мы назвали ее «Сервисный процессор». На ее передачу и инициализацию уходит около 1 сек</li>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Пример универсальной передачи файла в COM-сервер<br /><span style=" color:#0000ff;">ДвоичныеДанные = Новый ДвоичныеДанные(ИмяФайлаЛокальное);</span><br /><span style=" color:#0000ff;">ЗаписьХмл = Новый ЗаписьXML;</span><br /><span style=" color:#0000ff;">ЗаписьХмл.УстановитьСтроку();</span><br /><span style=" color:#0000ff;">ЗаписатьXML(ЗаписьХмл, ДвоичныеДанные);</span><br /><span style=" color:#0000ff;">ЧтениеХмлНаСервере = COMСервер.NewObject(&quot;ЧтениеXML&quot;);</span><br /><span style=" color:#0000ff;">ЧтениеХмлНаСервере.УстановитьСтроку(ЗаписьХмл.Закрыть());</span><br /><span style=" color:#0000ff;">ДвоичныеДанныеНаСервере = COMСервер.ПрочитатьXML(ЧтениеХмлНаСервере);</span><br /><a name="docs-internal-guid-62ed4d81-c67d-b905-d8cc-35f8e48eedfe"></a><span style=" color:#0000ff;">И</span><span style=" color:#0000ff;">мяФайлаНаCOMСервере = COMСервер.ПолучитьИмяВременногоФайла(Файл.Расширение);</span><br /><span style=" color:#0000ff;">ДвоичныеДанныеНаСервере.Записать(</span><a name="docs-internal-guid-62ed4d81-c67d-b905-d8cc-35f8e48eedfe"></a><span style=" color:#0000ff;">И</span><span style=" color:#0000ff;">мяФайлаНаCOMСервере);</span></li>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Пример вызова обработки<span style=" color:#0000ff;"><br />COMОбработка </span><span style=" color:#ff0000;">=</span><span style=" color:#0000ff;"> COMСервер</span><span style=" color:#ff0000;">.</span><span style=" color:#0000ff;">ВнешниеОбработки</span><span style=" color:#ff0000;">.</span><span style=" color:#0000ff;">Создать</span><span style=" color:#ff0000;">(</span><a name="docs-internal-guid-62ed4d81-c67d-b905-d8cc-35f8e48eedfe"></a><span style=" color:#0000ff;">И</span><span style=" color:#0000ff;">мяФайлаНаCOMСервере,</span><span style=" color:#ff0000;"> Ложь);</span><span style=" color:#0000ff;"><br />Результат </span><span style=" color:#ff0000;">=</span><span style=" color:#0000ff;"> COMОбработка</span><span style=" color:#ff0000;">.</span><span style=" color:#0000ff;">МойМетод</span><span style=" color:#ff0000;">(</span><span style=" color:#0000ff;">ПараметрыXML</span><span style=" color:#ff0000;">);</span></li></ol>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Проектируем взаимодействие с COM-сервером по принципу &quot;минимум COM-вызовов”, т.е. готовим все нужное на стороне COM-клиента и передаем в качестве параметров &quot;большого&quot; вызова</li></ol>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 2;"><li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Создаем встроенную обработку для выполнения такого вызова в COM-клиенте</li>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Передача агрегатных объектов</li>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 3;"><li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Сериализуем все входные параметры на стороне COM-клиента</li>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Десериализуем все входные параметры на стороне COM-сервера</li>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Выполняем действия с параметрами на стороне COM-сервера<br /></li>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Сериализуем все выходные параметры на стороне COM-сервера</li>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Десериализуем все выходные параметры на стороне COM-клиента</li></ol>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В нашем продукте мы назвали ее «Выполнение сервиса инфобазы»</li></ol>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Для многократных COM-вызовов предусматриваем регулируемую частоту</li></ol>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 2;"><li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Например, информационные вызовы могут выполняться с изменяемой частотой</li></ol>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial'; font-size:x-large; font-weight:600; color:#000000; background-color:#ffffff;">Обратная связь</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;">При использовании принципа «минимум COM-вызовов» значительную часть времени код будет выполняться в чужом контексте, что серьезно усиливает некоторые неудобства COM-вызовов:</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Нельзя прервать поток COM-Клиента и его соединение с сервером приложений 1С, пока не завершится вызов COM-сервера</li>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">У COM-Клиента нет информации о прогрессе выполнения вызова в COM-сервере</li></ol>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;">Для борьбы с этими неудобствами можно организовать обратную связь от COM-сервера к COM-клиенту, передав COM-Серверу ссылку на общий модуль COM-клиента и периодически вызывая через нее COM-клиент. Нужно отметить, что есть ошибки платформы (</span><a href="http://infostart.ru/redirect.php?url=aHR0cHM6Ly9wYXJ0bmVycy52OC4xYy5ydS9mb3J1bS90LzEzODI0NjUvbS8xMzgyNDY1"><span style=" font-family:'Calibri'; text-decoration: underline; color:#0000ff; background-color:#ffffff;">https://partners.v8.1c.ru/forum/t/1382465/m/1382465</span></a><span style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;"> ), проявляющиеся при создании ссылок на один общий модуль более чем в одном COM-севере сеанса. Поэтому пока лучше очищать ссылки на общий модуль во всех удерживаемых COM-серверах перед помещением в новый. В обратных вызовах можно передавать:</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">информацию о прогрессе выполнения</li></ol>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="docs-internal-guid-a6c84c01-6f9e-e83d-02c6-4fa604447e6c"></a><span style=" font-family:'Calibri'; color:#000000;">н</span><span style=" font-family:'Calibri'; color:#000000;">акопленные сообщения пользователю (получать функцией ПолучитьСообщенияПользователю(Истина))<br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial'; font-size:x-large; font-weight:600; color:#000000; background-color:#ffffff;">Схема принципа “минимум COM-вызовов”</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image17835.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="https://lh6.googleusercontent.com/uOEL1v9lrvTxsrhjjxAuVCQ6fvxWtIwGhC2XF8k7FtnGJoqnzwRBV9Lp5OxCBvrvjjOZB1oZRHTeK-anU1nKP3ZSPO_5GsBRQp5JpuFJNdvJaUp-tVRHgC0JkFfpubxYMy_Q12TwTT_-JPj3" width="-2" height="-2" style="vertical-align: middle;" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;">Такая схема дружественна к большим задержкам каналов связи. Поэтому она во многом похожа на вызов веб-сервиса. А следовательно используя ее для COM взаимодействия, вы значительно снижаете затраты на возможные переходы между COM и веб-сервисом в обоих направлениях.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial'; font-size:x-large; font-weight:600; color:#000000; background-color:#ffffff;">Отладка</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;">При использовании принципа «минимум COM-вызовов» облегчить отладку выполнения кода на COM-сервере можно, сделав опциональное модальное окно подключения к базе в COM-клиенте. В этом окне должны быть возможности задания одноразовых параметров подключения, выполнения вспомогательных функций и просмотра информации о подключенном сеансе. Ниже в качестве примера показано такое окно из нашего продукта</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image4094.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;">Чтобы включить возможность отладки внешних соединений, в подкаталоге conf нужно создать файл </span><a href="http://infostart.ru/redirect.php?url=aHR0cDovL2l0cy4xYy5ydS9kYi92OGRvYyNjb250ZW50OjgwOjE6aXNzb2dsNF8yNi4xLjEuMS4zLiVEMCVCRSVEMSU4MiVEMCVCQiVEMCVCMCVEMCVCNCVEMCVCQSVEMCVCMCVEMCVCMiVEMCVCRCVEMCVCNSVEMSU4OCVEMCVCRCVEMCVCNSVEMCVCMyVEMCVCRSVEMSU4MSVEMCVCRSVEMCVCNSVEMCVCNCVEMCVCOCVEMCVCRCVEMCVCNSVEMCVCRCVEMCVCOCVEMSU4Rg=="><span style=" font-family:'Calibri'; text-decoration: underline; color:#0000ff; background-color:#ffffff;">comcntrcfg.xml</span></a><span style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;"> с соответствующим содержимым. В окне подключения можно сделать кнопку/флажок для программного создания такого файла. Однако много версий платформы содержат ошибку, из-за которой предметы отладки внешних соединений не видны в отладчике даже с этим корректно настроенным файлом. </span><a name="docs-internal-guid-619b683a-1d40-a5a8-bb6c-d951c31f50e8"></a><span style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;">Н</span><span style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;">а платформе 8.3 эти проблемы вроде бы решены.<br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;"><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;">Пример файла comcntrcfg.xml:<br /></span><span style=" color:#000000; background-color:#ffffff;">&lt;config xmlns=&quot;http://v8.1c.ru/v8/comcntrcfg&quot;&gt;<br />   &lt;debugconfig debug=&quot;true&quot; debuggerURL=&quot;tcp://localhost:1560&quot;/&gt;<br />&lt;/config&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#000000; background-color:#ffffff;"><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="docs-internal-guid-39b51a0d-1c9e-25ae-c170-6b6ffa09459c"></a><span style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;">Т</span><span style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;">акже нельзя забывать о необходимости запускать конфигуратор для отладки с той же (до регистра букв) строкой соединения, что и предмет отладки. Поэтому в этом диалоге нужно сделать кнопку для запуска конфигуратора COM-сервера с правильной строкой соединения.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;"><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;">В какой-то мере обойти проблему невидимости предмета отладки внешнего соединения и ряд других неудобств можно путем однократного выполнения кода  на толстом клиенте с заменой режима «Внешнее соединение» на «Automation-сервер» (приложение), т.е. используя COM класс V8X.Application и включенную видимость. Поэтому в окне подключения нужны параметры для выбора режима подключения.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;"><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;">После создания подключения на стороне COM-клиента обычно требуется подключение отладчика базы COM-сервера и установка там точки останова в нужном месте. Поэтому в окне подключения нужно расположить кнопку подключения отладчика/конфигуратора COM-сервера. Если COM-сервер запущен в режиме видимого приложения, то для подключения отладчика можно воспользоваться асинхронным вызовом исключения в нем. Из диалога с ошибкой в приложении COM-сервера через кнопку «Конфигуратор» можно будет открыть конфигуратор и в большинстве случаев сразу подключить отладчик. Если подключение отладчика таким способом недоступно, то оператору поможет отображение информации о сеансе (его номера) в базе COM-сервера. Также нужна кнопка открытия в открытом отладчике файла внешней обработки, которая будет выполняться в нем.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="docs-internal-guid-2bbb6910-7e34-8126-5b29-1d5ccd8791eb"></a><span style=" font-family:'Arial'; font-size:x-large; font-weight:600; color:#000000; background-color:#ffffff;">У</span><span style=" font-family:'Arial'; font-size:x-large; font-weight:600; color:#000000; background-color:#ffffff;">правление COM+ приложениями 1С</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; color:#333333;">Осуществляется через оснастку dcomcnfg.exe. Для регистрации 1С в качестве COM+ приложения необходимо открыть оснастку &quot;dcomcnfg&quot;. В ней в ветке &quot;Службы компонентов&quot;-&quot;Компьютеры&quot;-&quot;Мой компьютер&quot;-&quot;Приложения COM+&quot;(COM+ Applications) необходимо добавить новое приложение (application). При добавлении можно указать любое имя. Далее необходимо указать пользователя, от имени которого будет работать COM+ приложение, на закладке Идентификация (Identity). Также нужно задать доступ к приложению для нужных пользователей путем добавления, если отсутствует, роли с любым именем в ветке Роли (Roles), и добавления в ее ветку Пользователи (Users) пользователя &quot;Прошедшие проверку&quot; (Authenticated Users). После добавления приложения необходимо создать новую компоненту. Для этого в ветке &quot;Компоненты&quot; созданного приложения необходимо выбрать пункт меню &quot;Создать&quot;-&quot;Компонент&quot;. При создании выбрать импорт уже зарегистрированных компонентов и найдите в списке (желательно 64-битную) компоненту 1С (V8x.COMConnector.1). Подробнее о настройке COM+ приложений читайте </span><a href="http://infostart.ru/redirect.php?url=aHR0cHM6Ly90ZWNobmV0Lm1pY3Jvc29mdC5jb20vcnUtcnUvbGlicmFyeS9jYzc0MjQ3Ni5hc3B4"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; text-decoration: underline; color:#428bca;">Интерфейс пользователя: службы компонентов</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; color:#333333;"><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="data:image/png;base64,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" style="vertical-align: middle;" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="docs-internal-guid-9bfcc3c1-1c8a-609d-c98c-821e637872c0"></a><span style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;">Д</span><span style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;">алее можно изменить тип активации (внутрипроцессный/внепроцессный) на закладке Активация/Activation.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image22677.png" /><span style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;"><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;">В нашем продукте имеется инструмент «Управление COM классами 1С» для просмотра/регистрации/изменения всех COM классов и COM+ приложений 1С на указанном компьютере:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image16463.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="https://lh4.googleusercontent.com/4qILN4i06H2yk_FidsTrAOgwMI91sIHH7hs11OsHFKzzatx7r8_o4CjCJ8RFMPJWgSws0jGI05dR9qpxAX2HJ_jXJ8WMIcXcJ343HOR9N3XZ88AZSoSDtTk6oo2Cpbffa69D7uX1" width="-2" height="-2" style="vertical-align: middle;" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial'; font-size:x-large; font-weight:600; color:#000000; background-color:#ffffff;">Настройка DCOM-сервера</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman'; color:#000000; background-color:#ffffff;">Для Windows 2008 Server нужно добавить роль «Сервер приложений» (Application server). Для этого необходимо открыть панель управления компьютером, щелкнуть правой кнопкой мыши в ветки &quot;Роли&quot; и выбрать пункт меню &quot;Добавить роль&quot;.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image23569.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="https://lh3.googleusercontent.com/ztkY91VMGQSD2wE_9VvH5JjS6hCXQ5U5tf9r7RY_aify3MQZCb3n42aQSlTx5-mQVVUtyqilNeDz6OCi4YYhIiJJ6uvhz7terKuTFkTWqkdyP7-9g6UradhG_eraB92hWan6UccU5nDG-vKt" width="-2" height="-2" style="vertical-align: middle;" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;">Появится око в котором необходимо выбрать роль &quot;Сервер приложений&quot;/&quot;Application server&quot;. На этапе выбора ролей сервера приложений необходимо указать пункт &quot;Сетевой доступ к COM+&quot;/&quot;COM+ network access&quot;. Если это не сделать, то при попытке создания COM-объекта вы будете получать ошибку &quot;Ошибка при вызове конструктора (COMОбъект): The component or application containing the component has been disabled&quot;.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; color:#333333;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="docs-internal-guid-a6c84c01-a111-cfe9-ab0c-967715ecd941"></a><span style=" font-family:'Arial'; font-size:large; font-weight:600; color:#000000; background-color:#ffffff;">Н</span><span style=" font-family:'Arial'; font-size:large; font-weight:600; color:#000000; background-color:#ffffff;">астройка сетевого экрана</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="docs-internal-guid-a6c84c01-a11a-daf5-55d2-1d8a54ebac42"></a><span style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;">D</span><span style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;">COM процессам для связи между собой динамически выдаются порты из диапазона (по умолчанию) от 1024 до 65535. Поэтому в сетевых экранах обоих компьютеров (com-клиента и com-сервера) должны быть открыты порты RPC (135, 139, 445, 593) и диапазон 1024-65535 (TCP/UDP).</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;">Можно ограничить этот диапазон портов. Для этого открываем Администрирование – Службы компонентов (или в командной строке набираем dcomcnfg.exe). В открывшейся программе находим ветку «Мой компьютер» и открываем её свойства (см. скриншот).</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image2467.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="https://lh5.googleusercontent.com/k9vSvk0pO1ONGX8xEtjV8JDeg2y3mriy1pvIe_fsOswxWoSFoCMIT-4FoU9xjBEGqGfchVKvYT4RbtuGxGYS_9ArHxILIRbsSjnqCPOq8TsZa1R7GqZdia95JY2iRa94vY6cbjtf" width="-2" height="-2" style="vertical-align: middle;" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;">В свойствах открываем вкладку «Набор протоколов», там, в свою очередь, открываем свойства «TCP/IP с ориентацией на подключения»</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image20821.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="https://lh5.googleusercontent.com/zcwV9rj0KTQqZd9xAEkZdnUCbvsD2w5x0x4yYWYBTTL8A7F_w2kxH_EDRWELxdCmk_LFX-6sK4osQK9PHLim0ZWtgm6uywncRMdvfVVdbQ6FhbiWQVzyCfa7VUHK5WYdxOc_MQBS" width="-2" height="-2" style="vertical-align: middle;" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;">В свойствах TCP/IP по умолчанию – пустой список. В него можно добавить конкретный диапазон портов, которые будут использоваться DCOM. Какие именно порты выбрать – решать вам. Главное, чтобы не было других стандартных служб, уже занявших выбранные порты. Мне встречались рекомендации открывать не менее 1000 портов, так как очень многие системные программы используют DCOM. Так на скриншоте ниже я указываю, что DCOM должен работать по диапазону портов 20000-21000.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image20535.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="https://lh5.googleusercontent.com/3f-UxFl5ii1JnQ1WwBgAUG9m_5Yd-prZ7djYrajurtp9LddOic5ZRcGZmSWC_MQhKMMIMNMxANN3NjhgCJdvooZggoqXgGpQRUee9fGbQueVZ2p0dOxzDbPVDRqOqw1-_ja6oNCL" width="-2" height="-2" style="vertical-align: middle;" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;">После этого нужно перезагрузить компьютер (перезапустить отдельно DCOM нельзя, слишком много на него завязано), и DCOM станет работать только по указанным портам.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial'; font-size:x-large; font-weight:600; color:#000000; background-color:#ffffff;">Проблемы</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Высокие затраты на подключение/инициализацию</li>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 2;"><li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Удержание com-серверов – эффективное средство борьбы. Варианты:<br /></li></ol>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 3;"><li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Временное хранилище. Производитель не рекомендует, но деваться больше некуда. <a href="http://infostart.ru/public/331683/"><span style=" text-decoration: underline; color:#0000ff;">http://infostart.ru/public/331683/</span></a></li>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Повторное использование возвращаемых значений. Очищаются каждые 20 мин</li></ol>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><a name="docs-internal-guid-b3e40d21-4fa4-3152-a9ad-356531067ce5"></a><span style=" font-family:'Calibri'; color:#000000;">C</span><span style=" font-family:'Calibri'; color:#000000;">OM+ пулинг. </span><a href="http://infostart.ru/public/93643/"><span style=" font-family:'Calibri'; text-decoration: underline; color:#1155cc;">v82Server.dll - Технология Microsoft COM+ для доступа к 1C82</span></a></p>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Разные сборки платформы клиента и сервера при одинаковом издании платформы</li>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 2;"><li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Для обхода для каждой отличной от COM-клиента сборки платформы назначаем и настраиваем DCOM сервер</li></ol>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Отсутствие информации о типах вложенных в COM-объекты объектов 1С (вместо типа объекта 1С везде получаем тип «COMОбъект») и отсутствие контекстной подсказки по ним</li>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 2;"><li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Для обхода применяем принцип «минимум COM-вызовов»</li></ol>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">При передаче исключения из COM-сервера оно принимает краткую форму из-за ошибки платформы</li>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 2;"><li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Для обхода оборачиваем каждый вызов на стороне COM-сервера в попытку и в исключении перевызываем исключение с полным описанием ошибки</li></ol>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">При создании COM-объекта ошибка “Версия компоненты 'comcntr' (8.X.XX.XXX) отличается от версии корневого модуля 'core82' (8.X.YY.YYY)”</li>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 2;"><li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Для обхода создаем COM+ приложение с внепроцессной активацией. Тогда COM-сервер будет создаваться в отдельном процессе и совпадения версий этих модулей не потребуется.</li></ol>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Медленные каналы (большие задержки)</li>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 2;"><li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Каждой подсети за отдельным медленным каналом назначаем и настраиваем свой DCOM сервер и при обращении к базам за этим каналом COM-серверы создаем на этом компьютере, минимизируя количество и объемы вызовов Com-клиент&lt;-&gt;Com-сервер</li>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Кешируем (повторно используем) COM-серверы</li></ol>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Невозможно разорвать соединение рабочего процесса, в котором ожидается завершение вызова COM-сервера</li>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 2;"><li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Для обхода можно использовать создание COM-объектов в выделенных хост-процессах, настроив соответствующим образом COM+ приложение, и регистрировать идентификаторы этих процессов в привязке к сеансам COM-клиентов. Тогда при необходимости завершить серверное соединение такого сеанса можно сначала убить процесс COM-сервера, а потом и сам сеанс.</li></ol>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">При обращении к COM-объекту может возникать ошибка «Неизвестная ошибка». Возможные причины:</li>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 2;"><li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Com-сервер перестал существовать. Возможные причины:</li>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 3;"><li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Переполнение стека</li>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Невосстановимая ошибка</li>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Хост-процесс завершился</li></ol>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Потеря связи с нелокальным COM-сервером</li></ol>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Совпадение имен свойств и методов без параметров объекта создает неоднозначность обращения к ним через COM</li>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 2;"><li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Например, если у справочника есть реквизит ПолноеНаименование, то из-за наличия метода ПолноеНаименование() обращение к реквизиту ПолноеНаименование через COM может привести к вызову метода ПолноеНаименование()</li>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Для обхода используем принцип “минимум COM-вызовов”</li></ol>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">При создании COM-объекта через DCOM может возникать ошибка &quot;Сервер RPC недоступен&quot;</li></ol>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 2;"><li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Проверьте работу службы “Remote Procedure Call (RPC)” на обоих компьютерах</li>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Проверьте настройки сетевого экрана на обоих компьютерах</li></ol>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,Arial,Helvetica,sans-serif'; color:#333333;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial'; font-size:x-large; font-weight:600; color:#000000; background-color:#ffffff;">Com-технология VS веб-сервисы в локальной сети</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial'; font-size:x-large; font-weight:600; color:#000000; background-color:#ffffff;">Недостатки</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Рассмотренные выше сложности с взаимодействием разных сборок платформы 1C, требующие для своего решения сервисный механизм</li>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Высокие затраты на подключение/инициализацию, поэтому при отсутствии кеширования неэффективно для частых мелких вызовов</li>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Привязка к семейству операционных систем (платформе) Windows</li>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Требуется закрытая сеть (LAN, VPN)<br /></li></ol>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial'; font-size:large; font-weight:600; color:#000000; background-color:#ffffff;">Преимущества</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Отсутствие необходимости изменять конфигурацию баз, к которым подключаемся</li>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Широкая функциональность</li>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Проще отладка</li>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Не требуется разворачивать и поддерживать веб-сервер</li>
<li style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Программно доступен интерактивный режим подключенной базы<br /></li></ol>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial'; font-size:x-large; font-weight:600; color:#000000; background-color:#ffffff;">Захват клиентских лицензий</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;">В большинстве случаев всем клиентским приложениям, частным случаем которого являются Automation-сервер и внешнее соединение, в одном сеансе ОС требуется всего лишь одна на всех лицензия. Однако если клиентскому приложению не удалось получить аппаратную лицензию (от локального HASP или сетевого HASP) и программную лицензию (платформы или базовой конфигурации), то предпринимается попытка получить отдельную лицензию с сервера 1С:Предприятия. Сервер 1С:Предприятия может выдать лицензию только, если в свойствах базы разрешена выдача лицензий сервером 1С:Предприятия. В таком случае каждое клиентское приложение и внешнее соединение может захватывать свою собственную лицензию.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial'; font-size:x-large; font-weight:600; color:#000000; background-color:#ffffff;">Заключение</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;">Если вы хотите подробнее узнать об описанных особенностях, приобретайте продукт </span><a href="http://infostart.ru/public/464988/"><span style=" font-family:'Calibri'; text-decoration: underline; color:#0000ff; background-color:#ffffff;">2iS:Администратор</span></a><span style=" font-family:'Calibri'; color:#000000; background-color:#ffffff;">. Несмотря на наличие в конфигурации защищенного модуля, 99% программного кода конфигурации открыто, то есть Вы можете изучить реализацию описанных приемов.</span></p></body></html>