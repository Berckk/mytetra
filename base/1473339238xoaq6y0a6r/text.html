<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'Courier New'; font-size:12pt; font-weight:400; font-style:normal;">
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana'; color:#000000;">Раздел содержит описание некоторых особенностей передачи данных 1С:Предприятия через механизм COM/Automation.</span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="chapter1"></a><span style=" font-family:'Arial,Tahoma'; font-size:14pt; font-weight:600; color:#000000;">К</span><span style=" font-family:'Arial,Tahoma'; font-size:14pt; font-weight:600; color:#000000;">огда данные передаются через COM</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="chapter1"></a><span style=" font-family:'Verdana'; color:#000000;">П</span><span style=" font-family:'Verdana'; color:#000000;">ри использовании 1С:Предприятия совместно с другими программами или системами, а также при необходимости доступа к данным нескольких разных информационных баз 1С:Предприятия, могут использоваться средства модели межкомпонентного доступа к объектам (Component Object Model, COM). Ее главная идея заключается в предоставлении универсального средства создания и освобождения объектов, и универсального способа обращения к свойствам и методам объектов, включая передачу необходимых данных. Частным случаем реализации модели COM является Automation, определяющий универсальный интерфейс</span><span style=" font-family:'Verdana'; color:#000000;"> </span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">IDispatch</span><span style=" font-family:'Verdana'; color:#000000;"> для доступа к свойствам и методам объектов, а также универсальный способ передачи данных (структура </span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">VARIANT</span><span style=" font-family:'Verdana'; color:#000000;">).</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="chapter1"></a><span style=" font-family:'Verdana'; color:#000000;">1</span><span style=" font-family:'Verdana'; color:#000000;">С:Предприятие поддерживает средства Automation и тем самым позволяет:</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Verdana'; color:#000000;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="chapter1"></a>с одной стороны, использовать во встроенном языке 1С:Предприятия произвольные объекты, доступные через Automation на данном компьютере или в сети. Для этого во встроенном языке 1С:Предприятия может быть использован оператор &quot;Новый COMОбъект(&lt;идентификатор COM объекта&gt;)&quot;;</li>
<li style=" font-family:'Verdana'; color:#000000;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="chapter1"></a>с другой стороны, использовать объекты 1С:Предприятия при разработке других программ на различных языках программирования с применением различных инструментальных средств. Для этого 1С:Предприятие регистрирует объекты с идентификаторами: &quot;V8.Application&quot; - клиентское приложение 1С:Предприятия, &quot;V8.COMConnector&quot; - внешнее соединение 1С:Предприятия.</li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="chapter2"></a><span style=" font-family:'Verdana'; color:#000000;">О</span><span style=" font-family:'Verdana'; color:#000000;">бращения к свойствам объектов, а также передача значений входных и выходных параметров методов при помощи Automation предполагает универсальный способ представления передаваемых данных. Представление данных при помощи структуры VARIANT накладывает определенные ограничения на типы передаваемых данных и может создать определенные трудности при интерпретации получаемых данных.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="chapter2"></a><span style=" font-family:'Verdana'; color:#000000;">Н</span><span style=" font-family:'Verdana'; color:#000000;">абор типов данных, представимых структурой VARIANT, ограничен, и не охватывает всего многообразия типов данных, доступных в 1С:Предприятии. Ниже будут рассмотрены некоторые особенности передачи средствами COM (через структуру VARIANT) данных 1С:Предприятия различных типов.</span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="chapter1"></a><span style=" font-family:'Arial,Tahoma'; font-size:14pt; font-weight:600; color:#000000;">П</span><span style=" font-family:'Arial,Tahoma'; font-size:14pt; font-weight:600; color:#000000;">римитивные типы</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="chapter1"></a><span style=" font-family:'Verdana'; color:#000000;">З</span><span style=" font-family:'Verdana'; color:#000000;">начения</span><span style=" font-family:'Verdana'; color:#000000;"> </span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">NULL</span><span style=" font-family:'Verdana'; color:#000000;"> и </span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">Неопределено</span><span style=" font-family:'Verdana'; color:#000000;">, а также типы данных </span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">Число</span><span style=" font-family:'Verdana'; color:#000000;">, </span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">Строка</span><span style=" font-family:'Verdana'; color:#000000;">, </span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">Дата</span><span style=" font-family:'Verdana'; color:#000000;">, </span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">Булево</span><span style=" font-family:'Verdana'; color:#000000;">, определенные в 1С:Предприятии, считаются примитивными. Они представляются аналогичными типами, определенными в</span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">VARIANT</span><span style=" font-family:'Verdana'; color:#000000;">. Преобразование примитивных типов 1С:Предприятия в </span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">VARIANT</span><span style=" font-family:'Verdana'; color:#000000;"> представлено в таблице:</span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="631" cellspacing="0" cellpadding="3">
<tr>
<td colspan="2" bgcolor="#ffffee">
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana'; font-weight:600; background-color:#ffffee;">Тип в 1С:Преприятии</span></p></td>
<td width="159" bgcolor="#ffffee">
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana'; font-weight:600; background-color:#ffffee;">Тип VARIANT</span></p></td></tr>
<tr>
<td colspan="2">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana';">значение NULL</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana';">VT_NULL</span></p></td></tr>
<tr>
<td colspan="2">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana';">значение Неопределено</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana';">VT_EMPTY</span></p></td></tr>
<tr>
<td width="228.5" rowspan="2">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana';">тип Число</span></p></td>
<td width="228.5">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana';">Целое в диапазоне от -2147483648 до 2147483647</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana';">VT_I4</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana';">Другие</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana';">VT_R8</span></p></td></tr>
<tr>
<td colspan="2">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana';">тип Строка</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana';">VT_BSTR</span></p></td></tr>
<tr>
<td colspan="2">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana';">тип Дата</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana';">VT_DATE</span></p></td></tr>
<tr>
<td colspan="2">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana';">тип Булево</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana';">VT_BOOL</span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="chapter1"></a><span style=" font-family:'Verdana'; color:#000000;">П</span><span style=" font-family:'Verdana'; color:#000000;">римитивные типы и значения, определенные в</span><span style=" font-family:'Verdana'; color:#000000;"> </span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">VARIANT</span><span style=" font-family:'Verdana'; color:#000000;">, преобразуются в примитивные типы и значения 1С:Предприятия в соответствии со следующей таблицей.</span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="631" cellspacing="0" cellpadding="3">
<tr>
<td width="438" bgcolor="#ffffee">
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana'; font-weight:600; background-color:#ffffee;">Тип VARIANT</span></p></td>
<td width="178" bgcolor="#ffffee">
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana'; font-weight:600; background-color:#ffffee;">Тип в 1С:Предприятии</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="chapter3"></a><span style=" font-family:'Verdana';">V</span><span style=" font-family:'Verdana';">T_NULL</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana';">значение NULL</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="chapter1"></a><span style=" font-family:'Verdana';">V</span><span style=" font-family:'Verdana';">T_EMPTY</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana';">значение Неопределено</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="chapter4"></a><span style=" font-family:'Verdana';">V</span><span style=" font-family:'Verdana';">T_I2, VT_I4, VT_R4, VT_R8, VT_CY, VT_ERROR, VT_DECIMAL, VT_I1, VT_UI1, VT_UI2, VT_UI4, VT_I8, VT_UI8, VT_INT, VT_UINT</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana';">тип Число</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana';">VT_BSTR</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana';">тип Строка</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana';">VT_DATE</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana';">тип Дата</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana';">VT_BOOL</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana';">тип Булево</span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="chapter1"></a><span style=" font-family:'Verdana'; color:#000000;">П</span><span style=" font-family:'Verdana'; color:#000000;">ри передаче через COM значение примитивного типа сохраняется, быть может, за исключением точности представления числа. Это значит, что, например, значение типа</span><span style=" font-family:'Verdana'; color:#000000;"> </span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">Строка</span><span style=" font-family:'Verdana'; color:#000000;">, после передачи через </span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">VARIANT</span><span style=" font-family:'Verdana'; color:#000000;">сколько угодно раз, никак не изменится, и любые операции над ней будут давать такой же результат, который они давали до передачи через </span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">VARIANT</span><span style=" font-family:'Verdana'; color:#000000;">.</span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="chapter1"></a><span style=" font-family:'Arial,Tahoma'; font-size:14pt; font-weight:600; color:#000000;">М</span><span style=" font-family:'Arial,Tahoma'; font-size:14pt; font-weight:600; color:#000000;">ассивы</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="chapter1"></a><span style=" font-family:'Verdana'; color:#000000;">В</span><span style=" font-family:'Verdana'; color:#000000;"> структуре</span><span style=" font-family:'Verdana'; color:#000000;"> </span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">VARIANT</span><span style=" font-family:'Verdana'; color:#000000;"> предусмотрен специальный тип - </span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">VT_ARRAY</span><span style=" font-family:'Verdana'; color:#000000;">, представляющий собой массив с несколькими измерениями и заданными диапазонами индексов по каждому из измерений. Он представляется специальной структурой </span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">SAFEARRAY</span><span style=" font-family:'Verdana'; color:#000000;">. Для совместимости с другими объектами, представленными в COM, в 1С:Предприятии предусмотрен специальный тип данных </span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">COMSafeArray</span><span style=" font-family:'Verdana'; color:#000000;">, в который преобразуется структура</span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">SAFEARRAY</span><span style=" font-family:'Verdana'; color:#000000;"> и наоборот.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="chapter1"></a><span style=" font-family:'Verdana'; color:#000000;">П</span><span style=" font-family:'Verdana'; color:#000000;">ри получении 1С:Предприятием структуры</span><span style=" font-family:'Verdana'; color:#000000;"> </span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">VARIANT</span><span style=" font-family:'Verdana'; color:#000000;">, содержащей данные </span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">VT_ARRAY</span><span style=" font-family:'Verdana'; color:#000000;">, она преобразуется в объект 1С:Предприятия </span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">COMSafeArray</span><span style=" font-family:'Verdana'; color:#000000;">. При необходимости передачи из 1С:Предприятия структуры</span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">VARIANT</span><span style=" font-family:'Verdana'; color:#000000;">, содержащей данные </span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">VT_ARRAY</span><span style=" font-family:'Verdana'; color:#000000;">, в 1С:Предприятии должен быть подготовлен соответствующий объект </span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">COMSafeArray</span><span style=" font-family:'Verdana'; color:#000000;">.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="chapter1"></a><span style=" font-family:'Verdana'; color:#000000;">В</span><span style=" font-family:'Verdana'; color:#000000;">ажно, что данные типа</span><span style=" font-family:'Verdana'; color:#000000;"> </span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">VT_ARRAY</span><span style=" font-family:'Verdana'; color:#000000;"> являются аналогом примитивных типов в том смысле, что выступают в качестве значений, а не ссылок. В частности, преобразование структуры </span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">VARIANT</span><span style=" font-family:'Verdana'; color:#000000;"> в </span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">COMSafeArray</span><span style=" font-family:'Verdana'; color:#000000;"> приводит к копированию всех содержащихся в ней данных, и наоборот.</span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="chapter1"></a><span style=" font-family:'Arial,Tahoma'; font-size:14pt; font-weight:600; color:#000000;">О</span><span style=" font-family:'Arial,Tahoma'; font-size:14pt; font-weight:600; color:#000000;">бъектные типы</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="chapter1"></a><span style=" font-family:'Verdana'; color:#000000;">В</span><span style=" font-family:'Verdana'; color:#000000;">се остальные типы данных, определенные в 1С:Предприятии, в том числе и коллекции значений, являются объектами и преобразуются к типу</span><span style=" font-family:'Verdana'; color:#000000;"> </span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">VT_DISPATCH</span><span style=" font-family:'Verdana'; color:#000000;"> структуры </span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">VARIANT</span><span style=" font-family:'Verdana'; color:#000000;">.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="chapter1"></a><span style=" font-family:'Verdana'; color:#000000;">С</span><span style=" font-family:'Verdana'; color:#000000;"> другой стороны, при получении 1С:Предприятием значения</span><span style=" font-family:'Verdana'; color:#000000;"> </span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">VARIANT</span><span style=" font-family:'Verdana'; color:#000000;"> типа </span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">VT_DISPATCH</span><span style=" font-family:'Verdana'; color:#000000;">, оно будет преобразовано в значение типа </span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">COMОбъект</span><span style=" font-family:'Verdana'; color:#000000;">, набор свойств и методов которого будет совпадать с набором свойств и методов объекта, указатель на который содержался в </span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">VARIANT</span><span style=" font-family:'Verdana'; color:#000000;"> типа </span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">VT_DISPATCH</span><span style=" font-family:'Verdana'; color:#000000;">. Работа с таким объектом может выполняться только через предоставляемые им свойства и методы, кроме оператора </span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">Для Каждого ...</span><span style=" font-family:'Verdana'; color:#000000;">.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="chapter1"></a><span style=" font-family:'Verdana'; color:#000000;">О</span><span style=" font-family:'Verdana'; color:#000000;">днако, в том случае, если 1С:Предприятие узнает в нем &quot;свой&quot; объект,</span><span style=" font-family:'Verdana'; color:#000000;"> </span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">VT_DISPATCH</span><span style=" font-family:'Verdana'; color:#000000;"> будет обратно преобразован в исходный объект 1С:Предприятия и его можно будет использовать так, как любой другой объект 1С:Предприятия этого же типа (оператор </span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">Для Каждого ...</span><span style=" font-family:'Verdana'; color:#000000;">, обращения по индексу, встроенные функции </span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">Строка()</span><span style=" font-family:'Verdana'; color:#000000;">, </span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">Тип()</span><span style=" font-family:'Verdana'; color:#000000;"> и т.д.).</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="chapter1"></a><span style=" font-family:'Verdana'; color:#000000;">1</span><span style=" font-family:'Verdana'; color:#000000;">С:Предприятие или COM-соединение, подсоединенное к некоторой информационной базе,  распознает объект как &quot;свой&quot; только в том случае, если он был создан этим же подсоединением к информационной базе. Например, если из COM-соединения получить элемент справочника и передать этот элемент справочника в качестве параметра какого-нибудь метода объекта, полученного из этого же COM-соединения, то при выполнении этого метода объект будет распознан как &quot;свой&quot;. Объект, полученный из другого соединения с информационной базой, не будет распознан как &quot;свой&quot;.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="chapter1"></a><span style=" font-family:'Verdana'; color:#000000;">Т</span><span style=" font-family:'Verdana'; color:#000000;">акое поведение объектов 1С:Предприятия объясняется тем, что большинство объектов 1С:Предприятия используют свой экземпляр контекста информационной базы, из которой они получены, и в другом экземпляре контекста информационной базы они &quot;своими&quot; не являются. Каждое приложение 1С:Предприятия и каждый экземпляр COM-соединения поддерживает свой экземпляр контекста информационной базы. Поэтому объекты 1С:Предприятия не распознаются как &quot;свои&quot; не в том приложении 1С:Предприятия или экземпляре COM-соединения, в котором они были созданы.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="chapter1"></a><span style=" font-family:'Verdana'; color:#000000;">В</span><span style=" font-family:'Verdana'; color:#000000;"> Automation (интерфейс</span><span style=" font-family:'Verdana'; color:#000000;"> </span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">IDispatch</span><span style=" font-family:'Verdana'; color:#000000;">) не предусмотрено штатных средств для реализации обращений к элементам массивов по индексам. Предусмотренные в Automation индексированные свойства допускают неоднозначность толкования и не поддерживаются встроенным языком 1С:Предприятия. Это значит, что для коллекций значений, не опознанных 1С:Предприятием как &quot;свои&quot; объекты, невозможно обращение к элементам по индексам из встроенного языка 1С:Предприятия. Однако, многие коллекции, в том числе и коллекции, определенные в 1С:Предприятии, поддерживают специальный интерфейс </span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">IEnumVARIANT</span><span style=" font-family:'Verdana'; color:#000000;">, позволяющий совершить последовательный обход всех элементов коллекции. Этот механизм используется оператором </span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">Для Каждого ...</span><span style=" font-family:'Verdana'; color:#000000;">, который имеется во многих языках программирования, в том числе и во встроенном языке 1С:Предприятия. Этот же механизм используется встроенным отладчиком 1С:Предприятия, когда он показывает элементы коллекции.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana'; color:#000000;">Для удобства обращения к элементам коллекций, определенных в 1С:Предприятии, после передачи коллекции через </span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">VARIANT</span><span style=" font-family:'Verdana'; color:#000000;"> в большинстве коллекций значений (</span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">Массив</span><span style=" font-family:'Verdana'; color:#000000;">, </span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">ТаблицаЗначений</span><span style=" font-family:'Verdana'; color:#000000;">, </span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">Структура</span><span style=" font-family:'Verdana'; color:#000000;"> и другие) предусмотрены методы </span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">Получить()</span><span style=" font-family:'Verdana'; color:#000000;"> и </span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">Установить()</span><span style=" font-family:'Verdana'; color:#000000;">, действие которых аналогично обращению к элементам коллекций по индексам.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana'; color:#000000;">Например, если переменная &quot;ПолученныйМассив&quot; содержит объект типа </span><span style=" font-family:'Verdana'; font-weight:600; color:#000000;">Массив</span><span style=" font-family:'Verdana'; color:#000000;">, то оператор</span></p>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#0000ff; background-color:#f0f0f0;">Элемент </span><span style=" font-size:10pt; color:#ff0000;">=</span><span style=" font-size:10pt; color:#0000ff;"> ПолученныйМассив</span><span style=" font-size:10pt; color:#ff0000;">.</span><span style=" font-size:10pt; color:#0000ff;">Получить</span><span style=" font-size:10pt; color:#ff0000;">(</span><span style=" font-size:10pt; color:#000000;">5</span><span style=" font-size:10pt; color:#ff0000;">);</span><span style=" font-size:10pt; color:#0000ff;"> </span></pre>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana'; color:#000000;">аналогичен оператору</span></p>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#0000ff; background-color:#f0f0f0;">Элемент </span><span style=" font-size:10pt; color:#ff0000;">=</span><span style=" font-size:10pt; color:#0000ff;"> ПолученныйМассив</span><span style=" font-size:10pt; color:#ff0000;">.</span><span style=" font-size:10pt; color:#0000ff;">Получить</span><span style=" font-size:10pt; color:#ff0000;">[</span><span style=" font-size:10pt; color:#000000;">5</span><span style=" font-size:10pt; color:#ff0000;">];</span></pre>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana'; color:#000000;">Таким же образом оператор</span></p>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#0000ff; background-color:#f0f0f0;">ПолученныйМассив</span><span style=" font-size:10pt; color:#ff0000;">.</span><span style=" font-size:10pt; color:#0000ff;">Установить</span><span style=" font-size:10pt; color:#ff0000;">(</span><span style=" font-size:10pt; color:#000000;">5</span><span style=" font-size:10pt; color:#ff0000;">,</span><span style=" font-size:10pt; color:#0000ff;"> НовоеЗначение</span><span style=" font-size:10pt; color:#ff0000;">);</span><span style=" font-size:10pt; color:#0000ff;"> </span></pre>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana'; color:#000000;">аналогичен оператору</span></p>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f0f0f0;"><span style=" font-size:10pt; color:#0000ff; background-color:#f0f0f0;">ПолученныйМассив</span><span style=" font-size:10pt; color:#ff0000;">[</span><span style=" font-size:10pt; color:#000000;">5</span><span style=" font-size:10pt; color:#ff0000;">]</span><span style=" font-size:10pt; color:#0000ff;"> </span><span style=" font-size:10pt; color:#ff0000;">=</span><span style=" font-size:10pt; color:#0000ff;"> НовоеЗначение</span><span style=" font-size:10pt; color:#ff0000;">;</span></pre></body></html>